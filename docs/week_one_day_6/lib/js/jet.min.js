window.jet={AppConstants:{STARTUP:"startup",PROCESS_DATA:"processData",INIT_YOUTUBE:"INIT_YOUTUBE",YOUTUBE_READY:"YOUTUBE_READY",PROCESS_GRAPHICS_DATA:"processGraphicsData",GET_PAGE_TYPE:"getPageType",PARSE_PROPERTIES:"processProperties",BUILD_ITEMS:"buildItems",REGISTER_ITEMS:"registerItems",TEXT:"TEXT",LABEL:"LABEL",BUTTON:"BUTTON",CHECKBOX:"CHECKBOX",IMAGE:"IMAGE",VIDEO:"VIDEO",AUDIO:"AUDIO",RESOURCE:"RESOURCE",CROSSWORD:"CROSSWORD",NODES_MANAGER:"NODES_MANAGER",DATA_INPUT:"DATA_INPUT",COMBO_BOX:"COMBO_BOX",FORWARD:"FORWARD",BACK:"BACK",REQUEST_NEXT_PAGE:"REQUEST_NEXT_PAGE",REQUEST_RESET_PAGE:"REQUEST_RESET_PAGE",REQUEST_RESET_ALL_INTERACTIVITY:"REQUEST_RESET_ALL_INTERACTIVITY",REQUEST_REMOVE_FROM_FLOW:"REQUEST_REMOVE_FROM_FLOW",REQUEST_REMOVE_FROM_FLOW_BY_ID:"REQUEST_REMOVE_FROM_FLOW_BY_ID",REQUEST_ADD_RESOURCE:"REQUEST_ADD_RESOURCE",REQUEST_REMOVE_RESOURCE:"REQUEST_REMOVE_RESOURCE",REQUEST_NAV_BEGIN:"REQUEST_NAV_BEGIN",REQUEST_NAV_END:"REQUEST_NAV_END",REQUEST_NAV_FORWARD:"REQUEST_NAV_FORWARD",REQUEST_NAV_BACK:"REQUEST_NAV_BACK",REQUEST_NAV_NORMAL:"REQUEST_NAV_NORMAL",REQUEST_NAV_DISABLE:"REQUEST_NAV_DISABLE",REQUEST_NAV_DISABLE_BACK:"REQUEST_NAV_DISABLE_BACK",REQUEST_NAV_DISABLE_FORWARD:"REQUEST_NAV_DISABLE_FORWARD",REQUEST_NAV_SUSPEND:"REQUEST_NAV_SUSPEND",REQUEST_NAV_RESUME:"REQUEST_NAV_RESUME",REQUEST_NAV_BRANCH:"REQUEST_NAV_BRANCH",REQUEST_NODE:"REQUEST_NODE",REQUEST_NODES:"REQUEST_NODES",REQUEST_NODE_OVERLAY:"REQUEST_NODE_RESOURCE",REQUEST_UPDATE_PROGRESSBAR:"REQUEST_UPDATE_PROGRESSBAR",REQUEST_MANUAL_UPDATE_PROGRESSBAR:"REQUEST_MANUAL_UPDATE_PROGRESSBAR",REQUEST_UPDATE_MENUS:"REQUEST_UPDATE_MENUS",REQUEST_CHECK_ANSWER:"REQUEST_CHECK_ANSWER",SHOW_CHECK_ANSWER_BUTTON:"SHOW_CHECK_ANSWER_BUTTON",SHOW_FEEDBACK_MESSAGE:"SHOW_FEEDBACK_MESSAGE",HIDE_CHECK_ANSWER_BUTTON:"HIDE_CHECK_ANSWER_BUTTON",DISABLE_CHECK_ANSWER_BUTTON:"DISABLE_CHECK_ANSWER_BUTTON",REQUEST_HANDLE_PROJECT_NAME:"REQUEST_HANDLE_PROJECT_NAME",REQUEST_QUESTION_PROCESS:"REQUEST_QUESTION_PROCESS",PROCESS_ANSWER_KEYS:"PROCESS_ANSWER_KEYS",REQUEST_USER_ACTIVITY:"REQUEST_USER_ACTIVITY",REPORT_USER_ACTIVITY:"REPORT_USER_ACTIVITY",REPORT_TO_SCORM_API:"REPORT_TO_SCORM_API",REPORT_INTERNALLY:"REPORT_TO_INTERNALLY",REPORT_TO_JOURNAL:"REPORT_TO_JOURNAL",REQUEST_USER_DATA:"REQUEST_USER_DATA",STORE_USER_RESPONSES:"STORE_USER_RESPONSES",REQUEST_SUSPEND_DATA:"REQUEST_SUSPEND_DATA",REQUEST_RETRIEVE_DATA:"REQUEST_RETRIEVE_DATA",REQUEST_SUSPEND_DATA:"REQUEST_SUSPEND_DATA",SET_COMPLETION_STATUS:"SET_COMPLETION_STATUS",REQUEST_CLEAR_JET_DATA:"REQUEST_CLEAR_JET_DATA",RECORD_USER_RESPONSE:"RECORD_USER_RESPONSE",RECORD_USER_INTERACTION:"RECORD_USER_INTERACTION",RECORD_OBJECTIVE_RESPONSES:"RECORD_OBJECTIVE_RESPONSES",SET_SCORE:"SET_SCORE",GET_SCORE:"GET_SCORE",SET_CUSTOM_USER_SCORE:"SET_CUSTOM_USER_SCORE",GET_CUSTOM_USER_SCORE:"GET_CUSTOM_USER_SCORE",SET_CUSTOM_TOTAL_SCORE:"SET_CUSTOM_TOTAL_SCORE",GET_CUSTOM_TOTAL_SCORE:"GET_CUSTOM_TOTAL_SCORE",GET_REPORT:"GET_REPORT",GET_TOTAL_POINTS:"GET_TOTAL_POINTS",INCREMENT_SCORE:"INCREMENT_SCORE",INCREMENT_TOTAL_POINTS:"INCREMENT_TOTAL_POINTS",RESET_SCORES:"RESET_SCORES",RESET_INTERACTIVITY_ONLY:"RESET_INTERACTIVITY_ONLY",RESET_SECTION_SCORES:"RESET_SECTION_SCORES",REQUEST_FEEDBACK_REPORT:"REQUEST_FEEDBACK_REPORT",REPORT_FEEDBACK_INTERNALLY:"REPORT_FEEDBACK_INTERNALLY",REPORT_USER_FEEDBACK_ACTIVITY:"REPORT_USER_FEEDBACK_ACTIVITY",REQUEST_CONFIRMATION:"REQUEST_CONFIRMATION",REPORT_CONFIRMATION:"REPORT_CONFIRMATION",REQUEST_JOURNAL_REPORT:"REQUEST_JOURNAL_REPORT",REQUEST_OVERLAY:"REQUEST_OVERLAY",REQUEST_POPUP:"REQUEST_POPUP",REQUEST_NOTES:"REQUEST_NOTES",REQUEST_CLOSE_POPUP:"REQUEST_CLOSE_POPUP",REQUEST_TOOLTIP:"REQUEST_TOOLTIP",REQUEST_CLOSE_TOOLTIP:"REQUEST_CLOSE_TOOLTIP",REQUEST_METER:"REQUEST_METER",REQUEST_CLOSE_METER:"REQUEST_CLOSE_METER",SET_METER:"SET_METER",REQUEST_DASHBOARD_LAYOUT:"REQUEST_DASHBOARD_LAYOUT",REQUEST_GADGET_UPDATE:"REQUEST_GADGET_UPDATE",BRANCH_IMMEDIATELY:"Branch immediately",BRANCH_NEXT_BUTTON:"Branch when the Next Button is clicked",ADD_TOC:"ADD_TOC",ADD_RESOURCES:"ADD_RESOURCES",ADD_TITLE:"ADD_TITLE",ADD_SETTINGS:"ADD_SETTINGS",HANDLE_GRAPHICS_DATA:"HANDLE_GRAPHICS_DATA",BUILD_VECTOR_IMAGE:"BUILD_VECTOR_IMAGE",PAGE:"Page",OBJECTLIST:"ObjectList",LAYER:"Layer",ELLIPSE:"JFEllipse",RECTANGLE:"JFRectangle",ROUNDED_RECTANGLE:"JFRoundedRectangle",LINE:"Line",LABEL_LINE:"LabelLine",REGULAR_LINE:"RegularLine",POLYGON:"Polygon",ARC:"Arc",DIAMOND:"Diamond",SHAPE:"Shape",CHORD:"Chord",PIE:"Pie",JFIMAGE:"JFImage",JFTEXT:"Text",PARALLELOGRAM:"Parallelogram",TRAPEZOID:"Trapezoid",ISOSCELESRECTANGLE:"IsoscelesRectangle",JFGROUP:"JFGroup",LARGE_VALUE:100000000000,CLICK:"Click",JUMP_TO_PAGE:"Jump to Page",OPEN_URL:"Open URL",ADD_OVERLAY:"Add Overlay",SHOW_NODE:"Show Node",MOUSE_OVER:"Mouse Over",SET_VALUE:"Set Value",APPEND_VALUE:"Append Value",REMOVE_FROM_FLOW:"Remove from Flow",EXECUTE_COMMAND:"Execute Command(s)",JUMP_TO_VALUE:"Jump to Value",WRONG_ANSWER:"WRONG_ANSWER",CORRECT_ANSWER:"CORRECT_ANSWER",ALERT_MAP:"ALERT_MAP",SET_GEOLOCATION:"SET_GEOLOCATION"}};puremvc.define({name:"jet.ApplicationFacade",parent:puremvc.Facade},{registeredNodes:{},registeredGadgets:{},projectName:"",startup:function(){if(!this.initialized){this.initialized=true;this.registerCommand(jet.AppConstants.STARTUP,jet.controller.command.StartupCommand);this.sendNotification(jet.AppConstants.STARTUP,this)}},registerNode:function(a,b){this.registeredNodes[a]=b},createNode:function(a){if(this.registeredNodes.hasOwnProperty(a)){return this.registeredNodes[a]()}return null},registerGadget:function(a,b){this.registeredGadgets[a]=b},getGadgets:function(){return this.registeredGadgets},getProperty:function(d,b){var e=null;for(var a=d.length-1;a>-1;a--){if(e!=null){break}var f=d[a];if(!f.hasOwnProperty(b)){continue}else{e=d[a];break}}return e},setProjectName:function(a){this.projectName=a},getProjectName:function(){return this.projectName}},{getInstance:function(a){var b=puremvc.Facade.instanceMap;instance=b[a];if(instance){return instance}return b[a]=new jet.ApplicationFacade(a)},NAME:"JetBuilder"});puremvc.define({name:"jet.controller.command.BuildItemsCommand",parent:puremvc.SimpleCommand},{execute:function(e){var h=e.getBody();var n=this.facade;var q=n.retrieveProxy(jet.model.proxy.LXMLProxy.NAME);var o;var k;var i=$(h).find("settings");var d=q.parseSettings(i);var l=$(h).find("interaction");var p=q.parseInteractionElement(l);n.setProjectName(p);n.sendNotification(jet.AppConstants.REQUEST_HANDLE_PROJECT_NAME,"");n.registerMediator(new jet.view.mediator.PageMediator);n.registerMediator(new jet.view.mediator.GraphicsMediator);n.registerMediator(new jet.view.mediator.YouTubeMediator);n.registerMediator(new jet.view.mediator.QuestionProcessorMediator);n.registerMediator(new jet.view.mediator.WidgetMediator);var a=n.retrieveMediator(jet.view.mediator.PageMediator.NAME);a.setSettings(d);var b=n.retrieveMediator(jet.view.mediator.GraphicsMediator.NAME);var j=n.retrieveMediator(jet.view.mediator.YouTubeMediator.NAME);var m=n.retrieveMediator(jet.view.mediator.QuestionProcessorMediator.NAME);var f=n.retrieveMediator(jet.view.mediator.WidgetMediator.NAME);$(h).find("optionpage").each(function(){o=q.getPageType(q,this).toUpperCase();k=q.getUID(this);if($("body").hasClass("epub3")){var r=$("body").attr("id");r=r.substring(3);if(r==k){page=n.createNode(o)}else{page=null}}else{page=n.createNode(o)}if(page!=null&&page!=undefined){page.setMediator(jet.view.mediator.PageMediator.NAME,a);page.setMediator(jet.view.mediator.GraphicsMediator.NAME,b);page.setMediator(jet.view.mediator.YouTubeMediator.NAME,j);page.setMediator(jet.view.mediator.QuestionProcessorMediator.NAME,m);page.setMediator(jet.view.mediator.WidgetMediator.NAME,f);page.setUID(k);a.addNode(page,k);a.addTOCItem(this,k);a.addResourceItem(this,k);q.parseData(this,page)}});a.hideNodes();a.constructTOC();a.constructResources();a.constructTitle();a.sendSettings();a.showFirstNode()}});puremvc.define({name:"jet.controller.command.BuildVectorImage",parent:puremvc.SimpleCommand},{graphicsUtils:null,execute:function(d){this.graphicsUtils=new jet.controller.command.util.GraphicsUtils();var b=d.getBody();var e=b.objectMap;var a=b.contentDiv;switch(e.ID){case jet.AppConstants.RECTANGLE:this.drawRectangle(e,a);break;case jet.AppConstants.ROUNDED_RECTANGLE:this.drawRoundedRectangle(e,a);break;case jet.AppConstants.LINE:this.drawLine(e,a);break;case jet.AppConstants.REGULAR_LINE:this.drawLine(e,a);break;case jet.AppConstants.LABEL_LINE:this.drawLabelLine(e,a);break;case jet.AppConstants.POLYGON:this.drawPolygon(e,a);break;case jet.AppConstants.ELLIPSE:this.drawEllipse(e,a);break;case jet.AppConstants.ARC:this.drawArc(e,a);break;case jet.AppConstants.CHORD:this.drawChord(e,a);break;case jet.AppConstants.PIE:this.drawPie(e,a);break;case jet.AppConstants.JFIMAGE:this.drawImage(e,a);break;case jet.AppConstants.JFTEXT:this.drawText(e,a);break;case jet.AppConstants.DIAMOND:this.drawDiamond(e,a);break;case jet.AppConstants.PARALLELOGRAM:this.drawRectangle(e,a);break;case jet.AppConstants.TRAPEZOID:this.drawRectangle(e,a);break;case jet.AppConstants.ISOSCELESRECTANGLE:this.drawRectangle(e,a);break;case jet.AppConstants.JFGROUP:this.drawGroup(e,a);break}},createCanvas:function(q,t,o,p,j,l){var a=t.ObjectId;var k=t.LayerIndex;var h=t.page;if(a>-1){var m=h.getGroups()[a];if(m!=null&&m!=undefined){o=m}}var e=document.createElement("canvas");if(a>-1){$(e).css("pointer-events","none")}if(a==-1){this.setMotionProperty(e,t);this.setModifyingProperty(e,t);this.setPropertyList(e,t)}$(o).append(e);var r=e.getContext("2d");this.graphicsUtils.calculateCanvasDimensions(q,j);var b=parseInt(t.LineWidth);this.translatePoints(q,j.left,j.top,b+l);var s=j.x;var d=j.y;$(e).css("position","absolute");e.width=s+(2*b)+(2*l);e.height=d+(2*b)+(2*l);p={x:s,y:d};p={x:e.width,y:e.height};var i=this.graphicsUtils.calculateOffset(o);var n=j.top-b-l-i.y;var f=j.left-b-l-i.x;$(e).css("top",n+"px");$(e).css("left",f+"px");$(e).css("z-index",k);this.setStyleFormat(r,t,p);if(a==-1){h.processGraphicsObject(e,t,j)}return r},createDiv:function(o,e,h,j,a,n){var k=e.page;var b=document.createElement("div");var m=e.GroupID;k.getGroups()[m]=b;this.setMotionProperty(b,e);this.setModifyingProperty(b,e);this.setPropertyList(b,e);$(h).append(b);this.graphicsUtils.calculateCanvasDimensions(o,a);var d=a.x;var i=a.y;$(b).css("position","absolute");var l=a.top;var f=a.left;$(b).css("top",l+"px");$(b).css("left",f+"px");$(b).css("width",d+"px");$(b).css("height",i+"px");var k=e.page;k.processGraphicsObject(b,e,a)},render:function(d,e){var a=parseInt(e.LineWidth);var b=parseInt(e.FillStyle);if(a&&a>0){d.stroke()}if(b){d.fill()}},drawLine:function(j,e){var d=j.Points;var a={};var h={};var f=this.createCanvas(d,j,e,a,h,0);f.moveTo(d[0]["x"],d[0]["y"]);for(var b=1;b<d.length;b++){f.lineTo(d[b]["x"],d[b]["y"])}f.stroke();this.drawArrows(f,j,d[0],d[d.length-1])},drawPolygon:function(j,e){var d=j.Points;var a={};var h={};var f=this.createCanvas(d,j,e,a,h,0);f.moveTo(d[0]["x"],d[0]["y"]);for(var b=1;b<d.length;b++){f.lineTo(d[b]["x"],d[b]["y"])}f.closePath();this.render(f,j)},drawDiamond:function(b,d){var m=b.Points;var k=[];k.push(m[0]);k.push(m[1]);k.push(m[2]);k.push(m[3]);var h={};var a={};var e=this.createCanvas(m,b,d,h,a,0);var l=this.graphicsUtils.calcMidPointFromPoints(k[0],k[1]);var j=this.graphicsUtils.calcMidPointFromPoints(k[1],k[3]);var i=this.graphicsUtils.calcMidPointFromPoints(k[3],k[2]);var f=this.graphicsUtils.calcMidPointFromPoints(k[2],k[0]);e.moveTo(l.x,l.y);e.lineTo(j.x,j.y);e.lineTo(i.x,i.y);e.lineTo(f.x,f.y);e.lineTo(l.x,l.y);e.closePath();this.render(e,b)},drawRectangle:function(b,d){var l=b.Points;if(l.length<4){return}var h={};var a={};var e=this.createCanvas(l,b,d,h,a,0);var k=l[0];var j=l[1];var i=l[2];var f=l[3];e.moveTo(l[0]["x"],l[0]["y"]);e.lineTo(l[1]["x"],l[1]["y"]);e.lineTo(l[3]["x"],l[3]["y"]);e.lineTo(l[2]["x"],l[2]["y"]);e.lineTo(l[0]["x"],l[0]["y"]);e.closePath();this.render(e,b)},drawGroup:function(f,d){var b=f.Points;if(b.length<4){return}var a={};var e={};this.createDiv(b,f,d,a,e,0)},drawText:function(b,d){var o=b.Points;if(o.length<4){return}var j={};var a={};var q=parseInt(b.FontSize)-3;var f=this.createCanvas(o,b,d,j,a,0);var m=o[0];var l=o[1];var k=o[2];var i=o[3];var e=this.graphicsUtils.setRotation(b,f,a,false);var p=b.text;var h=this.graphicsUtils.convertFromCharCode(p);var n=this.convert(parseInt(b.FontColor));if(n){f.fillStyle=n}f.textBaseline="alphabetic";f.font=q+"px Arial";f.fillText(h,0,a.y/2)},drawImage:function(f,h){var q=f.Points;if(q.length<4){return}var m={};var b={};var k=this.createCanvas(q,f,h,m,b,0);var p=q[0];var o=q[1];var n=q[2];var l=q[3];var e=this.graphicsUtils.calcMagnitude(p,o);var d=this.graphicsUtils.calcMagnitude(o,l);var a="./base/"+f.imageData;var j=new Image();j.onload=function(){k.drawImage(this,0,0,e,d)};j.src=a;var i=this.graphicsUtils.setRotation(f,k,b,true)},drawEllipse:function(t,n){var q=t.Points;var h={};var l=0;if(this.graphicsUtils.isObjectRotated(t,h,true)){l=0}else{l=5}var o={};var r=this.createCanvas(q,t,n,o,h,l);var f=q[0];var e=q[1];var d=q[2];var b=q[3];var a=parseInt(t.LineWidth);var m=this.graphicsUtils.calcMagnitude(f,e);var s=this.graphicsUtils.calcMagnitude(e,b);var j=a+l;var i=a+l;var p=this.graphicsUtils.setRotation(t,r,h,true);var k=0.5522848;ox=(m/2)*k,oy=(s/2)*k,xe=j+m,ye=i+s,xm=j+m/2,ym=i+s/2;r.beginPath();r.moveTo(j,ym);r.bezierCurveTo(j,ym-oy,xm-ox,i,xm,i);r.bezierCurveTo(xm+ox,i,xe,ym-oy,xe,ym);r.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);r.bezierCurveTo(xm-ox,ye,j,ym+oy,j,ym);r.closePath();this.render(r,t)},drawArc:function(I,w){var E=I.Points;var C={};var r={};var F=this.createCanvas(E,I,w,C,r,25);var n=E[0];var j=E[1];var f=E[2];var a=parseInt(I.LineWidth);var b=this.graphicsUtils.calcAngle(n,j);var d=this.graphicsUtils.calcMidPointFromPoints(n,j);var A=this.graphicsUtils.calcMagnitude(f,d);var H=this.graphicsUtils.calcMagnitude(n,j);var p=((H*H)/(8*A))+(A/2);var D=this.graphicsUtils.calcAngle(f,d);var o=p*Math.cos(D);var q=p*Math.sin(D);var l=f.x+o;var i=f.y+q;var G=b;var t=a;var s=a;var k=n.y-i;var z=n.x-l;var h=j.y-i;var v=j.x-l;var B=Math.atan2(k,z);var u=Math.atan2(h,v);var e=this.graphicsUtils.isFlipped(n,j,f);F.arc(l,i,p,B,u,e);this.render(F,I)},drawChord:function(I,w){var E=I.Points;var C={};var r={};var F=this.createCanvas(E,I,w,C,r,25);var n=E[0];var j=E[1];var f=E[2];var a=parseInt(I.LineWidth);var b=this.graphicsUtils.calcAngle(n,j);var d=this.graphicsUtils.calcMidPointFromPoints(n,j);var A=this.graphicsUtils.calcMagnitude(f,d);var H=this.graphicsUtils.calcMagnitude(n,j);var p=((H*H)/(8*A))+(A/2);var D=this.graphicsUtils.calcAngle(f,d);var o=p*Math.cos(D);var q=p*Math.sin(D);var l=f.x+o;var i=f.y+q;var G=b;var t=a;var s=a;var k=n.y-i;var z=n.x-l;var h=j.y-i;var v=j.x-l;var B=Math.atan2(k,z);var u=Math.atan2(h,v);var e=this.graphicsUtils.isFlipped(n,j,f);F.arc(l,i,p,B,u,e);F.closePath();this.render(F,I)},drawPie:function(J,z){var F=J.Points;var D={};var s={};var G=this.createCanvas(F,J,z,D,s,25);var p=F[0];var k=F[1];var h=F[2];var f=F[3];var a=parseInt(J.LineWidth);var b=this.graphicsUtils.calcAngle(p,k);var d=this.graphicsUtils.calcMidPointFromPoints(p,k);var B=this.graphicsUtils.calcMagnitude(h,d);var I=this.graphicsUtils.calcMagnitude(p,k);var q=((I*I)/(8*B))+(B/2);var E=this.graphicsUtils.calcAngle(h,d);var o=q*Math.cos(E);var r=q*Math.sin(E);var n=h.x+o;var j=h.y+r;var H=b;var u=a;var t=a;var l=p.y-j;var A=p.x-n;var i=k.y-j;var w=k.x-n;var C=Math.atan2(l,A);var v=Math.atan2(i,w);var e=this.graphicsUtils.isFlipped(p,k,h);G.arc(n,j,q,C,v,e);G.moveTo(k.x,k.y);G.lineTo(f.x,f.y);G.lineTo(p.x,p.y);this.render(G,J)},drawRoundedRectangle:function(u,n){var r=u.Points;var q={};var i={};var s=this.createCanvas(r,u,n,q,i,0);var f=r[0];var e=r[1];var d=r[2];var b=r[3];var a=parseInt(u.LineWidth);var l=this.graphicsUtils.calcMagnitude(f,e);var t=this.graphicsUtils.calcMagnitude(e,b);var k=a;var j=a;var o=l;var m=t;var h=Math.min(l,t)/5;var p=this.graphicsUtils.setRotation(u,s,i,true);s.beginPath();s.moveTo(k+h,j);s.lineTo(k+o-h,j);s.quadraticCurveTo(k+o,j,k+o,j+h);s.lineTo(k+o,j+m-h);s.quadraticCurveTo(k+o,j+m,k+o-h,j+m);s.lineTo(k+h,j+m);s.quadraticCurveTo(k,j+m,k,j+m-h);s.lineTo(k,j+h);s.quadraticCurveTo(k,j,k+h,j);s.closePath();this.render(s,u)},drawLabelLine:function(e,f){var o=e.Points;var l={};var a={};var j=this.createCanvas(o,e,f,l,a,0);if(o.length<1){return}var d=this.graphicsUtils.calcMagnitude(o[0],o[1]);var b=this.graphicsUtils.calcMagnitude(o[0],o[2]);var k=this.graphicsUtils.calcSlope(o[0],o[2]);var h=Math.atan2(k,1);var i=20;var n=this.graphicsUtils.projectPoint(o[2],i,h);var m=this.graphicsUtils.projectPoint(o[4],i,h);this.drawLabelArrows(j,e,o[0],o[1]);this.drawLabelArrows(j,e,o[1],o[0]);j.beginPath();j.moveTo(o[0]["x"],o[0]["y"]);j.lineTo(o[1]["x"],o[1]["y"]);j.lineTo(o[0]["x"],o[0]["y"]);j.lineTo(o[2]["x"],o[2]["y"]);j.lineTo(o[3]["x"],o[3]["y"]);j.lineTo(o[0]["x"],o[0]["y"]);j.moveTo(o[1]["x"],o[1]["y"]);j.lineTo(o[4]["x"],o[4]["y"]);j.lineTo(o[5]["x"],o[5]["y"]);j.stroke();j.closePath()},translatePoints:function(e,h,f,b){for(var d=0;d<e.length;d++){var a=e[d];a.x=a.x-h+b;a.y=a.y-f+b;e[d]=a}},translatePointsForGroupedObject:function(l,b,j,f,d){var h=d.x;var a=d.y;for(var e=0;e<l.length;e++){var k=l[e];k.x=k.x-(b+h);k.y=k.y-(j+a);k.x=k.x+f;k.y=k.y+f;l[e]=k}},convert:function(b){var d=this.decimalToHexString(b);var a="#"+d.substring(d.length-6);return a},setStyleFormat:function(b,d,a){this.setFillFormat(b,d,a.x,a.y);this.setLineFormat(b,d);this.setSettings(b,d)},decimalToHexString:function(a){if(a<0){a=4294967295+a+1}return a.toString(16).toUpperCase()},setSettings:function(b,d){var a=parseInt(d.Transparency);b.globalAlpha=(100-a)/100;var e=parseInt(d.Invisible);if(e==1){}},setMotionProperty:function(a,d){var b=parseInt(d.DisableMotion);if(b==0){$(a).draggable();$(a).drag(function(f,e){$(this).css({top:e.offsetY,left:e.offsetX})});$(a).addClass("EnableMotion")}},setModifyingProperty:function(b,d){var a=parseInt(d.DisableModifyingProperties);if(a==0){$(b).addClass("EnableModify")}},setPropertyList:function(a,e){var b=e.event;switch(b){case jet.AppConstants.CLICK:$(a).addClass("EnableClickTouch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break;case jet.AppConstants.JUMP_TO_PAGE:$(a).addClass("EnableBranch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break;case jet.AppConstants.OPEN_URL:$(a).addClass("EnableBranch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break;case jet.AppConstants.ADD_OVERLAY:$(a).addClass("EnableBranch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break;case jet.AppConstants.SHOW_NODE:$(a).addClass("EnableBranch");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break}var d=e.mouseoverevent;switch(d){case jet.AppConstants.MOUSE_OVER:$(a).addClass("EnableMouseOver");$(a).removeClass("EnableMotion");$(a).removeClass("EnableModify");break}},setLineFormat:function(b,e){var f=1;var a=parseInt(e.LineWidth);var d=this.convert(parseInt(e.LineColor));if(a==0){f=0}b.strokeStyle=d;b.lineWidth=a},setFillFormat:function(f,h,e,d){var b=parseInt(h.FillStyle);var a=parseInt(h.FillColor);var i=this.convert(a);switch(b){case 0:break;case 1:f.fillStyle=i;break;default:f.fillStyle=i;break}},drawArrows:function(h,i,f,d){var b=i.StartArrowType;var a=i.EndArrowType;var e=i.Points;if(e.length<2){return}if(b=="1"){f=e[0];d=e[1];this.calcRadians(h,f,d,i)}if(a=="1"){f=e[e.length-1];d=e[e.length-2];this.calcRadians(h,f,d,i)}},drawLabelArrows:function(h,i,f,d){var b=i.StartArrowType;var a=i.EndArrowType;var e=i.Points;if(e.length<2){return}if(b=="1"){f=e[0];d=e[1];this.calcRadians(h,f,d,i)}if(a=="1"){f=e[1];d=e[0];this.calcRadians(h,f,d,i)}},calcRadians:function(l,d,m,e){var k=parseInt(d.x-m.x);var b=parseInt(d.y-m.y);var j=Math.sqrt(Math.pow(m.x-d.x,2)+Math.pow(m.y-d.y,2));var i=Math.acos(Math.abs(m.x-d.x)/j);var h=0;var f=0;var a=0;if((d.y==m.y)&&(d.x!=m.x)){a=1}if((d.y!=m.y)&&(d.x==m.x)){f=1}if((d.y-m.y>0)&&(d.x-m.x<0)){h=1}if((d.y-m.y>0)&&(d.x-m.x>0)){h=2}if((d.y-m.y<0)&&(d.x-m.x>0)){h=3}if((d.y-m.y<0)&&(d.x-m.x<0)){h=4}if(h==0){}if(h==1){}if(h==2){i=Math.PI-i}if(h==3){i=Math.PI+i}if(h==4){i=2*Math.PI-i}if(f&&d.y<m.y){i=2*Math.PI-i}if(a&&d.x>m.x){i=Math.PI+i}this.plotTriangle(l,i,d,e)},plotTriangle:function(h,b,o,a){var n=0.4363323129985824;var i=b+n;var f=b-n;var d=10;this.setLineFormat(h,a);fillColor=this.convert(parseInt(a.LineColor));var p=parseInt(a.FillStyle);h.fillStyle=fillColor;var e=o.x+d*Math.cos(i);var l=o.y-d*Math.sin(i);var m={x:e,y:l};var q=o.x+d*Math.cos(f);var j=o.y-d*Math.sin(f);var k={x:q,y:j};h.beginPath();h.moveTo(o.x,o.y);h.lineTo(m.x,m.y);h.lineTo(k.x,k.y);h.lineTo(o.x,o.y);h.closePath();h.stroke()}});puremvc.define({name:"jet.controller.command.ParseProperties",parent:puremvc.SimpleCommand},{execute:function(b){var e=b.getBody();var a=e.component;properties=e.properties;var d=this.getProperty(properties,"player_width");if(d!=null){a.setWidth(d.player_width)}else{d=this.getProperty(properties,"width");if(d!=null){a.setWidth(d.width)}}d=this.getProperty(properties,"player_height");if(d!=null){a.setHeight(d.player_height)}else{d=this.getProperty(properties,"height");if(d!=null){a.setHeight(d.height)}}d=this.getProperty(properties,"player_x");if(d!=null){a.setX(d.player_x);a.setInitialX(d.player_x)}else{d=this.getProperty(properties,"x");if(d!=null){a.setX(d.x);a.setInitialX(d.x)}}d=this.getProperty(properties,"player_y");if(d!=null){a.setY(d.player_y);a.setInitialY(d.player_y)}else{d=this.getProperty(properties,"y");if(d!=null){a.setY(d.y);a.setInitialY(d.y)}}d=this.getProperty(properties,"bgAlpha");if(d!=null){a.setBackgroundOpacity(d.bgAlpha)}d=this.getProperty(properties,"fgAlpha");if(d!=null){a.setForegroundOpacity(d.fgAlpha)}d=this.getProperty(properties,"bgColor");if(d!=null){a.setBackgroundColor(d.bgColor)}d=this.getProperty(properties,"parentClass");if(d!=null){a.setClass(d.parentClass)}d=this.getProperty(properties,"contentClass");if(d!=null){a.setContentClass(d.contentClass)}},getProperty:function(e,b){var d=null;for(var a in e){if(d!=null){break}if(!e.hasOwnProperty(a)){continue}if(typeof e[a]=="object"){d=this.getProperty(e[a],b)}else{if(a==b){d=e;break}}}return d}});puremvc.define({name:"jet.controller.command.PrepareControllerCommand",parent:puremvc.SimpleCommand},{execute:function(a){this.facade.registerCommand(jet.AppConstants.PROCESS_DATA,jet.controller.command.ProcessDataCommand);this.facade.registerCommand(jet.AppConstants.PROCESS_GRAPHICS_DATA,jet.controller.command.ProcessGraphicsDataCommand);this.facade.registerCommand(jet.AppConstants.REGISTER_ITEMS,jet.controller.command.RegisterItemsCommand);this.facade.registerCommand(jet.AppConstants.BUILD_ITEMS,jet.controller.command.BuildItemsCommand);this.facade.registerCommand(jet.AppConstants.PARSE_PROPERTIES,jet.controller.command.ParseProperties);this.facade.registerCommand(jet.AppConstants.BUILD_VECTOR_IMAGE,jet.controller.command.BuildVectorImage);this.facade.registerCommand(jet.AppConstants.INIT_YOUTUBE,jet.controller.command.StartUpYouTubeCommand);this.facade.sendNotification(jet.AppConstants.INIT_YOUTUBE,"");this.facade.sendNotification(jet.AppConstants.PROCESS_DATA,"./base/main.xml")}});puremvc.define({name:"jet.controller.command.PrepareModelCommand",parent:puremvc.SimpleCommand},{execute:function(a){this.facade.registerProxy(new jet.model.proxy.LXMLProxy);this.facade.registerProxy(new jet.model.proxy.JFXMLProxy)}});puremvc.define({name:"jet.controller.command.PrepareViewCommand",parent:puremvc.SimpleCommand},{execute:function(a){}});puremvc.define({name:"jet.controller.command.ProcessDataCommand",parent:puremvc.SimpleCommand},{execute:function(d){var e=d.getBody();var b=this.facade;var a=this;var f={type:"GET",dataType:"xml",success:function(h){b.sendNotification(jet.AppConstants.REGISTER_ITEMS,h)},error:function(h){if($("body").hasClass("epub3")){a.getData(b);return}else{window.alert("Use Firefox when you are testing this template on your local drive.")}}};f.url=e;$.ajax(f)},getData:function(e){var d=getXMLData();d=$.parseXML(d);var a=setInterval(b,1000);function b(){if(e.retrieveProxy(jet.model.proxy.LXMLProxy.NAME)!=undefined){e.sendNotification(jet.AppConstants.REGISTER_ITEMS,d);clearInterval(a)}}}});puremvc.define({name:"jet.controller.command.ProcessGraphicsDataCommand",parent:puremvc.SimpleCommand},{execute:function(d){var b=d.getBody();var e=b.fileName;var h=b.graphicsUID;var a=this.facade;var f={type:"GET",dataType:"xml",success:function(i){var j={graphicsUID:h,xml:i};a.sendNotification(jet.AppConstants.HANDLE_GRAPHICS_DATA,j)},error:function(i){}};f.url=e;$.ajax(f)}});puremvc.define({name:"jet.controller.command.StartUpYouTubeCommand",parent:puremvc.SimpleCommand},{execute:function(d){var a=document.createElement("script");a.src="//www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}});puremvc.define({name:"jet.controller.command.StartupCommand",parent:puremvc.MacroCommand},{initializeMacroCommand:function(){this.addSubCommand(jet.controller.command.PrepareControllerCommand);this.addSubCommand(jet.controller.command.PrepareViewCommand);this.addSubCommand(jet.controller.command.PrepareModelCommand)}});var progressDiv=null;var intervalID=null;var intervalMathJaxChecker=null;var intervalSCORMChecker=null;var isSCORMLoaded=false;var intervalCount=10;var scormIntervalCount=10;var backgroundColor=null;var outerBackgroundColor=null;var googleMap=null;(function setUpParserAPIHooks(){if(typeof ParserApiHooks=="undefined"||ParserApiHooks==null){ParserApiHooks={};ParserApiHooks.Exposed={};if(console&&console.log){console.log("ParseAPIHooks in place")}}}());$(document).ready(function(){performInitialization();intervalSCORMChecker=setInterval(checkIfSCORMIsLoaded,5000)});function checkIfMathJaxIsLoaded(){intervalCount--;if((typeof MathJax!=="undefined"&&MathJax!=null)||intervalCount<1){clearInterval(intervalMathJaxChecker);MathJax.Hub.Queue(["Typeset",MathJax.Hub]);console.log("MathJax Loaded and Document ready")}}function checkIfSCORMIsLoaded(){scormIntervalCount--;if(!isSCORMLoaded&&scormIntervalCount>1){var a=doInitialize();if(a=="true"){isSCORMLoaded=true;clearInterval(intervalSCORMChecker)}}else{clearInterval(intervalSCORMChecker)}if(window.console){console.log("SCORM Init Call returned "+a)}}function performInitialization(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).startup();preFetch();setUpLinks();setUpParser();activateUnload()}function preFetch(){var b=["lib/css/arrowLeft.png","lib/css/arrowLeft_down.png","lib/css/arrowLeft_gray.png","lib/css/arrowRight.png","lib/css/arrowRight_down.png","lib/css/arrowRight_gray.png"];for(var a=0;a<b.length;a++){var d=new Image();d.src=b[a]}}function setUpLinks(){$(document).on("click",".content a, .colorboxDiv a, .mPage a",function(f){f.preventDefault();var e=f.target.href;var d=f.target.target;var a=/\(ID:(\d+)/.exec(e);var b=null;if(a&&a.length>1){b=a[1]}if(b){switch(d){case"_blank":jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE,b);break;case"_overlay":jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE_RESOURCE,b);break;default:jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE,b)}}else{window.open(f.target.href,"_blank","toolbar=yes, scrollbars=yes, resizable=yes, top=50, left=50, width=700, height=400")}})}function showProgressBar(){var b=0;var a=setInterval(function(){b++;if(document.readyState==="interactive"||b>10){clearInterval(a);hideProgressBar()}},1000);progressDiv=document.createElement("div");document.body.appendChild(progressDiv);progressDiv.style.position="absolute";progressDiv.style.width="75px";progressDiv.style.height="75px";progressDiv.style.left="50%";progressDiv.style.top="50%";progressDiv.style.backgroundImage="url('lib/css/Progress.gif')";progressDiv.style.zIndex="20"}function hideProgressBar(){document.body.removeChild(progressDiv)}function qValidate(d){var b="AES_Encryption_2";var a="RandomInitVector";return validate(d,b,a)}function validate(e,d,b){d=CryptoJS.enc.Utf8.parse(d);b=CryptoJS.enc.Utf8.parse(b);var a=CryptoJS.AES.decrypt(e,d,{iv:b});a=a.toString(CryptoJS.enc.Utf8);return a}function hexToRgb(d){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;d=d.replace(b,function(f,i,h,e){return i+i+h+h+e+e});var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(d);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}function setUpParser(){var a={};a.Math=Math;a.convertToString=function(b){return new String(b).toString()};a["Math.ceil"]=function(b){return Math.ceil(b)};a["Math.floor"]=function(b){return Math.floor(b)};a["Math.round"]=function(b){return Math.round(b)};a["Math.random"]=function(){return Math.random()};a.message=function(b){window.alert(b)};a.concatenate=function(d,b){return d.concat(b)};a.gotonextpage=function(){doNotify(jet.AppConstants.REQUEST_NEXT_PAGE)};a.goToNextPage=function(){doNotify(jet.AppConstants.REQUEST_NEXT_PAGE)};a.gotopreviouspage=function(){doNotify(jet.AppConstants.BACK)};a.goToPreviousPage=function(){doNotify(jet.AppConstants.BACK)};a.jumptopage=function(b){doNotify(jet.AppConstants.JUMP_TO_PAGE,b)};a.jumpToPage=function(b){doNotify(jet.AppConstants.JUMP_TO_PAGE,b)};a.openurl=function(b){doNotify(jet.AppConstants.OPEN_URL,b)};a.openUrl=function(b){doNotify(jet.AppConstants.OPEN_URL,b)};a.addoverlay=function(b){doNotify(jet.AppConstants.ADD_OVERLAY,b)};a.addOverlay=function(b){doNotify(jet.AppConstants.ADD_OVERLAY,b)};a.setvalue=function(d,b){setJetValue(d,b)};a.setValue=function(d,b){setJetValue(d,b)};a.appendvalue=function(d,b){appendJetValue(d,b)};a.appendValue=function(d,b){appendJetValue(d,b)};a.getvalue=function(b){return getJetValue(b)};a.getValue=function(b){return getJetValue(b)};a.resetpage=function(){doNotify(jet.AppConstants.REQUEST_RESET_PAGE)};a.resetPage=function(){doNotify(jet.AppConstants.REQUEST_RESET_PAGE)};a.resetallinteractivity=function(){doNotify(jet.AppConstants.REQUEST_RESET_ALL_INTERACTIVITY)};a.resetAllInteractivity=function(){doNotify(jet.AppConstants.REQUEST_RESET_ALL_INTERACTIVITY)};a.removefromflow=function(){doNotify(jet.AppConstants.REQUEST_REMOVE_FROM_FLOW)};a.removeFromFlow=function(){doNotify(jet.AppConstants.REQUEST_REMOVE_FROM_FLOW)};a.removefromflowbyid=function(b){doNotify(jet.AppConstants.REQUEST_REMOVE_FROM_FLOW_BY_ID,b)};a.removeFromFlowById=function(b){doNotify(jet.AppConstants.REQUEST_REMOVE_FROM_FLOW_BY_ID,b)};a.addtoresources=function(b){doNotify(jet.AppConstants.REQUEST_ADD_RESOURCE,b)};a.addToResources=function(b){doNotify(jet.AppConstants.REQUEST_ADD_RESOURCE,b)};a.removefromresources=function(b){doNotify(jet.AppConstants.REQUEST_REMOVE_RESOURCE,b)};a.removeFromResources=function(b){doNotify(jet.AppConstants.REQUEST_REMOVE_RESOURCE,b)};a.updateprogressbar=function(e,d){var b={value:e,max:d};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_MANUAL_UPDATE_PROGRESSBAR,b)};a.updateProgressBar=function(e,d){var b={value:e,max:d};jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_MANUAL_UPDATE_PROGRESSBAR,b)};a.suspenddata=function(){doNotify(jet.AppConstants.REQUEST_SUSPEND_DATA)};a.suspendData=function(){doNotify(jet.AppConstants.REQUEST_SUSPEND_DATA)};a.retrieveData=function(){doNotify(jet.AppConstants.REQUEST_RETRIEVE_DATA)};a.retrievedata=function(){doNotify(jet.AppConstants.REQUEST_RETRIEVE_DATA)};a.cleardata=function(){doNotify(jet.AppConstants.REQUEST_CLEAR_JET_DATA)};a.clearData=function(){doNotify(jet.AppConstants.REQUEST_CLEAR_JET_DATA)};a.setcompletionstatus=function(b){doNotify(jet.AppConstants.SET_COMPLETION_STATUS,b)};a.setCompletionStatus=function(b){doNotify(jet.AppConstants.SET_COMPLETION_STATUS,b)};a.setCustomUserScore=function(b){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.SET_CUSTOM_USER_SCORE,b)};a.setCustomTotalScore=function(b){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.SET_CUSTOM_TOTAL_SCORE,b)};a.log=function(){if(console&&console.log){console.log.apply(console,arguments)}};ParserApiHooks.Exposed=a}function doNotify(b,a){if(a&&a.length>0){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(b,a)}else{jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(b)}}function testParser(){if(ParserApiHooks!=undefined&&ParserApiHooks.execute!=undefined){var d="Go Forward()";try{var b=ParserApiHooks.parse(d);var a=ParserApiHooks.execute(b);clearInterval(intervalID)}catch(f){window.alert(f)}}}function initSCORM(){var a=doInitialize();if(window.console){console.log("SCORM Init Call returned "+a)}}function activateUnload(){$(window).on("beforeunload",function(b){var a=doTerminate();var d="Please wait five seconds before leaving page to allow data reporting.";if(a!="true"){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_POPUP,d);b.returnValue=d;return d}})}function setUpSwipeGesture(){$(document).on("ontouchstart","div.navigator",function(a){touchStart(a,"navigator")})}var jetData={};function setJetValue(a,b){if(isNaN(b)){jetData[a]=b}else{b=parseFloat(b);jetData[a]=b}}function appendJetValue(b,d){if(isNaN(d)){var a=jetData[b];jetData[b]=a+d}else{d=parseFloat(d);if(jetData[b]==undefined){jetData[b]=0}var a=jetData[b];jetData[b]=a+d}}function getJetValue(a){return jetData[a]}function setJetStore(a){var a=JSON.parse(a);if(typeof a=="object"){jetData=a}}function getJetStore(){if(isEmptyObject(jetData)){return""}try{var b=JSON.stringify(jetData);return b}catch(a){return""}}function clearJetStore(){jetData={}}function isEmptyObject(a){for(var b in a){if(Object.prototype.hasOwnProperty.call(a,b)){return false}}return true}function getJetWrapper(){if($(".jetWrapper").length){return $(".jetWrapper")}else{return $("body")}}function initGoogleMap(){var a=new google.maps.LatLng(45,-93.910965);googleMap=new google.maps.Map(document.getElementById("mapDiv"),{center:a,scrollwheel:false,zoom:8,myID:"ls"})}function getOuterBackgroundColor(a){if(outerBackgroundColor!=null){$(a).css("color",getContrastYIQ(outerBackgroundColor));return}var b=this;$.ajax({type:"GET",url:"./theme/default.xml",dataType:"xml",success:function(d){$(d).find("outerBgColor").each(function(){var e=$(this).text();$(a).css("color",b.getContrastYIQ(e));outerBackgroundColor=e})},error:function(){}})}function getContrastYIQ(h){h=h.substring(1);var e=parseInt(h.substr(0,2),16);var d=parseInt(h.substr(2,2),16);var a=parseInt(h.substr(4,2),16);var f=((e*299)+(d*587)+(a*114))/1000;return(f>=128)?"black":"white"}puremvc.define({name:"jet.view.mediator.DashboardComponentMediator",parent:puremvc.Mediator},{meterComponent:null,isMeter:false,listNotificationInterests:function(){return[jet.AppConstants.REQUEST_METER,jet.AppConstants.REQUEST_CLOSE_METER,jet.AppConstants.SET_METER,jet.AppConstants.REQUEST_DASHBOARD_LAYOUT,jet.AppConstants.REQUEST_GADGET_UPDATE]},handleNotification:function(a){switch(a.getName()){case jet.AppConstants.REQUEST_METER:this.showMeter(a.getBody());break;case jet.AppConstants.REQUEST_CLOSE_METER:this.hideMeter();break;case jet.AppConstants.SET_METER:this.setMeter(a.getBody());break;case jet.AppConstants.REQUEST_DASHBOARD_LAYOUT:this.layoutDashboard();break;case jet.AppConstants.REQUEST_GADGET_UPDATE:this.updateGadget(a.getBody());break}},onRegister:function(){this.setViewComponent(new jet.view.component.DashboardComponent);this.setMeterComponent(new jet.view.component.MeterComponent(this))},onRemove:function(){this.setViewComponent(null)},handleEvent:function(a){},setMeterComponent:function(a){this.meterComponent=a},showMeter:function(){if(!this.isMeter){this.meterComponent.setParent($(".dashboard"));this.meterComponent.initMeter();this.isMeter=true}this.meterComponent.show(true)},hideMeter:function(){this.meterComponent.show(false)},setMeter:function(b){this.meterComponent.setMeter(b);b=b/180;var a={score:b};this.updateGadgets(a)},requestResumeNavigation:function(a){this.sendNotification(jet.AppConstants.REQUEST_NAV_RESUME,null)},layoutDashboard:function(){this.getViewComponent().doDashboardLayout()},updateGadget:function(e){var a=e.name;var d=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var b=d.getGadgets();var f=b[a];if(f!=null&&f!=undefined){f.setDataObject(e)}},updateGadgets:function(d){var b=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var a=b.getGadgets();for(var f in a){var e=a[f];if(e!=null&&e!=undefined&&e.setDataObject){e.setDataObject(d)}}}},{NAME:"DashboardComponentMediator"});puremvc.define({name:"jet.view.mediator.GraphicsMediator",parent:puremvc.Mediator},{pageMap:{},listNotificationInterests:function(){return[jet.AppConstants.HANDLE_GRAPHICS_DATA]},handleNotification:function(a){switch(a.getName()){case jet.AppConstants.HANDLE_GRAPHICS_DATA:this.handleXMLData(a.getBody());break}},onRegister:function(){},onRemove:function(){},getXMLData:function(e,b){this.pageMap[e]=b;var d="base/"+e+"_vector.xml";var a={graphicsUID:e,fileName:d};this.facade.sendNotification(jet.AppConstants.PROCESS_GRAPHICS_DATA,a)},handleXMLData:function(d){var e=d.graphicsUID;var a=d.xml;var b=this.facade.retrieveProxy(jet.model.proxy.JFXMLProxy.NAME);b.parseData(this,e,a,-1)},post:function(e,f){var d=this.pageMap[f];e.page=d;var b=d.getContentDiv();var a={contentDiv:b,objectMap:e};this.facade.sendNotification(jet.AppConstants.BUILD_VECTOR_IMAGE,a)},postProcessGraphics:function(b){var a=this.pageMap[b];a.postProcessGraphics()}},{NAME:"GraphicsMediator"});puremvc.define({name:"jet.view.mediator.HeaderComponentMediator",parent:puremvc.Mediator},{listNotificationInterests:function(){return[jet.AppConstants.ADD_TOC,jet.AppConstants.ADD_RESOURCES,jet.AppConstants.ADD_TITLE,jet.AppConstants.REQUEST_NODE,jet.AppConstants.REQUEST_UPDATE_MENUS,jet.AppConstants.ADD_SETTINGS,jet.AppConstants.REQUEST_HANDLE_PROJECT_NAME]},handleNotification:function(f){switch(f.getName()){case jet.AppConstants.ADD_TOC:if($("body").hasClass("epub3")){return}var e=f.getBody();var d=e.tocItems;var b=e.settings;if(b!=null&&b["Table of Contents"]!=null){var a=Number(b["Table of Contents"]);switch(a){case (0):break;case (1):this.viewComponent.addMenu_1(d);break;case (2):this.viewComponent.addTOC(d);break;case (3):this.viewComponent.addMenu_2(d);break;case (4):this.viewComponent.addMenu_3(d);break;default:this.viewComponent.addTOC(d);break}}else{this.viewComponent.addTOC(d)}break;case jet.AppConstants.ADD_RESOURCES:var e=f.getBody();var d=e.tocItems;this.viewComponent.addResourceTabs_1(d);break;case jet.AppConstants.ADD_TITLE:var e=f.getBody();var b=e.settings;if(b!=null&&b.Title!=null){this.viewComponent.addTitle(b.Title)}break;case jet.AppConstants.ADD_SETTINGS:var e=f.getBody();var b=e.settings;if(b!=null&&b.displayADA!=null){this.viewComponent.displayADA(b.displayADA)}if(b!=null&&b.displayPrint!=null){this.viewComponent.displayPrint(b.displayPrint)}if(b!=null&&b.displayNotes!=null){this.viewComponent.displayNotes(b.displayNotes)}if(b!=null&&b.displayEPub!=null){this.viewComponent.displayEpub(b.displayEPub)}if(b!=null&&b.displayMap!=null){this.viewComponent.displayMap(b.displayMap)}break;case jet.AppConstants.REQUEST_UPDATE_MENUS:case jet.AppConstants.REQUEST_NODE:this.updateMenu(f.getBody());break;case jet.AppConstants.REQUEST_HANDLE_PROJECT_NAME:this.viewComponent.handleProjectName()}},onRegister:function(){this.setViewComponent(new jet.view.navigation.HeaderComponent(this))},onRemove:function(){this.setHeaderComponent(null)},requestNode:function(a){this.facade.sendNotification(jet.AppConstants.REQUEST_NODE,a);this.facade.sendNotification(jet.AppConstants.HIDE_CHECK_ANSWER_BUTTON)},updateMenu:function(a){this.viewComponent.updateMenu(a)}},{NAME:"HeaderComponentMediator"});puremvc.define({name:"jet.view.mediator.MapMediator",parent:puremvc.Mediator},{markers:[],infoWindows:[],listNotificationInterests:function(){return[jet.AppConstants.ALERT_MAP,jet.AppConstants.SET_GEOLOCATION]},handleNotification:function(a){switch(a.getName()){case jet.AppConstants.ALERT_MAP:this.handleAlert(a.body);break;case jet.AppConstants.SET_GEOLOCATION:this.handleLocation(a.body);break}},onRegister:function(){var d=$(".viewer")[0];var b=document.createElement("div");b.className="mapDiv";$(b).hide();$(b).attr("id","mapDiv");$(b).css("height","100%");$(b).css("min-height","500px");$(b).css("background-color","#000000");$(b).css("margin-top","100px");var a=this;$("body").append(b);$(".mapButton").on("click",function(){a.closeAllInfoWindows();if($(".mapButton").text()=="Hide Map"){$(".mapButton").text("Show Map");$(".showLocationButton").hide()}else{$(".mapButton").text("Hide Map");$(".showLocationButton").show()}$(b).toggle();$(d).toggle();google.maps.event.trigger(googleMap,"resize");googleMap.fitBounds(a.gParams.geoBounds)});$(".showLocationButton").on("click",function(){if(navigator.geolocation){var e=a.gParams.userLocation;a.gParams.locationMarker.setPosition(e);googleMap.setCenter(e)}});this.loadScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyAOO4XYYdIs_P43Q1R_swgHPDqLCKT488Y &callback=initGoogleMap",this.callback)},onRemove:function(){},loadScript:function(b,d){var a=this;$.getScript(b,this.callback.bind(a))},callback:function(){var a="0000FF";var e=new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|"+a);var d={path:google.maps.SymbolPath.CIRCLE,scale:4,strokeColor:a};var b=this;this.gParams.myNodesInterval=setInterval(b.checkForNodes.bind(b),1000);b.gParams.locationMarker=new google.maps.Marker({map:googleMap,title:"My Location",icon:d})},gParams:{nodesMessage:{nodes:null},myNodesInterval:null,firstLocation:null,geoBounds:null,locationMarker:null,userLocation:null},checkForNodes:function(){var a=this;$(".showLocationButton").hide();jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODES,a.gParams.nodesMessage);if(a.gParams.nodesMessage&&a.gParams.nodesMessage.nodes!=null){clearInterval(a.gParams.myNodesInterval);a.createMarkers(a.gParams)}},createMarkers:function(h){var d=h.nodesMessage.nodes;var q=null;var l=null;var p=null;var b=new google.maps.LatLngBounds();for(var m=0;m<d.length;m++){var e=d[m];var n=e.uid;var f=e.node;if(f&&f.getLatitude&&f.getLongitude){var o=this.normalizeCoordinate(f.getLatitude());var a=this.normalizeCoordinate(f.getLongitude());if(f.getTitle){p=f.getTitle()}var k={lat:o,lng:a};if(m==0){h.firstLocation=k}if(!isNaN(o)&&!isNaN(a)&&o!=0&&a!=0&&o!="undefined"&&a!="undefined"){var j=new google.maps.Marker({position:k,map:googleMap,title:p});this.markers.push(j);j.uid=n;j.addListener("click",function(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE,this.uid);$(".mapButton").click()});b.extend(j.getPosition())}}}h.geoBounds=b},normalizeCoordinate:function(b){if(b!=null&&b!=undefined){var a=b.split(" ");if(a.length>0){b=this.convertTokens(a)}return b}return 0},convertTokens:function(b){var f=0;var e=0;var a=0;var d=0;if(b.length>0){e=Number(b[0])}if(b.length>1){a=Number(b[1])}if(b.length>2){d=Number(b[2])}f=e+((a*60)+d)/3600;return f},handleLocationError:function(a,b,d){b.setPosition(d);b.setContent(a?"Error: Location service failed.":"Error: Your browser doesn't support location services.")},startLocationFinder:function(){},handleLocation:function(d){if(d==null||d==undefined){return}if(d.coords.accuracy<=50){var b=d.coords;var a={lat:b.latitude,lng:b.longitude};this.gParams.userLocation=a;this.gParams.locationMarker.setPosition(a)}},setUpTest:function(){var b=document.createElement("button");$(b).attr("id","testButton");$(b).css("width","40px");$(b).css("height","40px");$(b).css("position","fixed");$(b).css("top","10px");$(b).css("left","90%");$(b).css("min-height","40px");$(b).css("background-color","#FFFFF");$(b).val("Test");$(b).on("click",function(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.ALERT_MAP,"1488419658916")});var a=this;$("body").append(b)},handleAlert:function(b){var a=this;$.each(this.markers,function(d,h){if(h.uid==b){var e="You have reached "+h.title+". Click on red marker or on 'Hide Map' to learn more.";var f=new google.maps.InfoWindow({content:e});a.infoWindows.push(f);f.open(googleMap,h)}})},closeAllInfoWindows:function(){$.each(this.infoWindows,function(a,b){b.close()})}},{NAME:"MapMediator"});puremvc.define({name:"jet.view.mediator.NavigatorComponentMediator",parent:puremvc.Mediator},{automateProgressBar:true,listNotificationInterests:function(){return[jet.AppConstants.REQUEST_NAV_BEGIN,jet.AppConstants.REQUEST_NAV_END,jet.AppConstants.REQUEST_NAV_NORMAL,jet.AppConstants.REQUEST_NAV_SUSPEND,jet.AppConstants.REQUEST_NAV_NEXT,jet.AppConstants.REQUEST_NAV_BACK,jet.AppConstants.HIDE_CHECK_ANSWER_BUTTON,jet.AppConstants.SHOW_CHECK_ANSWER_BUTTON,jet.AppConstants.SHOW_FEEDBACK_MESSAGE,jet.AppConstants.DISABLE_CHECK_ANSWER_BUTTON,jet.AppConstants.REQUEST_NAV_DISABLE_BACK,jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD,jet.AppConstants.REQUEST_NAV_DISABLE,jet.AppConstants.REQUEST_UPDATE_PROGRESSBAR,jet.AppConstants.REQUEST_MANUAL_UPDATE_PROGRESSBAR,jet.AppConstants.ADD_SETTINGS]},handleNotification:function(d){switch(d.getName()){case jet.AppConstants.REQUEST_NAV_BEGIN:this.disablePrevious();break;case jet.AppConstants.REQUEST_NAV_END:this.disableNext();break;case jet.AppConstants.REQUEST_NAV_NORMAL:this.enableAll();break;case jet.AppConstants.REQUEST_NAV_SUSPEND:this.disableNext();this.disablePrevious();break;case jet.AppConstants.REQUEST_NAV_NEXT:this.enableNext();break;case jet.AppConstants.REQUEST_NAV_BACK:this.enablePrevious();break;case jet.AppConstants.SHOW_CHECK_ANSWER_BUTTON:this.showCheckAnswer();break;case jet.AppConstants.HIDE_CHECK_ANSWER_BUTTON:this.hideCheckAnswer();break;case jet.AppConstants.DISABLE_CHECK_ANSWER_BUTTON:this.disableCheckButton();break;case jet.AppConstants.SHOW_FEEDBACK_MESSAGE:this.showFeedbackMessage(d.getBody());break;case jet.AppConstants.REQUEST_NAV_DISABLE_BACK:this.disablePrevious();break;case jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD:this.disableNext();break;case jet.AppConstants.REQUEST_NAV_DISABLE:this.disableNext();this.disablePrevious();break;case jet.AppConstants.REQUEST_UPDATE_PROGRESSBAR:if(this.automateProgressBar==true){this.updateProgressBar(d.getBody())}break;case jet.AppConstants.REQUEST_MANUAL_UPDATE_PROGRESSBAR:this.automateProgressBar=false;this.updateProgressBar(d.getBody());break;case jet.AppConstants.ADD_SETTINGS:var b=d.getBody();var a=b.settings;if(a!=null&&a.displayNAV!=null){this.viewComponent.displayNAV(a.displayNAV)}break}},onRegister:function(){this.setViewComponent(new jet.view.navigation.NavigationComponent(this))},onRemove:function(){this.setViewComponent(null)},handleEvent:function(a){},moveForward:function(){this.sendNotification(jet.AppConstants.FORWARD,null)},moveBackward:function(){this.sendNotification(jet.AppConstants.BACK,null)},enableAll:function(){this.viewComponent.enableNext();this.viewComponent.enablePrevious()},enableNext:function(){this.viewComponent.disableNext();this.viewComponent.enableNext()},enablePrevious:function(){this.viewComponent.disableNext();this.viewComponent.disablePrevious();this.viewComponent.enablePrevious()},disablePrevious:function(){this.viewComponent.disablePrevious()},disableNext:function(){this.viewComponent.disableNext()},showCheckAnswer:function(){this.viewComponent.showCheckAnswer()},hideCheckAnswer:function(){this.viewComponent.hideCheckAnswer()},disableCheckButton:function(){this.viewComponent.disableCheckButton()},showFeedbackMessage:function(a){this.viewComponent.showFeedbackMessage(a)},processQuestion:function(a){a.sendNotification(jet.AppConstants.REQUEST_USER_ACTIVITY,null)},updateProgressBar:function(a){this.viewComponent.updateProgressBar(a.value,a.max)}},{NAME:"NavigatorComponentMediator"});puremvc.define({name:"jet.view.mediator.PageMediator",parent:puremvc.Mediator},{nodes:[],tocItems:[],resourceItems:[],pageLabels:{},resourceLabels:{},queue:[],index:0,settings:{},direction:jet.AppConstants.FORWARD,listNotificationInterests:function(){return[jet.AppConstants.FORWARD,jet.AppConstants.BACK,jet.AppConstants.REQUEST_NEXT_PAGE,jet.AppConstants.REQUEST_NAV_RESUME,jet.AppConstants.REQUEST_USER_ACTIVITY,jet.AppConstants.REPORT_INTERNALLY,jet.AppConstants.REPORT_FEEDBACK_INTERNALLY,jet.AppConstants.REQUEST_NODE,jet.AppConstants.REQUEST_NODES,jet.AppConstants.JUMP_TO_PAGE,jet.AppConstants.JUMP_TO_VALUE,jet.AppConstants.REQUEST_RESET_PAGE,jet.AppConstants.REQUEST_REMOVE_FROM_FLOW,jet.AppConstants.REQUEST_REMOVE_FROM_FLOW_BY_ID,jet.AppConstants.REQUEST_ADD_RESOURCE,jet.AppConstants.REQUEST_REMOVE_RESOURCE,jet.AppConstants.OPEN_URL,jet.AppConstants.ADD_OVERLAY,jet.AppConstants.REPORT_TO_JOURNAL,jet.AppConstants.REQUEST_NODE_RESOURCE,jet.AppConstants.REPORT_CONFIRMATION,jet.AppConstants.REQUEST_RESET_ALL_INTERACTIVITY,]},handleNotification:function(j){switch(j.getName()){case jet.AppConstants.FORWARD:this.direction=jet.AppConstants.FORWARD;if(this.isCurrentNodeAGate()&&this.queue.length<1){return}this.nextNode();break;case jet.AppConstants.REQUEST_NEXT_PAGE:this.direction=jet.AppConstants.FORWARD;this.nextNode();break;case jet.AppConstants.BACK:this.direction=jet.AppConstants.BACK;this.previousNode();break;case jet.AppConstants.REQUEST_NODE:this.showNode(j.getBody(),true);break;case jet.AppConstants.REQUEST_NODES:this.getNodes(j.getBody());break;case jet.AppConstants.OPEN_URL:this.openURL(j.getBody(),true);break;case jet.AppConstants.JUMP_TO_PAGE:this.jumpToPage(j.getBody(),true);break;case jet.AppConstants.JUMP_TO_VALUE:var k=getValue(j.getBody());this.jumpToValue(k);break;case jet.AppConstants.REQUEST_RESET_PAGE:this.resetPage();break;case jet.AppConstants.REQUEST_RESET_ALL_INTERACTIVITY:this.resetInteractivity();break;case jet.AppConstants.REQUEST_REMOVE_FROM_FLOW:this.removePageFromFlow();break;case jet.AppConstants.REQUEST_REMOVE_FROM_FLOW_BY_ID:this.removePageFromFlowByID(j.getBody());break;case jet.AppConstants.REQUEST_ADD_RESOURCE:this.addNewResourceItem(j.getBody());break;case jet.AppConstants.REQUEST_REMOVE_RESOURCE:this.removeResourceItem(j.getBody());break;case jet.AppConstants.ADD_OVERLAY:this.addOverlay(j.getBody(),true);break;case jet.AppConstants.REQUEST_NODE_RESOURCE:this.showNodeAsResource(j.getBody(),true);break;case jet.AppConstants.REQUEST_NAV_RESUME:this.resumeNavigation();break;case jet.AppConstants.REQUEST_USER_ACTIVITY:var f=this.nodes[this.index];var h=f.uid;var l=f.node.evaluateUserActivity();this.facade.sendNotification(jet.AppConstants.SHOW_FEEDBACK_MESSAGE,l);this.reportUserActivity(f.node,h);var a=f.node.getIsUserCorrect();this.processFeedbackAndBranchingOptions(f.node,a,null);this.facade.sendNotification(jet.AppConstants.DISABLE_CHECK_ANSWER_BUTTON,null);this.sendNotification(jet.AppConstants.REQUEST_NAV_RESUME,null);this.getReport();var b=a?jet.AppConstants.CORRECT_ANSWER:jet.AppConstants.WRONG_ANSWER;this.facade.sendNotification(b,null);break;case jet.AppConstants.REPORT_CONFIRMATION:var f=this.nodes[this.index];f.node.processNotification(j.getName(),j.getBody());break;case jet.AppConstants.REPORT_INTERNALLY:var f=this.nodes[this.index];f.node.processNotification(j.getName(),j.getBody());var d=j.getBody();k=d.userTotal*180/d.scoreTotal;this.setMeter(k);break;case jet.AppConstants.REPORT_FEEDBACK_INTERNALLY:var e=j.getBody();var f=this.nodes[this.index];f.node.processNotification(j.getName(),j.getBody());break;case jet.AppConstants.REPORT_TO_JOURNAL:var i=j.getBody();var f=this.nodes[this.index];f.node.processNotification(j.getName(),j.getBody());break}},reportUserActivity:function(b,a){var d={uid:a,userPoints:b.getUserPoints(),totalPoints:b.getTotalPoints()};this.facade.sendNotification(jet.AppConstants.REPORT_USER_ACTIVITY,d)},reportUserFeedbackActivity:function(b){var a=b.getUserFeedback();this.facade.sendNotification(jet.AppConstants.REPORT_USER_FEEDBACK_ACTIVITY,a)},getReport:function(){this.facade.sendNotification(jet.AppConstants.GET_REPORT)},requestConfirmation:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_CONFIRMATION);var a=this.nodes[this.index];a.node.processNotification(jet.AppConstants.REQUEST_CONFIRMATION)},sendGraphData:function(){var f=[[10],[8],[2]];var d=["My Data"];var e=["#0000FF","#FF0000","#FFFF00"];var a=[{label:"Test 1"},{label:"Test 2"},{label:"Test 3"}];var b={};b.name="BARGRAPH";b.data=f;b.ticks=d;b.seriesColors=e;b.series=a;this.facade.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,b)},recordUserResponse:function(b,d){var a={uid:b,heading:d.heading,response:d.response};this.facade.sendNotification(jet.AppConstants.RECORD_USER_RESPONSE,a)},recordUserInteraction:function(a,b){this.facade.sendNotification(jet.AppConstants.RECORD_USER_INTERACTION,b)},processFeedbackAndBranchingOptions:function(f,d,a){var i;branchOptions=new Object();if(a!=null){i=a;a=null}else{var e=f.getBranchOptions();if(e==null){return}branchOptions.checkedOption=e.checkedOption;branchOptions.checkedValue=e.checkedValue;branchOptions.showFeedback=e.showFeedback;branchOptions.feedback=e.feedback;branchOptions.branchOptions=e.branchOptions;branchOptions.branchDelay=e.branchDelay;i=branchOptions}if(i.showFeedback==undefined){i.showFeedback="false";i.branchDelay=0}if(i.showFeedback.toUpperCase()=="TRUE"){var l="<p>"+i.feedback+"</p>";this.showPopup(l)}var m=parseFloat(i.branchDelay);var j=isNaN(m)?0:m*1000;var h=this.processBranchingOptions;var b=this;switch(i.branchOptions){case jet.AppConstants.BRANCH_IMMEDIATELY:setTimeout(function(){h.call(b,f,d)},j);break;case jet.AppConstants.BRANCH_NEXT_BUTTON:i.branchOptions=jet.AppConstants.BRANCH_IMMEDIATELY;i.branchDelay=0;i.showFeedback="false";var k={node:f,status:d,branchingOptions:i};this.queue.push(k);break;default:h.call(b,f,d);break}},processBranchingOptions:function(a,b){var d=a.getBranchOptions();this.executeBranch(d,b)},executeBranch:function(branchingOptions,isCorrect){if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;if(branchingOptions.uncheckedOption){whichOption=isCorrect?branchingOptions.checkedOption:branchingOptions.uncheckedOption;whichValue=isCorrect?branchingOptions.checkedValue:branchingOptions.uncheckedValue}else{whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue}switch(whichOption){case jet.AppConstants.JUMP_TO_PAGE:if(whichValue.indexOf("ID:")>-1){var uid=$.trim(whichValue).replace(/.*\(ID:|\)/g,"");this.hideNodes();this.showNode(uid,true);this.resumeNavigation();break}else{var uid=this.pageLabels[whichValue.toLowerCase()];if(uid!=null&&uid!=undefined){this.hideNodes();this.showNode(uid,true);this.resumeNavigation();break}}case jet.AppConstants.JUMP_TO_VALUE:if(whichValue.indexOf("VARIABLE:")>-1){whichValue=$.trim(whichValue).replace("VARIABLE:","");var pageTitle=getJetValue(whichValue);var uid=this.pageLabels[String(pageTitle).toLowerCase()]}if(uid!=null&&uid!=undefined){this.hideNodes();this.showNode(uid,true);this.resumeNavigation();break}break;case"Go to Next Page":this.nextNode();break;case"Go to Previous Page":this.previousNode();break;case"Reset Page":this.hideNodes();var nodeObject=this.getCurrentNode();nodeObject.node.enableInteractivity();nodeObject.node.clearFeedback();nodeObject.node.clearBranchOptions();nodeObject.node.setUserPoints(0);this.showNode(nodeObject.uid,true);this.resumeNavigation();break;case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");eval(url)}else{window.open(url,"_blank","menubar=1,resizable=1,width=800,height=600")}break;case jet.AppConstants.ADD_OVERLAY:if(whichValue.indexOf("ID:")>-1){var uid=$.trim(whichValue).replace(/.*\(ID:|\)/g,"");var nodeObject=this.findNode(uid)[0];this.showNodeAsOverlay(nodeObject)}else{var uid=this.pageLabels[whichValue.toLowerCase()];if(uid!=null&&uid!=undefined){var nodeObject=this.findNode(uid)[0];this.showNodeAsOverlay(nodeObject)}}break;case jet.AppConstants.SET_VALUE:if(whichValue.indexOf("VARIABLE:")>-1){var tokens=whichValue.split(":");if(tokens.length==3){var variableName=tokens[1];var variableValue=tokens[2];setJetValue(variableName,variableValue)}}break;case jet.AppConstants.APPEND_VALUE:if(whichValue.indexOf("VARIABLE:")>-1){var tokens=whichValue.split(":");if(tokens.length==3){var variableName=tokens[1];var variableValue=tokens[2];appendJetValue(variableName,variableValue)}}break;case jet.AppConstants.SHOW_NODE:if(whichValue.indexOf("ID:")>-1){var uid=$.trim(whichValue).replace(/.*\(ID:|\)/g,"");var nodeObject=this.findNode(uid)[0];this.showNodeAsOverlay(nodeObject)}else{var uid=this.pageLabels[whichValue.toLowerCase()];if(uid!=null&&uid!=undefined){}}break;case jet.AppConstants.REMOVE_FROM_FLOW:var nodeObject=this.getCurrentNode();nodeObject.node.setInFlow(false);break;case jet.AppConstants.EXECUTE_COMMAND:if(ParserApiHooks!=undefined&&ParserApiHooks.parse!=undefined){try{var operation=ParserApiHooks.parse(whichValue);var result=ParserApiHooks.execute(operation)}catch(e){window.alert(e)}}break}},onRegister:function(){},onRemove:function(){},nextNode:function(){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);updateNavigation=this.updateNavigation;var b=this;if(this.processQueue()){return}if(this.index<this.nodes.length-1){this.index++}var d=this.determineNextNode(true,this.index);if(d==null){return}var a=d.uid;this.hideNodes();this.showNode(a,false);setTimeout(function(){updateNavigation.call(b);d.node.postProcess()},100)},previousNode:function(){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);updateNavigation=this.updateNavigation;var b=this;if(this.processQueue()){return}if(this.index>0){this.index--}var d=this.determineNextNode(false,this.index);if(d==null){return}var a=d.uid;this.hideNodes();this.showNode(a,false);setTimeout(function(){updateNavigation.call(b)},100);d.node.postProcess()},isCurrentNodeAGate:function(){return this.nodes[this.index].node.getName().match("Gate")},determineNextNode:function(d,a){var b=this.nodes[a];if(b.node.getInFlow()==true){this.index=a;return b}else{if(d){while(a<this.nodes.length){a++;b=this.nodes[a];if(b.node.getInFlow()==true){this.index=a;return b}}return null}else{while(a>0){a--;b=this.nodes[a];if(b.node.getInFlow()==true){this.index=a;return b}}return null}}},processQueue:function(){if(this.queue.length>0){var b=this.queue[0];var d=b.node;var e=b.isCorrect;var a=b.branchingOptions;this.processFeedbackAndBranchingOptions(d,e,a);this.queue.pop();return true}return false},addNode:function(b,a){this.nodes.push({node:b,uid:a});this.updateNavigation()},addTOCItem:function(e,h){var f=null;var i;var a,d;var j=this;$(e).children().find("input").each(function(){var k=$(this).attr("optionStore");if(k=="Checkbox_TOC"){i=$(this).text()}});$(e).children().find("input").each(function(){var k=$(this).attr("optionStore");if(k=="Title"){a=$(this).text().toLowerCase();j.pageLabels[a]=h}if(k=="NodeSelector"){d=$(this).text()}});if(i=="true"){var b={title:a,uid:h,parentUid:d};this.tocItems.push(b)}},constructTOC:function(){var a={tocItems:this.tocItems,settings:this.getSettings()};this.facade.sendNotification(jet.AppConstants.ADD_TOC,a)},constructTitle:function(){var a={settings:this.getSettings()};this.facade.sendNotification(jet.AppConstants.ADD_TITLE,a)},sendSettings:function(){var a={settings:this.getSettings()};this.facade.sendNotification(jet.AppConstants.ADD_SETTINGS,a)},addResourceItem:function(e,h){var f=null;var i;var a,d;var j=this;$(e).children().find("input").each(function(){var k=$(this).attr("optionStore");if(k=="Checkbox_Resource"){i=$(this).text()}});$(e).children().find("input").each(function(){var k=$(this).attr("optionStore");if(k=="Title"){a=$(this).text();j.resourceLabels[a]=h}});if(i=="true"){var b={title:a,uid:h,};this.resourceItems.push(b)}},constructResources:function(){var a={tocItems:this.resourceItems,settings:this.getSettings()};this.facade.sendNotification(jet.AppConstants.ADD_RESOURCES,a)},getNode:function(b){var d=null;for(var a=0;a<this.nodes.length;a++){var e=this.nodes[a];if(e!=null&&e.uid==b){d=e.node;break}}return d},getCurrentNode:function(){var a=this.nodes[this.index];return a},getPreviousNode:function(){var a=null;if(this.index>0){a=this.nodes[this.index-1]}return a},getNextNode:function(){var a=null;if(this.index<this.nodes.length-1){a=this.nodes[this.index+1]}return a},hideNodes:function(){var a=this.index;$.each(this.nodes,function(b,d){d.node.show(false)})},getNodes:function(a){if(a.hasOwnProperty("nodes")){a.nodes=this.nodes}},showNode:function(b,d){var a;$.each(this.nodes,function(f,h){h.node.show(false);if(h.uid==b){a=f;h.node.show(true)}});this.index=a;var e=this.nodes[this.index];this.facade.sendNotification(jet.AppConstants.HIDE_CHECK_ANSWER_BUTTON,null);this.facade.sendNotification(jet.AppConstants.REQUEST_CLOSE_POPUP,null);if(d){if(e&&e.node){e.node.postProcess()}}this.updateNavigation()},showNodeAsResource:function(a){var b=this;$.each(this.nodes,function(d,h){if(h.uid==a){index=d;if(h.node.getHTMLContent){var e=h.node.getContentAsResource();var f=document.createElement("div");$(f).addClass("colorboxDiv");if(e=="CLONE"){var i=h.node.getClonedContent();i.css("visibility","visible");i.css("display","block");i.appendTo(f)}else{$(f).html(e)}$("body").append(f);$.colorbox({html:f,maxWidth:"95%",maxHeight:"95%",overlayClose:true,onComplete:function(){b.updateNavigation()}})}}})},showNodeAsLayer:function(a){$.each(this.nodes,function(b,d){if(d.uid==a){d.node.show(true)}})},showFirstNode:function(){if(this.nodes.length>0){var b=this.nodes[0];var a=b.uid;this.showNode(a,true)}this.retrieveSCORMData()},retrieveSCORMData:function(){var a=0;var b=this.facade;var e=this;b.sendNotification(jet.AppConstants.REQUEST_USER_DATA,null);var d=setInterval(function(){a++;if(LMSIsInitialized()||a>5){b.sendNotification(jet.AppConstants.REQUEST_USER_DATA,null);clearInterval(d);$("body").css("cursor","auto");e.updateNavigation()}},1000)},updateNavigation:function(){this.facade.sendNotification(jet.AppConstants.PAUSE_VIDEO,null);if(this.index>=this.nodes.length-1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD,null)}if(this.index<1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_BACK,null)}if(this.index>0&&this.index<this.nodes.length-1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_NORMAL,null)}if(this.index==0&&this.index<this.nodes.length-1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_NEXT,null)}if(this.index==this.nodes.length-1&&this.index>0){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_BACK,null)}if(this.nodes.length<=1){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE,null)}this.facade.sendNotification(jet.AppConstants.REQUEST_UPDATE_PROGRESSBAR,{value:this.index,max:this.nodes.length-1});this.facade.sendNotification(jet.AppConstants.REQUEST_UPDATE_MENUS,this.getCurrentNode().uid);this.processWallsAndGates()},processWallsAndGates:function(){if(this.index>0&&this.nodes[this.index-1].node.getName().match("Wall|Gate")){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_BACK,null)}if(this.index<this.nodes.length-1&&this.nodes[this.index+1].node.getName().match("Wall")){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD,null)}for(var b=this.index-1;b>0;b--){if(this.nodes[b].node.getName()=="Gate"){var d=this.nodes[b].node;var a=d.getNavigationDefault();if(a=="true"){if(d.getAllowNext()=="false"){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_FORWARD,null)}if(d.getAllowBack()=="false"){this.facade.sendNotification(jet.AppConstants.REQUEST_NAV_DISABLE_BACK,null)}}else{continue}break}}},showCheckAnswerButton:function(){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);this.facade.sendNotification(jet.AppConstants.SHOW_CHECK_ANSWER_BUTTON,null)},setData:function(a){},getProperties:function(a){lxmlProxy=this.facade.retrieveProxy(jet.model.proxy.LXMLProxy.NAME);return lxmlProxy.getProperties(a)},parseProperties:function(a,b){this.facade.sendNotification(jet.AppConstants.PARSE_PROPERTIES,{component:a,properties:b})},handleEvent:function(a){},setMediator:function(a){this.mediator=a},buttonClick:function(){this.facade.sendNotification(jet.AppConstants.SHOW_CHECK_ANSWER_BUTTON,null)},requestReport:function(){this.facade.sendNotification(jet.AppConstants.REPORT_TO_SCORM_API,null)},requestConfirmationReport:function(){this.facade.sendNotification(jet.AppConstants.GET_REPORT_FROM_SCORM_API,null)},requestFeedbackReport:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_FEEDBACK_REPORT,null)},requestJournalReport:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_JOURNAL_REPORT,null)},requestObjectiveAnswersReport:function(){this.facade.sendNotification(jet.AppConstants.RECORD_OBJECTIVE_RESPONSES,null)},resetScore:function(){this.facade.sendNotification(jet.AppConstants.RESET_SCORES,null);for(var a=0;a<this.nodes.length;a++){this.nodes[a].node.enableInteractivity();this.nodes[a].node.clearFeedback();this.nodes[a].node.clearBranchOptions();this.nodes[a].node.setUserPoints(0)}},resetInteractivityOnly:function(){for(var a=0;a<this.nodes.length;a++){this.nodes[a].node.enableInteractivity();this.nodes[a].node.clearFeedback();this.nodes[a].node.clearBranchOptions();this.nodes[a].node.setUserPoints(0)}},resetInteractivity:function(){for(var a=0;a<this.nodes.length;a++){this.nodes[a].node.enableInteractivity();this.nodes[a].node.clearFeedback();this.nodes[a].node.clearBranchOptions()}},resetCustomScores:function(a){a=a.replace(/ /g,"");var d=a.split(",");for(var b=0;b<d.length;b++){setJetValue(d[b],0)}},findNode:function(a){return $.grep(this.nodes,function(b){return b.uid==a?true:false})},showNodeAsOverlay:function(a){this.facade.sendNotification(jet.AppConstants.REQUEST_OVERLAY,a)},showPopup:function(a){this.facade.sendNotification(jet.AppConstants.REQUEST_POPUP,a)},showToolTip:function(b,a,e){var d={htmlString:b,xpos:a,ypos:e};this.facade.sendNotification(jet.AppConstants.REQUEST_TOOLTIP,d)},hideToolTip:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_CLOSE_TOOLTIP)},showMeter:function(b,a,e){var d={htmlString:b,xpos:a,ypos:e};this.facade.sendNotification(jet.AppConstants.REQUEST_METER,d)},setMeter:function(a){this.facade.sendNotification(jet.AppConstants.SET_METER,a)},hideMeter:function(){this.facade.sendNotification(jet.AppConstants.REQUEST_CLOSE_METER)},resumeNavigation:function(){this.updateNavigation()},setSettings:function(a){this.settings=a},getSettings:function(){return this.settings},startShowTransition:function(h){if(h==null||h==undefined){return}var e=this.getSettings();var i=e.Transition;var b=Number(e["Transition Time"]);switch(i){case"0":h.show();break;case"1":h.fadeIn(b);break;case"2":h.show();break;var f="-930px";var a="930px";if(this.direction==jet.AppConstants.FORWARD){f="-=930px";a="930px"}else{f="+=930px";a="-930px"}h.css("left",a);h.show();var d=h;h.animate({left:f},b,function(){});break;case"3":h.show({effect:"clip",duration:b});break;case"4":h.show({effect:"highlight",duration:b});break;default:h.show();break}},startHideTransition:function(d){if(d==null||d==undefined){return}var b=this.getSettings();var e=b.Transition;var a=Number(b["Transition Time"]);if(this.index<1){e="0"}switch(e){case"0":d.hide();break;case"1":d.fadeOut(a);break;case"2":d.hide();break;case"5":d.hide({effect:"explode",pieces:9,duration:a});break;default:d.hide();break}},jumpToPage:function(a){if(a.indexOf("ID:")>-1){var b=$.trim(a).replace(/.*\(ID:|\)/g,"");this.hideNodes();this.showNode(b,true);this.resumeNavigation()}else{a=a.toLowerCase();a=a.replace(/ /g,"");var d=this.findProperty(this.pageLabels,a);var b=this.pageLabels[d];if(b!=null&&b!=undefined){this.hideNodes();this.showNode(b,true);this.resumeNavigation()}}},jumpToValue:function(a){if(a.indexOf("VARIABLE:")>-1){a=$.trim(a).replace("VARIABLE:","");var d=getJetValue(a);var b=this.pageLabels[String(d).toLowerCase()]}if(b!=null&&b!=undefined){this.hideNodes();this.showNode(b,true);this.resumeNavigation()}},openURL:function(whichValue){var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");eval(url)}else{window.open(url,"_blank","menubar=1,resizable=1,width=800,height=600")}},addOverlay:function(a){if(a.indexOf("ID:")>-1){var b=$.trim(a).replace(/.*\(ID:|\)/g,"");var d=this.findNode(b)[0];this.showNodeAsOverlay(d)}else{var b=this.pageLabels[a.toLowerCase()];if(b!=null&&b!=undefined){var d=this.findNode(b)[0];this.showNodeAsOverlay(d)}}},resetPage:function(){this.hideNodes();var a=this.getCurrentNode();a.node.enableInteractivity();a.node.clearFeedback();a.node.clearBranchOptions();a.node.setUserPoints(0);this.showNode(a.uid,true);this.resumeNavigation()},removePageFromFlow:function(){var a=this.getCurrentNode();a.node.setInFlow(false)},removePageFromFlowByID:function(a){var b=this.pageLabels[a.toLowerCase()];if(b!=null&&b!=undefined){var d=this.findNode(b)[0];d.node.setInFlow(false)}},addNewResourceItem:function(d){var b=this.pageLabels[d.toLowerCase()];if(!this.isResourceItem(d)){this.resourceLabels[d]=b;var a={title:d,uid:b,};this.resourceItems.push(a);this.constructResources()}},removeResourceItem:function(a){this.resourceItems=this.resourceItems.filter(this.resourceFilter,a);this.constructResources()},resourceFilter:function(d,b,e){var a=d;if(a.title==this){return false}return true},isResourceItem:function(d){for(var b=0;b<this.resourceItems.length;b++){var a=this.resourceItems[b];if(a.title==d){return true}}return false},findProperty:function(d,b){var a=null;for(prop in d){a=prop;prop=prop.toLowerCase();prop=prop.replace(/ /g,"");if(prop==b){return a}}return a}},{NAME:"QuestionPageMediator"});puremvc.define({name:"jet.view.mediator.QuestionProcessorMediator",parent:puremvc.Mediator},{report:{},startTime:null,feedbackReport:[],interactionID:-1,interactions:[],objectiveQuestionInteractions:[],learnerName:"testUser",customTotalScore:null,customUserScore:null,listNotificationInterests:function(){return[jet.AppConstants.SET_SCORE,jet.AppConstants.GET_SCORE,jet.AppConstants.SET_CUSTOM_USER_SCORE,jet.AppConstants.SET_CUSTOM_TOTAL_SCORE,jet.AppConstants.GET_REPORT,jet.AppConstants.GET_TOTAL_POINTS,jet.AppConstants.INCREMENT_SCORE,jet.AppConstants.INCREMENT_TOTAL_POINTS,jet.AppConstants.RESET_SCORES,jet.AppConstants.RESET_SECTION_SCORES,jet.AppConstants.REPORT_USER_ACTIVITY,jet.AppConstants.REPORT_TO_SCORM_API,jet.AppConstants.REQUEST_CONFIRMATION,jet.AppConstants.RECORD_USER_RESPONSE,jet.AppConstants.RECORD_USER_INTERACTION,jet.AppConstants.REQUEST_FEEDBACK_REPORT,jet.AppConstants.REPORT_USER_FEEDBACK_ACTIVITY,jet.AppConstants.REQUEST_JOURNAL_REPORT,jet.AppConstants.REQUEST_USER_DATA,jet.AppConstants.STORE_USER_RESPONSES,jet.AppConstants.RECORD_OBJECTIVE_RESPONSES,jet.AppConstants.ADD_SETTINGS,jet.AppConstants.REQUEST_SUSPEND_DATA,jet.AppConstants.REQUEST_RETRIEVE_DATA,jet.AppConstants.REQUEST_CLEAR_JET_DATA,jet.AppConstants.SET_COMPLETION_STATUS,]},handleNotification:function(j){switch(j.getName()){case jet.AppConstants.INCREMENT_SCORE:this.incrementScore();break;case jet.AppConstants.INCREMENT_TOTAL_POINTS:this.incrementTotalPoints();break;case jet.AppConstants.GET_SCORE:this.getScore();break;case jet.AppConstants.SET_CUSTOM_USER_SCORE:var k=j.getBody();var f=k;this.setCustomUserScore(f);break;case jet.AppConstants.SET_CUSTOM_TOTAL_SCORE:var k=j.getBody();var f=k;this.setCustomTotalScore(f);break;case jet.AppConstants.GET_REPORT:this.getReport();break;case jet.AppConstants.GET_TOTAL_POINTS:this.getTotalPoints();break;case jet.AppConstants.REPORT_USER_ACTIVITY:var k=j.getBody();this.report[k.uid]={userPoints:k.userPoints,totalPoints:k.totalPoints};break;case jet.AppConstants.REPORT_USER_FEEDBACK_ACTIVITY:var k=j.getBody();this.feedbackReport.push(k);break;case jet.AppConstants.RECORD_USER_RESPONSE:var k=j.getBody();uid=k.uid;heading=k.heading;response=k.response;this.reportUserResponseToSCORMAPI(uid,heading,response);break;case jet.AppConstants.RECORD_OBJECTIVE_RESPONSES:this.reportObjectiveResponsesToSCORMAPI();break;case jet.AppConstants.RECORD_USER_INTERACTION:var k=j.getBody();uid=k.uid;var a=k.questionType;var e=k.question;var i=k.learnerResponse;var h=k.correctResponse;var l=k.result;this.reportUserInteractionToSCORMAPI(uid,a,e,i,h,l);break;case jet.AppConstants.REPORT_TO_SCORM_API:this.getReport();this.reportToSCORMAPI();break;case jet.AppConstants.REQUEST_CONFIRMATION:this.getReportFromSCORMAPIAfterDelay();break;case jet.AppConstants.RESET_SCORES:this.report=null;this.report={};this.feedbackReport=null;this.feedbackReport=[];break;case jet.AppConstants.REQUEST_FEEDBACK_REPORT:this.getFeedbackReport();break;case jet.AppConstants.REQUEST_JOURNAL_REPORT:this.getJournalReport();break;case jet.AppConstants.REQUEST_USER_DATA:this.getUserData();break;case jet.AppConstants.STORE_USER_RESPONSES:this.storeUserResponses();break;case jet.AppConstants.REQUEST_SUSPEND_DATA:this.suspendData();break;case jet.AppConstants.REQUEST_RETRIEVE_DATA:this.retrieveData();break;case jet.AppConstants.REQUEST_CLEAR_JET_DATA:this.clearData();break;case jet.AppConstants.SET_COMPLETION_STATUS:var k=j.getBody();var f=k;this.setCompletionStatus(f);break;case jet.AppConstants.ADD_SETTINGS:var d=j.getBody();var b=d.settings;if(b!=null&&b.enforceSCORM!=null){if(b.enforceSCORM=="0"&&LMSIsInitialized&&!LMSIsInitialized()){alert("You are not connected to a Learning Management System.  No record of your performance will be kept.")}}break}},onRegister:function(){this.startTime=Date.now()},onRemove:function(){},handleEvent:function(a){},addQuestion:function(a,b){questionArray.push({uid:a,keys:b})},incrementScore:function(a){},incrementTotalPoints:function(a){},getScore:function(){},getCustomUserScore:function(){return this.customUserScore},setCustomUserScore:function(a){this.customUserScore=a},getCustomTotalScore:function(){return this.customTotalScore},setCustomTotalScore:function(a){this.customTotalScore=a},getTotalPoints:function(){},getReport:function(){this.facade.sendNotification(jet.AppConstants.REPORT_INTERNALLY,this.getReportSummary())},getFeedbackReport:function(){this.facade.sendNotification(jet.AppConstants.REPORT_FEEDBACK_INTERNALLY,this.feedbackReport)},getJournalReport:function(){this.facade.sendNotification(jet.AppConstants.REPORT_TO_JOURNAL,this.interactions)},getReportSummary:function(){if(this.getCustomReportSummary()!=null){return this.getCustomReportSummary()}var b=0;var a=0;$.each(this.report,function(f,e){var h=parseFloat(e.userPoints);h=isNaN(h)?0:h;var d=parseFloat(e.totalPoints);d=isNaN(d)?0:d;a+=h;b+=d});return({userTotal:a,scoreTotal:b})},getCustomReportSummary:function(){var b=this.getCustomTotalScore();var a=this.getCustomUserScore();if(b!=null&&a!=null){return({userTotal:a,scoreTotal:b})}else{return null}},reportToSCORMAPI:function(){var a=this.getReportSummary();var f=a.userTotal;var h=a.scoreTotal;var d=this.getSessionTime();try{var e=f/h;doSetValue("cmi.score.scaled",e);doSetValue("cmi.score.min",0);doSetValue("cmi.score.max",h);doSetValue("cmi.score.raw",f);doSetValue("cmi.session_time",d);doSetValue("cmi.completion_status","completed");window.setTimeout(this.executeDoCommit,1000)}catch(b){alert(b)}},getReportFromSCORMAPIAfterDelay:function(){window.setTimeout(this.getReportFromSCORMAPI,5000)},getReportFromSCORMAPI:function(){var l=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var j=LMSIsInitialized();if(!j){var b="You are not currently connected to a Learning Management System. Your scores are not saved.";var m={status:"Failure",message:b};l.sendNotification(jet.AppConstants.REPORT_CONFIRMATION,m);return}var e=null;var f=null;var i=null;var k=null;var h=null;var d=null;try{i=doGetValue("cmi.score.scaled");k=doGetValue("cmi.score.min");h=doGetValue("cmi.score.max");d=doGetValue("cmi.score.raw");var m={status:"Success",message:"Success",scaledScore:i,minValue:k,maxValue:h,rawValue:d};l.sendNotification(jet.AppConstants.REPORT_CONFIRMATION,m)}catch(a){alert(a)}},reportUserResponseToSCORMAPI:function(d,f,a){this.storeUserResponse(d,f,a);try{var e=doGetValue("cmi.interactions._count");doSetValue("cmi.interactions."+e+".id","urn:lodestarlearning.com/"+d);doSetValue("cmi.interactions."+e+".type","long-fill-in");doSetValue("cmi.interactions."+e+".learner_response",a);this.storeUserResponses();window.setTimeout(this.executeDoCommit,1000)}catch(b){alert(b)}},reportUserInteractionToSCORMAPI:function(h,d,b,i,f,a){try{var j=doGetValue("cmi.interactions._count");doSetValue("cmi.interactions."+j+".id","urn:lodestarlearning.com/"+h);doSetValue("cmi.interactions."+j+".type",d);doSetValue("cmi.interactions."+j+".description",b);doSetValue("cmi.interactions."+j+".learner_response",i);doSetValue("cmi.interactions."+j+".correct_responses."+j+".pattern",f);doSetValue("cmi.interactions."+j+".result",a);window.setTimeout(this.executeDoCommit,1000);this.storeObjectiveResponse(h,d,b,i,f,a)}catch(e){alert(e)}},getInteractionData:function(){try{var response=doGetValue("cmi.suspend_data");if(response!=null&&response!=undefined&&response.length>0){this.interactions=eval(response)}}catch(exception){alert("ActivityMaker reports a SCORM Data retrieval problem: "+exception)}},getUserData:function(){try{if(LMSIsInitialized()==true){var response=doGetValue("cmi.learner_name");if(response!=null&&response!=undefined&&response.length>0){this.learnerName=response}}}catch(exception){}finally{if(localStorage!=null){var response=eval(localStorage[window.location+"/"+this.learnerName])}if(response!=null&&response!=undefined&&response.length>0&&typeof response=="object"){this.interactions=response}}},getUserResponse:function(d){for(var b=0;b<this.interactions.length;b++){var a=this.interactions[b];if(a.uid==d){return a.response}}return null},getUserResponseObject:function(d){for(var b=0;b<this.interactions.length;b++){var a=this.interactions[b];if(a.uid==d){return a}}return null},getObjectiveResponseObject:function(d){for(var b=0;b<this.objectiveQuestionInteractions.length;b++){var a=this.objectiveQuestionInteractions[b];if(a.uid==d){return a}}return null},storeUserResponses:function(){try{var b=JSON.stringify(this.interactions);localStorage[window.location+"/"+this.learnerName]=b}catch(a){alert(a)}},reportObjectiveResponsesToSCORMAPI:function(){try{if(this.objectiveQuestionInteractions.length<1){return}var b=JSON.stringify(this.objectiveQuestionInteractions);try{var d=doGetValue("cmi.interactions._count");doSetValue("cmi.interactions."+d+".id","urn:lodestarlearning.com/"+uid);doSetValue("cmi.interactions."+d+".type","long-fill-in");doSetValue("cmi.interactions."+d+".learner_response",b);window.setTimeout(this.executeDoCommit,1000)}catch(a){alert(a)}}catch(a){alert(a)}},storeUserResponse:function(d,e,b){var a=this.getUserResponseObject(d);if(a==null){a={uid:"",heading:"",response:""};this.interactions.push(a)}a.uid=d;a.heading=e;a.response=b},storeObjectiveResponse:function(h,e,d,i,f,a){var b=this.getObjectiveResponseObject(h);if(b==null){b={uid:h,questionType:e,question:d,learnerResponse:i,correctResponse:f,result:a};this.objectiveQuestionInteractions.push(b)}},getSessionTime:function(){var e=Date.now()-this.startTime;var h=e/1000;var f=Math.floor(((h%31536000)%86400)/3600);var b=Math.floor((((h%31536000)%86400)%3600)/60);var a=parseInt((((h%31536000)%86400)%3600)%60);var d=f+":"+b+":"+a;return d},executeDoCommit:function(){doCommit()},suspendData:function(){var a=getJetStore();if(console&&console.log){console.log(String(a))}var b=doSetValue("cmi.completion_status","incomplete");window.setTimeout(this.executeDoCommit,1000);var b=doSetValue("cmi.suspend_data",a);if(console&&console.log){console.log("LMS reports:"+b)}window.setTimeout(this.executeDoCommit,1000);localStorage[window.location+"/"+this.learnerName+"/jetStore"]=a},clearData:function(){clearJetStore()},setCompletionStatus:function(a){var b=doSetValue("cmi.completion_status",a);if(a=="completed"){doSetValue("cmi.exit","logout")}else{doSetValue("cmi.exit","suspend")}window.setTimeout(this.executeDoCommit,1000)},retrieveData:function(){var a=localStorage[window.location+"/"+this.learnerName+"/jetStore"];if(console&&console.log){console.log(a)}if(a!=null&&typeof a!="undefined"&&a!=""){setJetStore(a)}var b=doGetValue("cmi.suspend_data");if(b!=null&&typeof b!="undefined"&&b!=""){setJetStore(b);if(console&&console.log){console.log("From LMS: "+b)}}}},{NAME:"QuestionProcessorMediator"});puremvc.define({name:"jet.view.mediator.ViewerComponentMediator",parent:puremvc.Mediator},{overlayComponent:null,popupComponent:null,notesComponent:null,toolTipComponent:null,audioComponent:null,meterComponent:null,isMeter:false,listNotificationInterests:function(){return[jet.AppConstants.REQUEST_OVERLAY,jet.AppConstants.REQUEST_POPUP,jet.AppConstants.REQUEST_NOTES,jet.AppConstants.REQUEST_CLOSE_POPUP,jet.AppConstants.REQUEST_TOOLTIP,jet.AppConstants.REQUEST_CLOSE_TOOLTIP,]},handleNotification:function(a){switch(a.getName()){case jet.AppConstants.REQUEST_OVERLAY:this.showOverlay(a.getBody());break;case jet.AppConstants.REQUEST_POPUP:this.showPopup(a.getBody());break;case jet.AppConstants.REQUEST_NOTES:this.showNotes();break;case jet.AppConstants.REQUEST_CLOSE_POPUP:this.hidePopup();break;case jet.AppConstants.REQUEST_AUDIO:break;case jet.AppConstants.REQUEST_CLOSE_AUDIO:break;case jet.AppConstants.REQUEST_TOOLTIP:this.showTooltip(a.getBody());break;case jet.AppConstants.REQUEST_CLOSE_TOOLTIP:this.hideTooltip();break}},onRegister:function(){this.setViewComponent(new jet.view.component.ViewerComponent);this.setOverlayComponent(new jet.view.component.OverlayComponent(this));this.setPopupComponent(new jet.view.component.PopupComponent(this));this.setNotesComponent(new jet.view.component.NotesComponent(this));this.settoolTipComponent(new jet.view.component.TooltipComponent(this))},onRemove:function(){this.setViewComponent(null)},handleEvent:function(a){},setOverlayComponent:function(a){this.overlayComponent=a},showOverlay:function(a){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);this.overlayComponent.attachNode(a.node);this.overlayComponent.show(true)},hideOverlay:function(){this.overlayComponent.show(false)},setPopupComponent:function(a){this.popupComponent=a},setNotesComponent:function(a){this.notesComponent=a},showPopup:function(a){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);this.popupComponent.setContent(a);this.popupComponent.show(true)},hidePopup:function(a){this.popupComponent.show(false)},showNotes:function(){this.sendNotification(jet.AppConstants.REQUEST_NAV_SUSPEND,null);this.notesComponent.setHeight("70%");this.notesComponent.show(true)},settoolTipComponent:function(a){this.toolTipComponent=a},showTooltip:function(a){this.toolTipComponent.setContent(a.htmlString);this.toolTipComponent.setX(a.xpos);this.toolTipComponent.setY(a.ypos);this.toolTipComponent.show(true)},hideTooltip:function(){this.toolTipComponent.show(false)},requestResumeNavigation:function(a){this.sendNotification(jet.AppConstants.REQUEST_NAV_RESUME,null)}},{NAME:"ViewerComponentMediator"});puremvc.define({name:"jet.view.mediator.WidgetMediator",parent:puremvc.Mediator},{pageMap:{},registeredWidgets:[],listNotificationInterests:function(){return[]},handleNotification:function(a){switch(a.getName()){}},onRegister:function(){this.registeredWidgets.push(new jet.view.widget.QuestionWidget());this.registeredWidgets.push(new jet.view.widget.ShortAnswerWidget());this.registeredWidgets.push(new jet.view.widget.ImageSliderWidget())},onRemove:function(){},findWidgets:function(l,f){var k=$(f).find("div");for(var e=0;e<k.size();e++){var d=k[e];for(var b=0;b<this.registeredWidgets.length;b++){var h=this.registeredWidgets[b];var a=h.getWidgetClassName();if($(d).hasClass(a)){h.processDiv(d,l)}}}},enableInteractivity:function(d){for(var a=0;a<this.registeredWidgets.length;a++){var b=this.registeredWidgets[a];b.enableInteractivity(d)}},processBasicComponent:function(e,f,d){var b=new jet.view.component.OpenQuestionComponent;e.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(b,d);var a=this.stripBodyTags(f);b.setParent(e.contentDiv);b.setText(a);return b},stripBodyTags:function(e){var d=/(<body.*>)([\D|\d]*)(<\/body>)/ig;var b=d.exec(e);var a=b[2];if(a==""){a=b[1]}return a},},{NAME:"WidgetMediator"});puremvc.define({name:"jet.view.mediator.YouTubeMediator",parent:puremvc.Mediator},{players:null,videoIndex:0,listNotificationInterests:function(){return[jet.AppConstants.PAUSE_VIDEO,]},handleNotification:function(a){switch(a.getName()){case jet.AppConstants.PAUSE_VIDEO:this.pauseVideo(a.getBody());break}},onRegister:function(){this.players=[]},onRemove:function(){},addPlayer:function(b,d){if(typeof(YT)!="undefined"){var a=new YT.Player(b,{wmode:"transparent"});this.players.push(a)}},isYTAvailable:function(){if(typeof(YT)!="undefined"){return true}return false},getVideoIndex:function(){this.videoIndex++;return this.videoIndex},pauseVideo:function(a){if(typeof(YT)!="undefined"){for(var b=0;b<this.players.length;b++){if(typeof this.players[b].pauseVideo==="function"){this.players[b].pauseVideo()}}}},cueYTVideoById:function(b,d,e,f,a){b.src="https://www.youtube.com/embed/"+e+"?wmode=transparent&rel=0&enablejsapi=1&start="+f+"&end="+a+"&autoplay=1";$(b).css("width","98%");$(b).css("height","98%")},cueVideoById:function(b,d,e,f,a){e=e+"#t="+f+","+a;$(b).attr("src",e);b.play()},normalizeURL:function(b){if(b.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var a=b.replace(/.*?v=/,"");return a}return""},printMethods:function(d){var b=[];for(var a in d){if(typeof d[a]=="function"){b.push(a)}}alert(b.join(","))}},{NAME:"YouTubeMediator"});puremvc.define({name:"jet.model.proxy.JFXMLProxy",parent:puremvc.Proxy},{layerIndex:11,mediator:null,getUID:function(a){},parseData:function(e,h,b,f){this.layerIndex=11;var a=this;this.mediator=e;var d=$(b).children();if(d==null){return}$(b).find(jet.AppConstants.PAGE).each(function(){a.parseObjectList(a,this,h,f)});e.postProcessGraphics(h)},parseObjectList:function(b,a,f,e){if($(a).children()==null){return}var d=$(a).children();$(d).each(function(){switch(this.nodeName){case jet.AppConstants.JFGROUP:b.parseGroup(b,this,f,e);break;case jet.AppConstants.OBJECTLIST:b.parseObjectList(b,this,f,e);break;case jet.AppConstants.LAYER:b.parseLayer(b,this,f,e);break;case jet.AppConstants.RECTANGLE:b.parseRectangle(b,this,f,e);break;case jet.AppConstants.LINE:b.parseLine(b,this,f,e);break;case jet.AppConstants.POLYGON:b.parsePolygon(b,this,f,e);break;case jet.AppConstants.ELLIPSE:b.parseEllipse(b,this,f,e);break;case jet.AppConstants.JFIMAGE:b.parseImage(b,this,f,e);break;case jet.AppConstants.JFTEXT:b.parseText(b,this,f,e);break;case jet.AppConstants.REGULAR_LINE:b.parseRegularLine(b,this,f,e);break;case jet.AppConstants.LABEL_LINE:b.parseLabelLine(b,this,f,e);break;case jet.AppConstants.ROUNDED_RECTANGLE:b.parseRoundedRectangle(b,this,f,e);break;case jet.AppConstants.DIAMOND:b.parseDiamond(b,this,f,e);break;case jet.AppConstants.PARALLELOGRAM:b.parseParallelogram(b,this,f,e);break;case jet.AppConstants.TRAPEZOID:b.parseTrapezoid(b,this,f,e);break;case jet.AppConstants.ISOSCELESRECTANGLE:b.parseIsoscelesRectangle(b,this,f,e);break;case jet.AppConstants.ARC:b.parseArc(b,this,f,e);break;case jet.AppConstants.CHORD:b.parseChord(b,this,f,e);break;case jet.AppConstants.PIE:b.parsePie(b,this,f,e);break}})},parseLayer:function(b,a,e,d){this.layerIndex--;if(this.getLayerVisibility(a)){b.parseObjectList(b,a,e,d)}},parseRectangle:function(b,a,f,e){var d={};d.ID=jet.AppConstants.RECTANGLE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseGroup:function(d,b,h,f){var e={};e.ID=jet.AppConstants.JFGROUP;e.GroupID=d.getObjectId(b);e.Points=d.getBoundingPoints(b);e.ObjectId=f;d.getGStyle(d,b,e);this.mediator.post(e,h);var a=$(b).children("ObjectList");this.parseObjectList(d,a,h,e.GroupID)},parseRoundedRectangle:function(b,a,f,e){var d={};d.ID=jet.AppConstants.ROUNDED_RECTANGLE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseText:function(b,a,f,e){var d={};d.ID=jet.AppConstants.JFTEXT;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getTextData(a,d);b.getGStyle(b,a,d);b.getFontFormat(a,d);this.mediator.post(d,f)},parseImage:function(b,a,f,e){var d={};d.ID=jet.AppConstants.JFIMAGE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getImageData(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseEllipse:function(b,a,f,e){var d={};d.ID=jet.AppConstants.ELLIPSE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseArc:function(b,a,f,e){var d={};d.ID=jet.AppConstants.ARC;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getGStyle(b,a,d);this.mediator.post(d,f)},parseChord:function(b,a,f,e){var d={};d.ID=jet.AppConstants.CHORD;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getGStyle(b,a,d);this.mediator.post(d,f)},parsePie:function(b,a,f,e){var d={};d.ID=jet.AppConstants.PIE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getGStyle(b,a,d);this.mediator.post(d,f)},parseLine:function(b,a,f,e){var d={};d.ID=jet.AppConstants.LINE;d.Points=b.getPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseRegularLine:function(b,a,f,e){var d={};d.ID=jet.AppConstants.REGULAR_LINE;d.Points=b.getRegularPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseLabelLine:function(b,a,f,e){var d={};d.ID=jet.AppConstants.LABEL_LINE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parsePolygon:function(b,a,f,e){var d={};d.ID=jet.AppConstants.POLYGON;d.Points=b.getPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},getLayerVisibility:function(a){var b=1;if($(a).children("Visible")!=null){b=$(a).children("Visible:first").text()}return b=="1"?true:false},getPoints:function(b){var e=[];var d=0;var f=0;if($(b).children("NodeList")!=null){var a=$(b).children("NodeList");a.children("PolyNode").each(function(){d=$(this).children("xOffset:first").text();f=$(this).children("yOffset:first").text();e.push({x:d,y:f})});return e}return null},parseParallelogram:function(b,a,f,e){var d={};d.ID=jet.AppConstants.PARALLELOGRAM;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseTrapezoid:function(b,a,f,e){var d={};d.ID=jet.AppConstants.TRAPEZOID;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseIsoscelesRectangle:function(b,a,f,e){var d={};d.ID=jet.AppConstants.ISOSCELESRECTANGLE;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},parseDiamond:function(b,a,f,e){var d={};d.ID=jet.AppConstants.DIAMOND;d.Points=b.getBoundingPoints(a);d.ObjectId=e;b.getAnchorPoints(a,d);b.getGStyle(b,a,d);this.mediator.post(d,f)},getRegularPoints:function(b){var e=[];var d=0;var f=0;if($(b).children("NodeList")!=null){var a=$(b).children("NodeList");a.children("RegularNode").each(function(){d=$(this).children("xOffset:first").text();f=$(this).children("yOffset:first").text();e.push({x:d,y:f})});return e}return null},getObjectId:function(b){var a=null;if($(b).children("objectId")!=null){a=$(b).children("objectId:first").text()}return a},getBoundingPoints:function(b){var e=[];var d=0;var f=0;if($(b).children("NodeList")!=null){var a=$(b).children("NodeList");a.children("Node").each(function(){d=$(this).children("xOffset:first").text();f=$(this).children("yOffset:first").text();e.push({x:d,y:f})});return e}return null},getAnchorPoints:function(b,d){var a=[];if($(b).children("leftTopX:first")!=null){d.leftTopX=$(b).children("leftTopX:first").text()}if($(b).children("leftTopY:first")!=null){d.leftTopY=$(b).children("leftTopY:first").text()}if($(b).children("rightTopX:first")!=null){d.rightTopX=$(b).children("rightTopX:first").text()}if($(b).children("rightTopY:first")!=null){d.rightTopY=$(b).children("rightTopY:first").text()}if($(b).children("leftBottomX:first")!=null){d.leftBottomX=$(b).children("leftBottomX:first").text()}if($(b).children("leftBottomY:first")!=null){d.leftBottomY=$(b).children("leftBottomY:first").text()}if($(b).children("rightBottomX:first")!=null){d.rightBottomX=$(b).children("rightBottomX:first").text()}if($(b).children("rightBottomY:first")!=null){d.rightBottomY=$(b).children("rightBottomY:first").text()}this.normalizeAnchorPoints(d)},normalizeAnchorPoints:function(a){var l=parseInt(a.leftTopX);var h=parseInt(a.rightTopX);if(h<l){var k=l;l=h;h=k;a.leftTopX=l;a.rightTopX=h}var d=parseInt(a.leftBottomX);var i=parseInt(a.rightBottomX);if(i<d){var k=d;d=i;i=k;a.leftBottomX=d;a.rightBottomX=i}var j=parseInt(a.leftTopY);var b=parseInt(a.leftBottomY);if(b<j){var k=j;j=b;b=k;a.leftTopY=j;a.leftBottomY=b}var e=parseInt(a.rightTopY);var f=parseInt(a.rightBottomY);if(f<e){var k=e;e=f;f=k;a.rightTopY=e;a.rightBottomY=f}},getGStyle:function(b,a,d){b.getLineFormat(a,d);b.getFillFormat(a,d);b.getSettings(a,d);b.getPropertyList(a,d);b.getArrowFormat(a,d)},getLineFormat:function(a,d){var b=$(a).children("LineFormat");if(b!=null){d.LineWidth=b.children("lineWidth:first").text();d.LineColor=b.children("lineColor:first").text()}},getArrowFormat:function(a,d){var b=$(a).children("Arrow");if(b!=null){d.StartArrowType=b.children("startArrowType:first").text();d.EndArrowType=b.children("endArrowType:first").text()}},getFillFormat:function(a,b){var d=$(a).children("FillFormat");if(d!=null){b.FillStyle=d.children("fillStyle:first").text();b.FillColor=d.children("fillColor").text();b.FillColor2=d.children("fillColor2:first").text()}},getFontFormat:function(b,d){var a=$(b).children("FontFormat");if(a!=null){d.FontSize=a.children("fontSize:first").text();d.FontStyle=a.children("fontStyle:first").text();d.FontColor=a.children("fontColor:first").text()}},getImageData:function(a,d){var b=$(a).children("imageData");if(b!=null){d.imageData=b.text()}},getTextData:function(b,d){var a=$(b).children("Label");if(a!=null){d.text=a.children("text:first").text()}},getPropertyListx:function(d,f){var e;var a;var h;var b;e=$(d).children("PropertyList:first");if(e!=null){a=e.children("Property:first")}if(a!=null){h=a.children("value:first");b=a.children("comment:first");f.event=h.text();f.action=b.text()}},getPropertyList:function(d,f){var e;var a;var h;var b;e=$(d).children("PropertyList:first");if(e!=null){propertyElements=e.children("Property");propertyElements.each(function(){var k=$(this).children("value:first");var i=$(this).children("comment:first");var j=$(k).text();switch(j){case jet.AppConstants.CLICK:f.event=j;f.action=i.text();break;case jet.AppConstants.JUMP_TO_PAGE:f.event=j;f.action=i.text();break;case jet.AppConstants.OPEN_URL:f.event=j;f.action=i.text();break;case jet.AppConstants.ADD_OVERLAY:f.event=j;f.action=i.text();break;case jet.AppConstants.SHOW_NODE:f.event=j;f.action=i.text();break;case jet.AppConstants.MOUSE_OVER:f.mouseoverevent=j;f.mouseoveraction=i.text();break;case jet.AppConstants.SET_VALUE:f.setvalueevent=j;f.setvalueaction=i.text();break;case jet.AppConstants.APPEND_VALUE:f.setvalueevent=j;f.setvalueaction=i.text();break}})}},getSettings:function(a,b){b.Transparency=$(a).children("transparency:first").text();b.Invisible=$(a).children("invisible:first").text();b.DisableMotion=$(a).children("disableMotion:first").text();b.DisableModifyingProperties=$(a).children("disableModifyingProperties:first").text();b.LayerIndex=this.layerIndex}},{NAME:"JFXMLProxy"});puremvc.define({name:"jet.model.proxy.LXMLProxy",parent:puremvc.Proxy},{getUID:function(a){var b=$(a).attr("node");return b},getPageType:function(e,d){var f;var h=e.findComboBoxElement(d);f=$(h).text();var a=e.getTypeIndex(h,f);var b=$(h).attr("pageTypes");if(b==undefined||b==null){return"none"}return b.split(";")[a]},getPageTypeIndex:function(d,a){var b;$(d).find("input").each(function(){if(b!=null){return}var h=$(this).attr(a);if(h=="JetOptionComboBox"||h=="JetCustomOptionComboBox"){value=$(this).text();var f=$(this).attr("values");var e=f.split(";");for(b=0;b<e.length;b++){if(e[b]==value){return b}}return -1}});return b},findComboBoxElement:function(a){var b=null;$(a).find("input").each(function(){if(b!=null){return}var d=$(this).attr("type");if(d=="JetOptionComboBox"||d=="JetCustomOptionComboBox"){b=this}});return b},getTypeIndex:function(f,d){var e;var b=$(f).attr("values");if(b==undefined){return}var a=b.split(";");for(e=0;e<a.length;e++){if(a[e]==d){return e}}return e},parseSettings:function(b,a){var d={};if(b==null||b==undefined){return d}$(b).find("input").each(function(){var e=$(this).attr("name");var f=$(this).text();d[e]=f});return d},parseInteractionElement:function(b,a){var d="";if(b==null||b==undefined){return d}d=$(b).attr("projectName");return d},parseOptionStore:function(e,d,a){var b=[];$(e).find("option").each(function(){var f=$(this).attr("type");if(f=="-1"){$(this).find("rule").each(function(){var j=$(this).attr("type");var k=$(this).attr("value");var i={};i[j]=k;b.push(i)})}if(f==d){var h=a;$(this).find("rule").each(function(){var k=$(this).attr("type");var l=$(this).attr("value");var i={};i[k]=l;var j=h.getProperty(b,k);if(j!=null){j[k]=l}else{b.push(i)}})}});return b},getProperties:function(e,h,a){var b=$(e).parents("interaction");var j=$(e).parents("optionPage");var i=$(b).find('optionStore[name="'+h+'"]');var d=a.getPageTypeIndex(j,"type");var f=a.parseOptionStore(i,d,a);return f},parseComponentLevelBranchData:function(b){var a=null;if($(b).siblings("checkedOption")!=null&&$(b).siblings("checkedOption").length>0){a=new Object();a.checkedOption=$(b).siblings("checkedOption").text();a.checkedValue=$(b).siblings("checkedValue").text();a.showFeedback=$(b).siblings("showFeedback").text();a.feedback=$(b).siblings("feedback").text();a.branchOptions=$(b).siblings("branchOptions").text();a.branchDelay=$(b).siblings("branchDelay").text()}return a},parseImageData:function(a){var b=null;if($(a).attr("imageHeight")!=null){b=new Object();b.imageHeight=$(a).attr("imageHeight");b.imageWidth=$(a).attr("imageWidth")}return b},parseAudioData:function(a){var b=null;if($(a).attr("enableAutoPlay")!=null){b=new Object();b.enableAutoPlay=$(a).attr("enableAutoPlay");b.enableController=$(a).attr("enableController");b.volume=$(a).attr("volume");b.fallback=$(a).attr("fallback")}return b},parseCaptionData:function(b){var a=null;if($(b).siblings("imageCaption")!=null){a=new Object();a.imageCaption=$(b).siblings("imageCaption").text();a.imageSource=$(b).siblings("imageSource").text();a.mediaController=$(b).siblings("mediaController").text();a.showMiniNav=$(b).siblings("showMiniNav").text();a.enableMiniNav=$(b).siblings("enableMiniNav").text()}return a},parseData:function(e,f){getProperties=this.getProperties;getProperty=this.getProperty;var a=this.parseComponentLevelBranchData;var n=this.parsePageLevelBranchData;var m=this.parseCaptionData;var h=this.parseAudioData;var d=this.parseImageData;var i=null;var l=null;var b=null;var k=this;var j=null;$(e).find("input").each(function(){var q=$(this).attr("type");var p=$(this).attr("optionStore");i=getProperties(this,p,k);l=getProperty(i,"visibility");b=getProperty(i,"player_visibility");if((b!=null&&b.player_visibility=="0")||(b==null&&(l==null||l.visibility=="0"))){return}var s=a(this);switch(q){case"JetOptionHTMLEditor":f.buildComponent(f,jet.AppConstants.TEXT,i,$(this).text(),s);break;case"JetOptionAdvancedHTMLEditor":f.buildComponent(f,jet.AppConstants.TEXT,i,$(this).text(),s);break;case"JetOptionTextArea":f.buildComponent(f,jet.AppConstants.TEXT,i,$(this).text(),s);break;case"JetOptionCheckBox":f.buildComponent(f,jet.AppConstants.CHECKBOX,i,$(this).text(),s);break;case"JetOptionImageArea":var r=d(this);var o=m(this);f.buildComponent(f,jet.AppConstants.IMAGE,i,$(this).text(),o,r);break;case"JetOptionVideoArea":f.buildComponent(f,jet.AppConstants.VIDEO,i,$(this).text(),o,r);break;case"JetOptionResourceImportButton":f.buildComponent(f,jet.AppConstants.RESOURCE,i,$(this).text(),o,r);break;case"JetOptionAudio":var u=h(this);f.buildComponent(f,jet.AppConstants.AUDIO,i,$(this).text(),u);break;case"JetOptionNodesManagerButton":var t=s;f.buildComponent(f,jet.AppConstants.NODES_MANAGER,i,$(this).text(),t);break;case"JetOptionCrossword":f.buildComponent(f,jet.AppConstants.CROSSWORD,i,$(this).text(),s);break;case"JetOptionDataInput":f.buildComponent(f,jet.AppConstants.DATA_INPUT,i,$(this).text(),s);break;case"JetComboBox":f.buildComponent(f,jet.AppConstants.COMBO_BOX,i,$(this).text(),s);break}});f.processComponents()},getProperty:function(d,b){var e=null;for(var a=d.length-1;a>-1;a--){if(e!=null){break}var f=d[a];if(!f.hasOwnProperty(b)){continue}else{e=d[a];break}}return e}},{NAME:"LXMLProxy"});puremvc.define({name:"jet.view.navigation.HeaderComponent",constructor:function(a){this.mediator=a;this.headerDiv=document.createElement("div");this.headerDiv.className="header";getJetWrapper().append(this.headerDiv);this.adaButton=document.createElement("a");this.adaButton.className="ada";$(this.adaButton).hide();$(this.headerDiv).append(this.adaButton);$(this.adaButton).html("<a href='sec508.htm'><img width='30' height='30' alt='Click here for Accessible Version' src='lib/css/accessibility.png' /></a>");this.printButton=document.createElement("a");this.printButton.className="print";$(this.printButton).hide();$(this.headerDiv).append(this.printButton);$(this.printButton).html("<a href='print.htm'><img width='30' height='30' src='lib/css/print.png' /></a>");this.notesButton=document.createElement("a");this.notesButton.className="print";$(this.notesButton).hide();$(this.notesButton).click(function(){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NOTES)});$(this.headerDiv).append(this.notesButton);$(this.notesButton).html("<img width='30' height='30' src='lib/css/notes.png' />");this.ePubButton=document.createElement("a");this.ePubButton.className="ePub";$(this.ePubButton).hide();$(this.headerDiv).append(this.ePubButton);this.mapButton=document.createElement("button");this.mapButton.className="mapButton";$(this.mapButton).text("Show Map");$(this.mapButton).hide();$(this.headerDiv).append(this.mapButton);this.showLocationButton=document.createElement("button");this.showLocationButton.className="showLocationButton";$(this.showLocationButton).text("My Location");$(this.showLocationButton).hide();$(this.headerDiv).append(this.showLocationButton);this.addControls()}},{headerDiv:null,selectDiv:null,adaButton:null,mapButton:null,showLocationButton:null,printButton:null,ePubButton:null,menuButton:null,isMenuOpen:true,handleEvent:function(a){},addControls:function(){var a=this.mediator},getContrastYIQ:function(h){h=h.substring(1);var e=parseInt(h.substr(0,2),16);var d=parseInt(h.substr(2,2),16);var a=parseInt(h.substr(4,2),16);var f=((e*299)+(d*587)+(a*114))/1000;return(f>=128)?"black":"white"},getProjectName:function(){var a=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).getProjectName();return a},handleProjectName:function(){$(this.ePubButton).html("<a href='"+this.getProjectName()+".epub'><img width='30' height='30' src='lib/css/epub.png' /></a>")},getOuterBackgroundColor:function(a){var b=this;$.ajax({type:"GET",url:"./theme/default.xml",dataType:"xml",success:function(d){$(d).find("outerBgColor").each(function(){var e=$(this).text();$(a).css("color",b.getContrastYIQ(e))})},error:function(){}})},addDivIfSupported:function(a,d){var b=this;$.ajax({type:"GET",url:"./layout/default.xml",dataType:"xml",success:function(e){$(e).find("supportsTabs").each(function(){var f=$(this).text();$(a).prependTo(f);b.addNav3Tabs(d)})},error:function(){return false}})},updateMenu:function(a){$("nav#menu ul li").removeClass("mm-selected");$("nav#menu ul li a").filter("[href='"+a+"']").parent().addClass("mm-selected");$("nav#menu a").filter("[href='"+a+"']").parent().addClass("mm-selected")},addMenu_1:function(l){if(l.length<1){return}var a=document.createElement("nav");$(a).addClass("mm-menu mm-horizontal");$(a).attr("id","menu");getJetWrapper().append(a);var b=this.mediator;var r;r="<a style='cursor: pointer;z-index:10;color:black;position:absolute;left:150px;top:0px' id='navMenuButton'>&#9664;</a><ul>";for(var f=0;f<l.length;f++){var n=l[f].parentUid;var o="";try{if(n!=""){o=n.match(/.*\(ID:(.*)\)/)[1].trim()}}catch(q){}if(o==""||o==undefined||o==l[f].uid){var p="<li><a href = '"+l[f].uid+"'>"+l[f].title+"</a></li>";r+=p}}r+="</ul>";$("nav#menu").html(r);var d=false;while(!d){d=true;for(var e=0;e<l.length;e++){var m=l[e].uid;var k=$('nav#menu a[href="'+m+'"]')[0];if(k!=undefined){continue}var n=l[e].parentUid;var o="";try{if(n!=""){o=n.match(/.*\(ID:(.*)\)/)[1].trim()}var h=$('nav#menu a[href="'+o+'"]')[0]}catch(q){}if(h!=null&&h!=undefined){d=false;var p="<li class='subtopic'><a href = '"+l[e].uid+"'>"+l[e].title+"</a></li>";$(h).parent().append(p)}}}this.getOuterBackgroundColor("nav#menu ul");this.getOuterBackgroundColor("nav#menu ul li.subtopic a");this.getOuterBackgroundColor("#navMenuButton");this.addMenuButton();$("nav#menu ul").click(function(t){t.preventDefault();var i=t.target.href;var j=i.lastIndexOf("/")>0?i.lastIndexOf("/")+1:0;i=i.substring(j);var s=i.match(/\d+/);b.requestNode(s)});$("nav#menu").mmenu({classes:"mm-slide",close:true,preventDefault:true,blockUI:true,offCanvas:false});$("nav#menu").hide()},addMenuButton:function(){this.menuButton=document.createElement("a");this.menuButton.className="menu";$(this.headerDiv).append(this.menuButton);$(this.menuButton).html("<a style='cursor: pointer;'><img width='30' height='30' src='lib/css/menu.png'/></a>");this.isMenuOpen=false;var a=this;$(this.menuButton,"#navMenuButton").click(function(){a.menuButtonClickHandler(a)});$("#navMenuButton").click(function(){a.menuButtonClickHandler(a)})},menuButtonClickHandler:function(a){var b=a.isMenuOpen?"-210px":"-10px";$("nav#menu,nav#nav_2").show();$("nav").animate({left:b},250,function(){if(parseInt($("nav#menu").css("left"))<-100){$("nav#menu,nav#nav_2").hide()}});a.isMenuOpen=!a.isMenuOpen},addTOC:function(d){if(d.length<1){return}var e=this.mediator;var f;f="<select>";for(var b=0;b<d.length;b++){var a="<option value = '"+d[b].uid+"'>"+d[b].title+"</option>";f+=a}f+="</select>";this.selectDiv=document.createElement("selection");this.selectDiv.className="TOC";$(this.selectDiv).html(f);$(this.selectDiv).change(function(){var h=$(this).find(":selected").val();e.requestNode(h)});$(this.headerDiv).append(this.selectDiv)},addMenu_2:function(l){if(l.length<1){return}var a=document.createElement("nav");$(a).addClass("mm-menu mm-horizontal");$(a).attr("id","nav_2");getJetWrapper().append(a);var b=this.mediator;var r="<a style='cursor: pointer;z-index:10;color:black;position:absolute;left:130px;top:0px' id='navMenuButton'>&#9664;</a>";r+="<ul id='menu_2'>";for(var f=0;f<l.length;f++){var q="<li><a href = '"+l[f].uid+"'>"+l[f].title+"</a></li>";r+=q}r+="</ul>";$("nav#nav_2").html(r);var d=false;while(!d){d=true;for(var e=0;e<l.length;e++){var n=l[e].uid;var k=$('nav#nav_2 a[href="'+n+'"]')[0];if(k!=undefined){continue}var m=l[e].parentUid;var o="";try{if(m!=""){o=m.match(/.*\(ID:(.*)\)/)[1].trim()}var h=$('nav#nav_2 a[href="'+o+'"]')[0]}catch(p){}if(h!=null&&h!=undefined){d=false;var q="<li class='subtopic'><a href = '"+l[e].uid+"'>"+l[e].title+"</a></li>";$(h).parent().append(q)}}}this.getOuterBackgroundColor("#nav_2 ul li a");this.getOuterBackgroundColor("#navMenuButton");this.addMenuButton();$("nav#nav_2").hide();$("ul#menu_2 li a").click(function(t){t.preventDefault();var i=t.target.href;var j=i.lastIndexOf("/")>0?i.lastIndexOf("/")+1:0;i=i.substring(j);var s=i.match(/\d+/);b.requestNode(s)})},addMenu_3:function(a){$("#nav_3").remove();if(a.length<1){return}var b=document.createElement("nav");$(b).attr("id","nav_3");$(b).css("height","auto");this.addDivIfSupported(b,a)},addNav3Tabs:function(d){var e=this.mediator;htmlString="<ul>";for(var b=0;b<d.length;b++){var a="<li><a href = '"+d[b].uid+"'>"+d[b].title+"</a></li>";htmlString+=a}htmlString+="</ul>";$("#nav_3").html(htmlString);this.getOuterBackgroundColor("#nav_3 ul li a");$("#nav_3").tabs({active:false,collapsible:false,select:function(j,k){var f=j.currentTarget.href;var h=f.lastIndexOf("/")>0?f.lastIndexOf("/")+1:0;f=f.substring(h);var i=f.match(/\d+/);e.requestNode(i)}});$(".ui-widget-header").css("background-color","transparent");$(".ui-widget-header").css("border","none");$("#nav_3").css("width","100%")},addResourceTabs_1:function(d){$("#tabs").remove();if(d.length<1){return}var h=document.createElement("div");$(h).attr("id","tabs");getJetWrapper().append(h);var e=this.mediator;var f;f="<ul id='resources'>";for(var b=0;b<d.length;b++){var a="<li><a href = '"+d[b].uid+"'>"+d[b].title+"</a></li>";f+=a}f+="</ul>";$(h).html(f);this.getOuterBackgroundColor("#tabs ul li a");$("#tabs").tabs({active:-1,collapsible:true,select:function(i,j){i.preventDefault();var k=i.currentTarget;var l=$(k).attr("href");if(l.length>1){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE_RESOURCE,l)}}})},addTitle:function(a){$(".header").prepend("<span id='headerTitle'>"+a+"</span>")},displayADA:function(a){switch(a){case"0":$(this.adaButton).show();break;case"1":$(this.adaButton).hide();break;default:$(this.adaButton).hide()}},displayMap:function(a){switch(a){case"0":$(this.mapButton).show();$(this.showLocationButton).show();break;case"1":$(this.mapButton).hide();$(this.showLocationButton).hide();break;default:$(this.mapButton).hide();$(this.showLocationButton).hide()}},displayPrint:function(a){switch(a){case"0":$(this.printButton).show();break;case"1":$(this.printButton).hide();break;default:$(this.printButton).hide()}},displayNotes:function(a){switch(a){case"0":$(this.notesButton).show();break;case"1":$(this.notesButton).hide();break;default:$(this.notesButton).show()}},displayEpub:function(a){switch(a){case"0":$(this.ePubButton).show();break;case"1":$(this.ePubButton).hide();break;default:$(this.ePubButton).hide()}},},{});puremvc.define({name:"jet.view.navigation.NavigationComponent",constructor:function(a){this.mediator=a;this.navDiv=document.createElement("div");this.navDiv.className="navigator";getJetWrapper().append(this.navDiv);this.addControls();this.addFeedback();this.addProgressBar()}},{navDiv:null,feedbackDiv:null,mediator:null,previousButton:null,previousButtonG:null,nextButton:null,nextButtonG:null,checkButton:null,progressBar:null,DISABLED:0,ENABLED:1,HOVER:3,DOWN:4,handleEvent:function(a){switch(a.type){case"keyup":if(this.checkbox.checked){this.dispatchTextChangedEvent()}break;case"click":a.preventDefault();this.dispatchTextChangedEvent();break}},addControls:function(){var b=this.mediator;var a=document.createElement("aside");a.className="controls";$(a).attr("role","navigation");$(a).attr("aria-label","main navigation");this.previousButton=document.createElement("button");this.nextButton=document.createElement("button");$(this.previousButton).attr("alt","Back button");$(this.nextButton).attr("alt","Next button");$(this.navDiv).append(a);$(a).append(this.nextButton);$(a).append(this.previousButton);this.previousButton.className="left";this.nextButton.className="right";this.disablePrevious();this.enableNext()},addControlsX:function(){var e=this.mediator;var b=document.createElement("aside");b.className="controls";this.previousButton=document.createElement("div");this.nextButton=document.createElement("div");$(this.navDiv).append(b);$(b).append(this.nextButton);$(b).append(this.previousButton);this.previousButton.className="left";this.nextButton.className="right";var a=document.createElement("canvas");$(a).css("top","0px");$(a).css("left","0px");a.width=40;a.height=40;$(this.nextButton).append(a);this.nextButtonG=a.getContext("2d");this.drawNextButton("#cccccc");var d=document.createElement("canvas");$(d).css("top","0px");$(d).css("left","0px");d.width=40;d.height=40;$(this.previousButton).append(d);this.previousButtonG=d.getContext("2d");this.drawPreviousButton("#cccccc");this.disablePrevious();this.enableNext()},addProgressBar:function(){var a=this.mediator;progressBar=document.createElement("progress");progressBar.className="progressBar";$(this.navDiv).append(progressBar)},updateProgressBar:function(b,a){if(isNaN(b)||isNaN(a)){return}if(progressBar){progressBar.value=b;progressBar.max=a}},addFeedback:function(){var a=this.mediator;this.feedbackDiv=document.createElement("div");this.feedbackDiv.className="feedback";$(this.navDiv).append(this.feedbackDiv);this.checkButton=document.createElement("input");this.checkButton.type="button";this.checkButton.value="Check";this.checkButton.className="checkButton";$(this.feedbackDiv).append(this.checkButton)},showFeedback:function(){$(this.feedbackDiv).show()},showFeedbackMessage:function(a){this.checkButton.value=a},hideFeedback:function(){$(this.feedbackDiv).hide()},showCheckAnswer:function(){var a=this.mediator;this.showFeedback();this.checkButton.value="Submit";$(this.checkButton).unbind("click");$(this.checkButton).bind("click",function(){a.processQuestion(a)});$(this.checkButton).removeAttr("disabled")},hideCheckAnswer:function(){this.hideFeedback();$(this.checkButton).unbind("click")},disablePrevious:function(){var a=this.previousButton;$(a).unbind("click");$(a).unbind("dblclick");$(a).unbind("hover");$(a).unbind("mouseout");$(a).unbind("mousedown");this.updatePreviousButton(this.DISABLED)},disableNext:function(){var a=this.nextButton;$(a).unbind("click");$(a).unbind("dblclick");$(a).unbind("hover");$(a).unbind("mouseout");$(a).unbind("mousedown");this.updateNextButton(this.DISABLED)},enablePrevious:function(){this.disablePrevious();var b=this;var a=this.mediator;$(this.previousButton).css("cursor","pointer");b.updatePreviousButton(b.ENABLED);$(this.previousButton).bind("click",function(){a.moveBackward()});$(this.previousButton).bind("hover",function(){b.updatePreviousButton(b.HOVER)});$(this.previousButton).bind("mouseleave",function(){b.updatePreviousButton(b.ENABLED)});$(this.previousButton).bind("mousedown",function(){b.updatePreviousButton(b.DOWN)})},enableNext:function(){this.disableNext();var b=this;var a=this.mediator;$(this.nextButton).css("cursor","pointer");b.updateNextButton(this.ENABLED);$(this.nextButton).bind("click",function(){a.moveForward()});$(this.nextButton).bind("hover",function(){b.updateNextButton(b.HOVER)});$(this.nextButton).bind("mousedown",function(){b.updateNextButton(b.DOWN)});$(this.nextButton).bind("mouseleave",function(){b.updateNextButton(b.ENABLED)})},disableCheckButton:function(){$(this.checkButton).attr("disabled","disabled")},drawNextButton:function(e){var b=[];b.push({x:17,y:6});b.push({x:30,y:19});b.push({x:17,y:33});b.push({x:11,y:28});b.push({x:20,y:19});b.push({x:11,y:11});b.push({x:17,y:6});var d=this.nextButtonG;this.drawOuterBox(d);this.drawInnerBox(d);d.strokeStyle="#FFFFFF";d.lineWidth=1;d.fillStyle=e;d.beginPath();d.moveTo(b[0]["x"],b[0]["y"]);for(var a=1;a<b.length;a++){d.lineTo(b[a]["x"],b[a]["y"])}d.closePath();d.stroke();d.fill()},drawProgressBar:function(b){var a=this.progressBarG;a.strokeStyle="#FFFFFF";a.lineWidth=1;a.fillStyle=b;a.fillRect(0,0,900,0);a.beginPath();a.closePath();a.stroke();a.fill()},updateNextButton:function(a){switch(a){case this.DISABLED:$(".navigator .controls .right").attr("disabled","disabled");break;case this.ENABLED:$(".navigator .controls .right").removeAttr("disabled","disabled");break;case this.HOVER:break;case this.DOWN:break}},updateNextButtonX:function(b){var a=this.nextButtonG;a.fillStyle=b;a.fill()},drawPreviousButton:function(e){var b=[];b.push({x:21,y:6});b.push({x:27,y:11});b.push({x:18,y:19});b.push({x:27,y:28});b.push({x:21,y:33});b.push({x:8,y:19});b.push({x:21,y:6});var d=this.previousButtonG;this.drawOuterBox(d);this.drawInnerBox(d);d.strokeStyle="#FFFFFF";d.lineWidth=1;d.fillStyle=e;d.beginPath();d.moveTo(b[0]["x"],b[0]["y"]);for(var a=1;a<b.length;a++){d.lineTo(b[a]["x"],b[a]["y"])}d.closePath();d.stroke();d.fill()},updatePreviousButton:function(a){switch(a){case this.DISABLED:$(".navigator .controls .left").attr("disabled","disabled");break;case this.ENABLED:$(".navigator .controls .left").removeAttr("disabled","disabled");break;case this.HOVER:break;case this.DOWN:break}},updatePreviousButtonX:function(b){var a=this.previousButtonG;a.fillStyle=b;a.fill()},drawOuterBox:function(a){a.rect(1,1,38,38);a.strokeStyle="#a7a7a7";a.lineWidth=2;a.stroke()},drawInnerBox:function(b){b.rect(3,3,33,33);var a=b.createLinearGradient(3,3,33,33);a.addColorStop(0,"#e7e7e7");a.addColorStop(1,"#111111");b.fillStyle=a;b.strokeStyle="#000000";b.lineWidth=1;b.fill()},displayNAV:function(a){switch(a){case"0":$(".controls").show();break;case"1":$(".controls").hide();break;default:$(".controls").show()}},},{});puremvc.define({name:"jet.controller.command.util.GraphicsUtils",constructor:function(){}},{page:null,calcMagnitude:function(e,d){var b=Math.abs(d.x-e.x);var a=Math.abs(d.y-e.y);var f=Math.sqrt(Math.pow(b,2)+Math.pow(a,2));return f},calcLength:function(b,a){return Math.abs(a-b)},isObjectRotated:function(i){var e=i.Points;if(e.length>=2){var d=e[0];var b=e[1];var h=null;var f=null;h=b.x-d.x;f=b.y-d.y;var j=Math.atan2(f,h);var a=180/Math.PI*j;if(a==0){return false}else{return true}}return false},setRotation:function(u,q,h,i){var n=u.Points;if(n.length>=2){var e=n[0];var d=n[1];var b=n[2];var a=n[3];var j=this.calcMagnitude(e,d);var t=this.calcMagnitude(d,a);var m={x:j,y:t};var p=this.isNormalOrientation(u);if(!p){this.flipVertical(q,n[0],m)}var f=null;var l=null;var s=null;var k=-1;l=d.x-e.x;s=d.y-e.y;f={x:j/2,y:t/2};k=1;var r=Math.atan2(s,l);var o=180/Math.PI*r;this.rotateObject(q,f,k,r,h,i);return o}return 0},isNormalOrientation:function(a){var n=parseInt(a.leftTopX);var m=parseInt(a.leftTopY);var d={x:n,y:m};var j=parseInt(a.rightTopX);var e=parseInt(a.rightTopY);var f=parseInt(j,e);var k=parseInt(a.rightBottomX);var i=parseInt(a.rightBottomY);var b={x:k,y:i};var h=this.calcCenterPoint(d,b);var l=this.isControlPointWithRange(d,b,f,h);return l},calcCenterPoint:function(e,b){var a=(e.x+b.x)/2;var d=(e.y+b.y)/2;return{x:a,y:d}},isControlPointWithRange:function(r,p,e,t){var k=this.calcMagnitude(t,r);var u=this.calcAngle(t,r);var q=180/Math.PI*u;var s=this.calcAngle(t,p);var o=180/Math.PI*s;var i=this.calcAngle(r,e);var v=0;var a=this.normalizeAngle(u);var x=this.normalizeAngle(s);var l=this.normalizeAngle(i);var d=180/Math.PI*a;var n=180/Math.PI*x;var m=180/Math.PI*l;var h=null;var j=null;if(a>x){var b=Math.PI*2-a;h=Math.abs(b+x)}else{h=Math.abs(x-a)}if(a>l){b=Math.PI*2-a;j=Math.abs(b+l)}else{j=Math.abs(l-a)}var w=180/Math.PI*h;var f=180/Math.PI*j;if(h<j){return false}return true},calcAngle:function(b,a){var d=a.y-b.y;var e=a.x-b.x;var h=Math.atan2(d,e);var f=180/Math.PI*h;return h},normalizeAngle:function(a){if(a<0){a=2*Math.PI-Math.abs(a)}return a},flipVertical:function(d,b,a){d.setTransform(1,0,0,-1,0,0);d.setTransform(1,0,0,1,0,a.y+b.y);d.translate(0,b.y-a.y)},flipHorizontal:function(d,b,a){d.setTransform(-1,0,0,1,0,0);d.setTransform(1,0,0,1,a.x+b.x,0);d.translate(b.x-a.x,0)},rotateObject:function(f,d,a,h,e,b){if(b){f.translate(-1*(d.x-e.x/2),-1*(d.y-e.y/2))}f.translate(1*d.x,1*d.y);f.rotate(a*h);f.translate(-1*d.x,-1*d.y)},calculateCanvasDimensions:function(l,a){var m=10000;var j=10000;var e=-10000;var d=-10000;for(var f=0;f<l.length;f++){var h=parseInt(l[f]["x"]);var k=parseInt(l[f]["y"]);m=h<m?h:m;j=k<j?k:j;e=h>e?h:e;d=k>d?k:d}var b=e-m;var n=d-j;a.x=b;a.y=n;a.top=j;a.left=m;return a},convertFromCharCode:function(e){var f="";if(e!=null){try{for(var b=0;b<=e.length-2;b+=2){var d=e.substring(b,b+2);f+=this.hexToDec(d)}}catch(a){}}return f},hexToDec:function(d){var f=parseInt(this.convertChar(d.substring(0,1)));var b=parseInt(this.convertChar(d.substring(1)));var a=f*16+b;var e=String.fromCharCode(a);return e},convertChar:function(a){var b=a.toUpperCase();switch(b){case"A":return"10";case"B":return"11";case"C":return"12";case"D":return"13";case"E":return"14";case"F":return"15";default:return b}},calcSlope:function(d,b){if(d.x-b.x==0){return jet.AppConstants.LARGE_VALUE}var a=(d.y-b.y)/(d.x-b.x);return a},projectPoint:function(e,d,f){var b={x:null,y:null};var a=e.x+d*(Math.cos(f));var h=e.y+d*(Math.sin(f));b.x=a;b.y=h;return b},calcMidPointFromPoints:function(f,d){var i={};var b=(d.x-f.x)/2;var h=(d.y-f.y)/2;var a=f.x+b;var e=f.y+h;i.x=a;i.y=e;return i},isFlipped:function(B,w,k){var f=k;var D=k;var h=this.calcAngle(B,w);var e=w.y-B.y;var J=w.x-B.x;var q=this.calcMidPointFromPoints(B,w);var r=this.calcMagnitude(D,B);var F=this.calcAngle(D,B);var y=this.calcAngle(q,B);var x=180/Math.PI*F;var C=this.calcAngle(D,w);var H=this.calcAngle(q,w);var v=180/Math.PI*C;var m=this.calcAngle(B,f);var i=this.calcAngle(q,f);var G=0;var a=this.normalizeAngle(F);var E=this.normalizeAngle(y);var K=this.normalizeAngle(C);var z=this.normalizeAngle(H);var s=this.normalizeAngle(m);var A=this.normalizeAngle(i);var d=180/Math.PI*a;var u=180/Math.PI*K;var t=180/Math.PI*s;var p=0;Number;var o=0;var l=0;var n=0;if(E>z){var b=Math.PI*2-E;p=Math.abs(b+z)}else{p=Math.abs(z-E)}if(E>A){b=Math.PI*2-E;o=Math.abs(b+A)}else{o=Math.abs(A-E)}if(a>K){b=Math.PI*2-a;l=Math.abs(b+K)}else{l=Math.abs(K-a)}if(a>s){b=Math.PI*2-a;n=Math.abs(b+s)}else{n=Math.abs(s-a)}var I=180/Math.PI*l;var j=180/Math.PI*n;if(p<o){return true}else{return false}},calculateOffset:function(e){var a=$(e);var i={};var d=0;var h=0;var f=0;var b=0;while($(a).attr("class").indexOf("content")<0){f=parseInt(a.css("left"));if($.isNumeric(f)){d=f+d}b=parseInt(a.css("top"));if($.isNumeric(b)){h=b+h}a=a.parent()}i.x=d;i.y=h;return i}},{NAME:"GraphicsUtils"});puremvc.define({name:"jet.view.component.ViewComponent",constructor:function(){this.div=document.createElement("div");this.contentDiv=document.createElement("div");this.div.className="componentX";this.contentDiv.className="text"}},{page:null,div:null,contentDiv:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(a).append(this.contentDiv)},setParentAndPosition:function(b,d,a){this.page=d;switch(a){case"prepend":$(b).prepend(this.div);$(b).prepend(this.contentDiv);break;default:$(b).append(this.div);$(b).append(this.contentDiv)}},removeFromParent:function(){$(this.div).remove();$(this.contentDiv).remove()},initialize:function(){},setPositioning:function(a){switch(a){case"static":$(this.div).removeAttr("style");$(this.contentDiv).removeAttr("style");$(this.div).css("position","static");$(this.contentDiv).css("position","static");break;case"absolute":$(this.div).removeAttr("style");$(this.contentDiv).removeAttr("style");$(this.div).css("position","absolute");$(this.contentDiv).css("position","absolute");break}},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},removeClass:function(a){$(this.div).removeClass(a)},setContentClass:function(a){$(this.contentDiv).attr("class",a)},addContentClass:function(a){$(this.contentDiv).addClass(a)},removeContentClass:function(a){$(this.contentDiv).removeClass(a)},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",0);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},getText:function(){return $(this.contentDiv).text()},getHTML:function(){return $(this.contentDiv).html()},getDiv:function(){return this.div},getContentDiv:function(){return this.contentDiv},setBackgroundColor:function(a){},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},setComponentLevelBranchOptions:function(a){this.branchOptions=a},getComponentLevelBranchOptions:function(){return this.branchOptions},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},handleEvent:function(a){switch(a.type){case"keyup":if(this.checkbox.checked){this.dispatchTextChangedEvent()}break;case"click":a.preventDefault();this.dispatchTextChangedEvent();break}},getUserInput:function(){},makeDraggable:function(){},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).unbind("mousedown");$(this.contentDiv).unbind("mouseout");$(this.contentDiv).attr("disabled","disabled")},enable:function(){}},{TEXT_CHANGED:"textChanged"});puremvc.define({name:"jet.view.component.ARComponent",constructor:function(){var a=this;this.gParams.myNodesInterval=setInterval(this.checkForNodes.bind(a),1000)}},{gParams:{nodesMessage:{nodes:null},myNodesInterval:null,geoLocations:[],geoLock:false,currentUID:"",bestChoiceUID:"",bestChoiceTitle:"",geoLocationDebug:false,geoLocationReportDiv:null,precision:25,geoLocationInterval:5000,errorMessageDelivered:false},intervalIndex:0,createReportDiv:function(){var a=document.createElement("div");this.gParams.geoLocationReportDiv=a;$(a).css("opacity",".5");$(a).css("backgroundColor","#000000");$(a).css("color","#FFFFFF");$(a).width("100%");$(a).height("5%");$(a).css("position","fixed");$(a).css("top","95%");$("body").append(this.gParams.geoLocationReportDiv)},checkForNodes:function(){console.log("ARMaker checking for nodes...");jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODES,this.gParams.nodesMessage);if(this.gParams.nodesMessage&&this.gParams.nodesMessage.nodes!=null){clearInterval(this.gParams.myNodesInterval);this.createLocations(this.gParams.nodesMessage.nodes);this.printLocations(this.gParams.geoLocations);this.createReportDiv();this.startLocationFinder()}},createAudio:function(){var a=document.createElement("audio");$(a).attr("src","base/audio/tone.mp3");this.gParams.audio=a;this.gParams.audio.play()},createGeoLocation:function(d,i,e,b,h,f){var a={};a.uid=d;a.latitude=i;a.longitude=e;a.latitudeProximity=b;a.longitudeProximity=h;a.title=f;return a},createLocations:function(b){var n=null;var h=null;var m=null;for(var j=0;j<b.length;j++){var d=b[j];var k=d.uid;var e=d.node;if(e&&e.getLatitude&&e.getLongitude){var l=this.normalizeCoordinate(e.getLatitude());var a=this.normalizeCoordinate(e.getLongitude());if(e.getLatitudeProximity){n=this.normalizeProximity(e.getLatitudeProximity(),true)}if(e.getLongitudeProximity){h=this.normalizeProximity(e.getLongitudeProximity(),false)}if(e.getTitle){m=e.getTitle()}var f=this.createGeoLocation(k,l,a,n,h,m);this.insertLocation(f)}}},normalizeCoordinate:function(b){if(b!=null&&b!=undefined){var a=b.split(" ");if(a.length>0){b=this.convertTokens(a)}return b}return 0},normalizeProximity:function(d,b){var e=b?60.76:80;if(isNaN(d)){d=e}else{d=Number(d)}var a=(d/e)/3600;return a},convertTokens:function(b){var f=0;var e=0;var a=0;var d=0;if(b.length>0){e=Number(b[0])}if(b.length>1){a=Number(b[1])}if(b.length>2){d=Number(b[2])}f=e+((a*60)+d)/3600;return f},insertLocation:function(a){var d=0;var b=parseFloat(a.latitude);if(this.gParams.geoLocations.length==0){this.gParams.geoLocations.push(a);return}while(d<this.gParams.geoLocations.length){var e=parseFloat(this.gParams.geoLocations[d].latitude);if(b<e){this.gParams.geoLocations.splice(d,0,a);return}d++}this.gParams.geoLocations.push(a);return},printLocations:function(a){for(var b=0;b<a.length;b++){var d=a[b];console.log(d.uid+"> "+d.latitude+","+d.longitude);console.log(d.latitudeProximity+","+d.longitudeProximity)}},startLocationFinder:function(){var a={enableHighAccuracy:true,timeout:120000,maximumAge:10000};id=navigator.geolocation.watchPosition(this.handleLocation.bind(this),this.handleError.bind(this),a)},onProgress:function(a){console.log(a)},handleLocation:function(b){if(b==null||b==undefined){return}this.displayMessage("Found position with accuracy of "+b.coords.accuracy+" meters");if(b.coords.accuracy<=this.gParams.precision&&!this.gParams.geoLock){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.SET_GEOLOCATION,b);var a=b.coords;this.findPage(a)}},findPage:function(k){this.gParams.bestChoiceUID="";this.gParams.bestChoiceTitle="";bestCandidate=1000000;smallestLatDifference=1000000;smallestLongDifference=1000000;this.gParams.geoLock=true;for(var f=0;f<this.gParams.geoLocations.length;f++){var d=this.gParams.geoLocations[f];var l=d.latitudeProximity;var e=d.longitudeProximity;var h=Math.abs(k.latitude-d.latitude);var j=Math.abs(k.longitude-d.longitude);this.updateDisplay(h,j,smallestLatDifference,smallestLongDifference,d);smallestLatDifference=h<smallestLatDifference?h:smallestLatDifference;smallestLongDifference=j<smallestLongDifference?j:smallestLongDifference;if(h<=l&&j<=e){var b=this.calcHyp(h,j);if(b<bestCandidate){bestCandidate=b;this.gParams.bestChoiceUID=d.uid;this.gParams.bestChoiceTitle=d.title;if(this.gParams.geoLocationDebug){var a=this.convertDegreesToFeet(this.calcHyp(h,j));alert("found best choice: "+this.gParams.bestChoiceUID+"at "+a+" feet.")}}}}if(this.gParams.bestChoiceUID!=this.gParams.currentUID&&this.gParams.bestChoiceUID!=null&&this.gParams.bestChoiceUID!=""&&this.gParams.bestChoiceUID!=undefined){this.getPage(this.gParams.bestChoiceUID);this.sendMapAlert(this.gParams.bestChoiceUID);this.gParams.currentUID=this.gParams.bestChoiceUID}this.gParams.geoLock=false},updateDisplay:function(b,e,i,a,d){var f=this.calcHyp(b,e);var h=this.calcHyp(i,a);if(f<h){$(this.gParams.geoLocationReportDiv).html("<center>You are within "+this.convertDegreesToFeet(f)+" feet of "+d.title+".</center>")}},calcHyp:function(a,b){return Math.sqrt(Math.pow(a,2)+Math.pow(b,2))},showDistance:function(b,a){var d=this.calcHyp(b,a);if(true){$(this.gParams.geoLocationReportDiv).html("<center>You are within "+this.convertDegreesToFeet(d)+" feet of the closest position.</center>")}},displayMessage:function(a){$(this.gParams.geoLocationReportDiv).html("<center>"+a+"</center>")},getPage:function(a){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.REQUEST_NODE,a)},sendMapAlert:function(a){jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME).sendNotification(jet.AppConstants.ALERT_MAP,a)},convertDegreesToFeet:function(a){return Math.ceil(a*288200)},handleError:function(a){if(this.gParams.errorMessageDelivered==false){this.gParams.errorMessageDelivered=true;alert("This app was unable to get a precise GPS coordinate.  Please move out of doors and restart app.")}}},{TEXT_CHANGED:"textChanged"});puremvc.define({name:"jet.view.component.AnchorTileComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("div");this.div.className="tileSpacing";this.contentDiv=document.createElement("div");this.contentDiv.className="tileLabel";this.dragDiv=document.createElement("div");this.dragDiv.className="dragHandle"}},{dragDiv:null,indexInComponentArray:null,page:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.dragDiv);this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a);$(this.contentDiv).css("opacity",a)},setText:function(a){$(this.contentDiv).html(a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){$(this.div).css("left",a+"px");this.componentX=a},setY:function(a){$(this.div).css("top",a+"px");this.componentY=a},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},setZindex:function(a){$(this.div).css("z-index",a)},getGutter:function(){var a=10;return a},enable:function(){$(this.div).fadeTo("fast",1);$(this.contentDiv).fadeTo("fast",1)},disable:function(){$(this.div).fadeTo("fast",0.8);$(this.contentDiv).fadeTo("fast",0.8)},getUserInput:function(){},getIndexInArray:function(){return this.indexInComponentArray},makeDraggable:function(b,e,a,d){this.indexInComponentArray=d;$(this.div).unbind("dragstop");$(this.div).unbind("dragstart");$(this.div).draggable();$(this.div).bind("dragstop",function(){a.dragStop(this,d)});$(this.div).bind("dragstart",function(){a.dragStart(this)});this.addDragHandle();this.loadDragImage()},enableDraggable:function(){$(this.div).draggable("option","disabled",false)},disableDraggable:function(){$(this.div).draggable("disable")},addDragHandle:function(){var d=this.componentWidth*1.3;var a=this.componentWidth*0.3;var b=this.componentHeight;$(this.div).css("width",d);$(this.dragDiv).css("top","0px");$(this.dragDiv).css("left",this.componentWidth+"px");$(this.dragDiv).css("width",a);$(this.dragDiv).css("height",b)},loadDragImage:function(){$(this.dragDiv).html("<img src= './lib/css/drag_handle.png' />")}},{});puremvc.define({name:"jet.view.component.AudioComponent",constructor:function(d){this.mediator=d;this.enableAutoPlay="0";this.enableController="1";this.volume=0.8;this.div=document.createElement("div");this.show(false);this.audioDiv=document.createElement("div");this.audioDiv.className="audio_hostFrame";$(this.audioDiv).draggable();this.contentDiv=document.createElement("div");this.jpTypeSingle=document.createElement("div");this.jpGui=document.createElement("div");this.jpControls=document.createElement("ul");this.playControlDiv=document.createElement("a");this.div.className="jp-jplayer";this.contentDiv.id="jp_container_1";this.contentDiv.className="jp-audio";this.jpTypeSingle.className="jp-type-single";this.jpGui.className="jp-gui jp-interface";var a='<div class="jp-progress">';a+='<div class="jp-seek-bar">';a+='<div class="jp-play-bar"></div></div></div>';a+='<div class="jp-current-time"></div>';a+='<div class="jp-duration"></div>';$(this.jpGui).html(a);this.jpControls.className="jp-controls";var b="hello";var e='<li><a href="javascript:;" class="jp-play" tabindex="1">play</a></li>';e+='<li><a href="javascript:;" class="jp-pause" tabindex="1">pause</a></li>';e+='<li><a href="javascript:;" class="jp-stop" tabindex="1">stop</a></li>';$(this.jpControls).html(e);this.setParent($("body")[0])}},{mediator:null,div:null,audioDiv:null,contentDiv:null,jpTypeSingle:null,jpGui:null,jpControls:null,playControlDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,mediaURL:null,enableAutoPlay:null,enableController:null,volume:null,fallback:null,audioMarkedDivs:null,setParent:function(b){var a=this;$(b).append(this.audioDiv);var e=this.div;$(this.audioDiv).append(this.div);$(this.audioDiv).append(this.contentDiv);$(this.contentDiv).append(this.jpTypeSingle);$(this.jpTypeSingle).append(this.jpGui);$(this.jpGui).append(this.jpControls);$(this.jpControls).append(this.playControlDiv);$(this.div).jPlayer({timeupdate:function(f){a.handleTimeUpdate(f,a)},size:{width:"1px",height:"1px"},solution:"html",supplied:"mp3,wav",wmode:"window"});var d="./base/audio/"+this.getMediaURL()},setClass:function(a){$(this.div).attr("class",a)},show:function(i){if(i){$(this.div).removeAttr("disabled","disabled");var e="./base/audio/"+this.getMediaURL();var j="./base/audio/"+this.fallback;$(".jp-jplayer").jPlayer("clearMedia");$(this.div).jPlayer("setMedia",{mp3:e,wav:j});if(this.enableAutoPlay=="1"){$(this.div).jPlayer("play")}if(this.enableController=="1"){$(this.audioDiv).show()}else{$(this.audioDiv).hide()}$(this.div).jPlayer("volume",this.volume);var l=parseInt($(".viewer").css("width"));var h=parseInt($(".viewer").css("height"));var a=parseInt($(".viewer").css("left"));var m=parseInt($(".viewer").css("top"));var d=parseInt($(".viewer").css("width"));var k=parseInt($(".viewer").css("height"));var b=parseInt($(this.div).width());var f=parseInt($(this.div).height());$(this.audioDiv).draggable();this.getAudioMarkedDivs()}else{$(this.div).jPlayer("stop");$(this.closeButton).unbind("click")}},play:function(){$(this.div).jPlayer("play")},initialize:function(){},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a;$(this.div).jPlayer({size:{width:this.getWidth()+"px",height:this.getHeight()+"px"}});$(this.audioDiv).css("width",this.getWidth()+"px");$(".jp-interface").css("width",this.getWidth()+"px")},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a;$(this.div).jPlayer({size:{width:this.getWidth()+"px",height:this.getHeight()+"px"}});$(this.audioDiv).css("height",this.getHeight()+"px");$(".jp-interface").css("height",this.getHeight()+"px")},getHeight:function(){return this.componentHeight},setX:function(a){$(this.audioDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.audioDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},setContent:function(a){$(this.contentDiv).html(a);this.bindButton()},setMediaURL:function(a){this.mediaURL=a},getMediaURL:function(){return this.mediaURL},setAudioOptions:function(a){this.enableAutoPlay=a.enableAutoPlay;this.enableController=a.enableController;this.volume=parseInt(a.volume)/100;this.fallback=a.fallback},getAudioMarkedDivs:function(){var a=this;var b=$(a.audioDiv).parent();this.audioMarkedDivs=b.find("[data-audio_in]");$(a.audioMarkedDivs).each(function(){var d=$(this).attr("data-effect_in");a.handleInitialVisibility(this,d)})},handleInitialVisibility:function(a,b){switch(b){case"none":$(a).hide();break;case"show":$(a).hide();break;case"hide":$(a).hide();break;case"fadeIn":$(a).hide();break;case"fadeOut":$(a).hide();break;case"slideDown":$(a).hide();break;case"slideUp":$(a).hide();break;case"scrollTo":$(a).show();break;default:$(a).hide()}},handleTimeUpdate:function(d,a){var b=d.jPlayer.status.currentTime;$(a.audioMarkedDivs).each(function(){var h=$(this).attr("data-audio_in");var f=$(this).attr("data-speed");if(Math.abs(b-h)<1){var e=$(this).attr("data-effect_in");a.handleEffect(this,e,f)}});$(a.audioMarkedDivs).each(function(){var h=$(this).attr("data-audio_out");var f=$(this).attr("data-speed");if(Math.abs(b-h)<1){var e=$(this).attr("data-effect_out");a.handleEffect(this,e)}})},handleEffect:function(a,b,d){switch(d){case"fast":d=200;break;case"slow":d=2000;break;default:d=500;break}switch(b){case"none":$(a).show();break;case"show":$(a).show();break;case"hide":$(a).hide();break;case"fadeIn":$(a).fadeIn(d);break;case"fadeOut":$(a).fadeOut(d);break;case"slideDown":$(a).slideDown(d);break;case"slideUp":$(a).slideUp(d);break;case"scrollTo":$(a).show();$("html, body").animate({scrollTop:$(a).offset().top-70},d);default:$(a).show()}}},{});puremvc.define({name:"jet.view.component.CheckBoxComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("div");$(this.div).css("width","50px");$(this.div).css("height","50px");$(this.div).css("float","left");this.div.className="checkboxparent";this.contentDiv=document.createElement("input");this.contentDiv.className="checkbox";this.contentDiv.type="checkbox"}},{page:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(a).append(this.contentDiv);this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){},setCheck:function(a){this.contentDiv.checked=a},enable:function(){var d=this.page;var a=this;var b=this.contentDiv;this.disable();$(this.contentDiv).removeAttr("disabled","disabled");$(this.contentDiv).bind("click",function(e){e.stopPropagation();if(b.checked){d.setBranchingComponent(a)}d.handleEvent(jet.AppConstants.CHECKBOX,"click")})},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).attr("disabled","disabled")},getUserInput:function(){if(this.contentDiv.checked==true){return"true"}else{return"false"}},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},removeClass:function(a){$(this.div).removeClass(a)},setContentClass:function(a){$(this.contentDiv).attr("class",a)},addContentClass:function(a){$(this.contentDiv).addClass(a)}},{});puremvc.define({name:"jet.view.component.DashboardComponent",constructor:function(){this.div=document.createElement("div");this.div.className="dashboard";$(this.div).css("pointer-events","none");getJetWrapper().append(this.div)}},{div:null,handleEvent:function(a){switch(a.type){}},doDashboardLayout:function(){$(this.div).layout({type:"flow",resize:false,alignment:"left"})},initialize:function(){},},{});puremvc.define({name:"jet.view.component.ImageComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("div");this.div.className="imageparent";this.contentDiv=document.createElement("img");this.contentDiv.className="image";this.captionDiv=document.createElement("div");this.captionDiv.className="caption"}},{page:null,captionOptions:null,captionDiv:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.captionDiv)},setParentAndPosition:function(b,d,a){this.page=d;switch(a){case"prepend":$(b).prepend(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.captionDiv);break;default:$(b).append(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.captionDiv)}},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setCaptionOptions:function(f){this.captionOptions=f;if(this.captionOptions!=null){var h="<p>"+this.captionOptions.imageCaption+"</p><p>"+this.captionOptions.imageSource+"</p>";$(this.captionDiv).html(h);var e=parseInt(this.getY());var a=parseInt(this.getHeight());var d=20;var b=e+a+d;var i=parseInt(this.getX())}},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setText:function(a){if(a.length>0){this.contentDiv.src="base/"+a}else{$(this.contentDiv).hide()}},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).unbind("mousedown");$(this.contentDiv).unbind("mouseout");$(this.contentDiv).attr("disabled","disabled")},enable:function(){},setWidth:function(a){},getWidth:function(){return this.componentWidth},setHeight:function(a){},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",0+"px");this.componentX=a},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",0+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getImageParent:function(){return this.div}},{});puremvc.define({name:"jet.view.component.InputTextComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("input");this.div.className="inputbox";this.div.type="text";this.isCheckButtonRequested=false}},{page:null,isCheckButtonRequested:false,setParent:function(a,b){this.page=b;if(a!=null){$(a).append(this.div)}this.enable()},resetDiv:function(a){this.div=a;this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){$(this.div).css("left",a+"px");this.componentX=a},setY:function(a){$(this.div).css("top",a+"px");this.componentY=a},setWidth:function(a){$(this.div).css("width",a);this.componentWidth=a},setHeight:function(a){$(this.div).css("height",a);this.componentHeight=a},enable:function(){var a=this.page;a.isCheckButtonRequested=false;this.disable();$(this.div).removeAttr("disabled","disabled");$(this.div).bind("keydown",function(){if(!a.isCheckButtonRequested){a.showCheckAnswerButton();a.isCheckButtonRequested=true}})},disable:function(){$(this.div).unbind("keydown");$(this.div).attr("disabled","disabled")},getUserInput:function(){return $.trim($(this.div).val())}},{});puremvc.define({name:"jet.view.component.MeterComponent",constructor:function(a){this.mediator=a;this.div=document.createElement("div");this.meterNeedleDiv=document.createElement("div");this.contentDiv=document.createElement("canvas");this.meterNeedleDivContent=document.createElement("canvas");this.meterPieDivContent=document.createElement("canvas");this.div.className="dbMeterDiv";this.meterNeedleDiv.className="dbMeterNeedleDiv";this.contentDiv.className="dbMeterDivContent";this.meterNeedleDivContent.className="dbMeterNeedleDivContent";this.graphicsUtils=new jet.controller.command.util.GraphicsUtils()}},{mediator:null,div:null,contentDiv:null,meterNeedleDiv:null,meterNeedleDivContent:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,graphicsUtils:null,isMeterAnimating:false,lastNeedlePosition:0,setParent:function(d){$(d).append(this.div);$(this.div).append(this.contentDiv);$(this.div).append(this.meterNeedleDiv);$(this.meterNeedleDiv).append(this.meterNeedleDivContent);$(this.div).append(this.meterPieDivContent);this.initMeter();var b=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);var a=b.retrieveMediator(jet.view.mediator.DashboardComponentMediator.NAME);a.layoutDashboard()},setClass:function(a){},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},initialize:function(){},initMeter:function(){var h=this;this.clearCanvas(this.contentDiv);var f=0.5;var a=150;var e=parseInt(a*f);var j=parseInt(a*0.25);var d=parseInt(j*f);var b="#FFFFFF";var i=b;this.drawPie(this.contentDiv,a/2+10,e+10,2,e,0,144,"#FFFFFF");this.drawPie(this.contentDiv,a/2+10,e+10,2,e,144,180,"#00FF00");this.drawChord(this.contentDiv,a/2,e,a,e,"rgba(255,255,255,.1)");this.drawChord(this.contentDiv,a/2,e,j,d,i);this.setMeter(2)},setMeter:function(d){var e=0.5;var a=150;var b=parseInt(a*e);if(this.isMeterAnimating){return}d=Math.max(d,2);this.isMeterAnimating=true;this.animNeedle(this.meterNeedleDivContent,a/2+10,b+5,2,b-5,this.lastNeedlePosition,d)},setProperties:function(a){this.properties=a},setX:function(a){$(this.div).css("left",a+"px");$(this.meterNeedleDiv).css("left",a+"px");this.componentX=a},setY:function(a){$(this.div).css("top",a+"px");$(this.meterNeedleDiv).css("top",a+"px");this.componentY=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},setContent:function(a){$(this.contentDiv).html(a)},clearCanvas:function(a){g=this.contentDiv.getContext("2d");g.clearRect(0,0,a.width,a.height)},drawChord:function(F,z,v,B,L,b){var K={};var u={};g=this.contentDiv.getContext("2d");var i=parseInt(B/2);var r={x:z-i,y:v};var n={x:z+i,y:v};var j={x:z,y:v-L};var a=10;var d=this.graphicsUtils.calcAngle(r,n);var e=this.graphicsUtils.calcMidPointFromPoints(r,n);var H=this.graphicsUtils.calcMagnitude(j,e);var N=this.graphicsUtils.calcMagnitude(r,n);var s=((N*N)/(8*H))+(H/2);var J=this.graphicsUtils.calcAngle(j,e);var q=s*Math.cos(J);var t=s*Math.sin(J);var p=j.x+q;var l=j.y+t;var M=d;var z=a;var v=a;var o=r.y-l;var G=r.x-p;var k=n.y-l;var E=n.x-p;var I=Math.atan2(o,G);var D=Math.atan2(k,E);var f=this.graphicsUtils.isFlipped(r,n,j);g.beginPath();g.fillStyle=b;g.strokeStyle="rgba(42, 42, 42, 1)";g.lineWidth=10;var C=10;var A=10;g.moveTo(p+C,l+A);g.arc(p+C,l+A,s,I,D,f);g.moveTo(p+C-s,l+A);g.lineTo(p+C+s+(a/2),l+A);g.stroke();g.fill()},animNeedle:function(e,l,j,m,h,i,b){var f=i;var d=this;var k=1;if(i>b){k=-1}var a=setInterval(function(){f+=k;if(k==1&&f<b){d.drawNeedle(e,l,j,m,h,f)}else{if(k==-1&&f>b){d.drawNeedle(e,l,j,m,h,f)}else{clearInterval(a);a=null;d.isMeterAnimating=false;d.lastNeedlePosition=b}}},30)},drawNeedle:function(d,n,m,o,f,b){d.width=d.width;var e=(180-b)*Math.PI/180;var h=n+(f*Math.cos(e));var a=m-(f*Math.sin(e));var j=d.getContext("2d");j.beginPath();var l={x:h,y:a};var k={x:n,y:m};var i=o;j.lineWidth=i;j.strokeStyle="rgba(0,0,0, 1)";j.moveTo(l.x,l.y);j.lineTo(k.x,k.y);j.stroke();j.closePath()},drawPie:function(d,q,p,l,h,m,b,i){var k=d.getContext("2d");var e=m;k.beginPath();while(e<=b){var f=(180-e)*Math.PI/180;var j=q+(h*Math.cos(f));var a=p-(h*Math.sin(f));var o={x:j,y:a};var n={x:q,y:p};k.lineWidth=l;k.strokeStyle=i;k.moveTo(o.x,o.y);k.lineTo(n.x,n.y);k.stroke();e++}k.closePath()},displayBackground:function(a){var b=a.getContext("2d");var d=new Image();d.src="./lib/css/meter.png";b.drawImage(d,0,0)}},{});puremvc.define({name:"jet.view.component.NotesComponent",constructor:function(b){var a=this;this.mediator=b;this.div=document.createElement("div");this.show(false);this.contentDiv=document.createElement("div");this.div.className="popup";$(this.div).attr("role","alert");$(this.div).css("background-color","#fdfdbe");$(this.contentDiv).attr("aria-activedescendant","popupContent");this.contentDiv.className="popupContent";$(this.contentDiv).attr("id","popupContent");$(this.contentDiv).attr("aria-live","assertive");$(this.contentDiv).attr("role","alert");$(this.contentDiv).css("background-color","#fdfdbe");this.commitButton=document.createElement("input");this.commitButton.type="button";this.commitButton.className="notesButton";$(this.commitButton).css("position","absolute");$(this.commitButton).val("Save");$(this.commitButton).css("width","50px");$(this.commitButton).css("height","30px");$(this.commitButton).css("margin-bottom","10px");$(this.commitButton).click(function(){a.saveNotes()});$(this.contentDiv).append(this.commitButton);this.printButton=document.createElement("input");this.printButton.type="button";this.printButton.className="notesButton";$(this.printButton).css("position","absolute");$(this.printButton).val("Print");$(this.printButton).css("left","60px");$(this.printButton).css("width","50px");$(this.printButton).css("height","30px");$(this.printButton).css("margin-bottom","10px");$(this.printButton).css("margin-left","10px");$(this.printButton).click(function(){a.printNotes()});$(this.contentDiv).append(this.printButton);this.notesDiv=document.createElement("textarea");this.notesDiv.className="notesContent";this.notesDiv.type="text";$(this.notesDiv).attr("id","notesContent");$(this.notesDiv).attr("aria-live","assertive");$(this.notesDiv).attr("role","alert");$(this.notesDiv).css("position","absolute");$(this.notesDiv).css("top","60px");$(this.notesDiv).css("width","95%");$(this.notesDiv).css("height","80%");$(this.notesDiv).css("max-height","485px");$(this.notesDiv).css("border","none");$(this.notesDiv).css("padding-left","10px");$(this.notesDiv).css("resize","none");$(this.notesDiv).css("border-left","4px double rgba(238, 150, 122, .75)");$(this.notesDiv).css("background-color","#fdfdbe");$(this.contentDiv).append(this.notesDiv);this.closeButton=document.createElement("input");this.closeButton.type="button";this.closeButton.value="X";this.closeButton.className="closeButton";this.setParent($("body")[0])}},{mediator:null,div:null,contentDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,notesDiv:null,commitButton:null,learnerName:"testUser",setParent:function(a){var b=this.div;$(a).append(this.div);$(this.div).append(this.closeButton);$(this.div).append(this.contentDiv)},bindButton:function(){var d=this.div;var a=this.closeButton;var b=this.mediator;$(this.closeButton).unbind("click");$(this.closeButton).bind("click",function(){$(d).hide();$(a).unbind("click");b.requestResumeNavigation()})},setClass:function(a){$(this.div).attr("class",a)},show:function(a){if(a){$(this.div).show().focus();this.getNotes();this.bindButton()}else{$(this.div).hide()}},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},saveNotes:function(){try{var b=JSON.stringify($(this.notesDiv).attr("value"));localStorage[window.location+"/"+this.learnerName+"/notes"]=b}catch(a){alert(a)}},printNotes:function(){try{var d=$(this.notesDiv).attr("value");d=this.processUserResponse(d);var a=window.open("","my div","height=400,width=600");a.document.write("<html><head><title>My Notes</title>");a.document.write("</head><body >");a.document.write(d);a.document.write("</body></html>");a.document.close();a.focus();a.print();a.close();return true}catch(b){alert(b)}},getNotes:function(){if(localStorage!=null){var response=eval(localStorage[window.location+"/"+this.learnerName+"/notes"])}if(response!=null&&response!=undefined&&response.length>0){$(this.notesDiv).attr("value",response)}},processUserResponse:function(d){var e=/\r\n|\n\r|\n|\r/g;var f=d.split(e);var b="";for(var a=0;a<f.length;a++){b+=f[a]+"<br>"}return b},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},setContent:function(a){$(this.contentDiv).html(a)},getLearnerName:function(){if(LMSIsInitialized()==true){var a=doGetValue("cmi.learner_name");if(a!=null&&a!=undefined&&a.length>0){this.learnerName=a}}}},{});puremvc.define({name:"jet.view.component.OpenQuestionComponent",constructor:function(){this.div=document.createElement("div");this.contentDiv=document.createElement("div");this.div.className="component";this.contentDiv.className="text";this.answerKeys=[];this.userInputComponents=[]}},{page:null,div:null,contentDiv:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,answerKeys:null,userInputComponents:null,sourceText:null,hasEmbeddedVariables:false,show:function(a){if(a){this.evaluateEmbeddedVariables();if(typeof MathJax!=="undefined"&&MathJax.Hub){MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.contentDiv])}}},initialize:function(){this.evaluateEmbeddedVariables()},setParent:function(a,b){this.page=b;$(a).append(this.div);$(a).append(this.contentDiv)},removeFromParent:function(){$(this.div).remove();$(this.contentDiv).remove()},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},addQuestionStem:function(b){var a=new jet.view.component.ViewComponent;a.setContentClass("stem");a.setParent(this.contentDiv);a.setText(b)},addDistractor:function(d,a){var e=document.createElement("div");$(e).attr("class","distractorContainer");$(this.contentDiv).append(e);var b=new jet.view.component.CheckBoxComponent;b.setParent(e,this.page);b.setContentClass("distractorcheckbutton");this.page.answerKeys.push(a);this.page.userInputComponents.push(b);b.setIndexInArray(this.userInputComponents.length-1);var b=new jet.view.component.ViewComponent;b.setContentClass("distractor");b.setParent(e,this.page);b.setText(d)},removeClass:function(a){$(this.div).removeClass(a)},setContentClass:function(a){$(this.contentDiv).attr("class",a)},addContentClass:function(a){$(this.contentDiv).addClass(a)},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},getText:function(){return $(this.contentDiv).text()},getContentDiv:function(){return this.contentDiv},setSourceText:function(a){this.sourceText=a},getSourceText:function(){return this.sourceText},getDiv:function(){return this.div},setBackgroundColor:function(a){},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},setComponentLevelBranchOptions:function(a){this.branchOptions=a},getComponentLevelBranchOptions:function(){return this.branchOptions},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},handleEvent:function(a){switch(a.type){case"keyup":if(this.checkbox.checked){this.dispatchTextChangedEvent()}break;case"click":a.preventDefault();this.dispatchTextChangedEvent();break}},getUserInput:function(){},makeDraggable:function(){},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).unbind("mousedown");$(this.contentDiv).unbind("mouseout");$(this.contentDiv).attr("disabled","disabled")},enable:function(){},evaluateEmbeddedVariables:function(){if(this.hasEmbeddedVariables||$(this.contentDiv).text().match(/({)(\S*)(})/)!=null){this.hasEmbeddedVariables=true;if(this.getSourceText()==null){this.setSourceText($(this.contentDiv).html())}$(this.contentDiv).html(this.getSourceText());var d=$(this.contentDiv).find("p:contains('{')");for(var b=0;b<d.length;b++){var e=$(d[b]).text();captureGroups=e.match(/({)(\S*)(})/);if(captureGroups!=null&&captureGroups.length>2){var a=captureGroups[2];var f=getJetValue(a);if(f!=null&&f!=undefined){e=e.replace(/{.*}/,f);$(d[b]).html(e)}}}}}},{TEXT_CHANGED:"textChanged"});puremvc.define({name:"jet.view.component.OverlayComponent",constructor:function(a){this.mediator=a;this.div=document.createElement("div");this.show(false);this.contentDiv=document.createElement("div");this.div.className="overlay";this.contentDiv.className="overlayContent";$(this.contentDiv).css("margin-top","50px");this.closeButton=document.createElement("input");this.closeButton.type="button";this.closeButton.value="X";this.closeButton.className="closeButton";this.setParent($("body")[0])}},{mediator:null,div:null,contentDiv:null,originalOverlayContentParent:null,overlayContent:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,setParent:function(a){var b=this.div;$(a).append(this.div);$(this.div).append(this.closeButton);$(this.closeButton).css("z-index","20");$(this.div).append(this.contentDiv)},bindButton:function(){var d=this.div;var a=this.closeButton;var b=this.mediator;$(this.closeButton).unbind("click");$(this.closeButton).bind("click",function(){$(d).hide();$(a).unbind("click");b.requestResumeNavigation();b.hideOverlay()})},setClass:function(a){$(this.div).attr("class",a)},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},attachNode:function(a){this.overlayContent=a.getHTMLContent();$(this.contentDiv).html(this.overlayContent);this.bindButton()}},{});puremvc.define({name:"jet.view.component.PopupComponent",constructor:function(a){this.mediator=a;this.div=document.createElement("div");this.show(false);this.contentDiv=document.createElement("div");this.div.className="popup";$(this.div).attr("role","alert");$(this.contentDiv).attr("aria-activedescendant","popupContent");this.contentDiv.className="popupContent";$(this.contentDiv).attr("id","popupContent");$(this.contentDiv).attr("aria-live","assertive");$(this.contentDiv).attr("role","alert");this.closeButton=document.createElement("input");this.closeButton.type="button";this.closeButton.value="X";this.closeButton.className="closeButton";this.setParent($("body")[0])}},{mediator:null,div:null,contentDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,setParent:function(a){var b=this.div;$(a).append(this.div);$(this.div).append(this.closeButton);$(this.div).append(this.contentDiv)},bindButton:function(){var d=this.div;var a=this.closeButton;var b=this.mediator;$(this.closeButton).unbind("click");$(this.closeButton).bind("click",function(){$(d).hide();$(a).unbind("click");b.requestResumeNavigation()})},setClass:function(a){$(this.div).attr("class",a)},show:function(a){if(a){$(this.div).show().focus()}else{$(this.closeButton).unbind("click");$(this.div).hide()}},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);getOuterBackgroundColor(this.contentDiv);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},setContent:function(a){$(this.contentDiv).html(a);getOuterBackgroundColor(this.contentDiv);this.bindButton()}},{});puremvc.define({name:"jet.view.component.RadioButtonComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("div");$(this.div).css("width","50px");$(this.div).css("height","50px");$(this.div).css("float","left");this.div.className="checkboxparent";this.contentDiv=document.createElement("input");this.contentDiv.className="checkbox";this.contentDiv.type="radio";this.contentDiv.name="radioGrp"}},{page:null,setParent:function(a,b){this.page=b;$(a).append(this.div);$(a).append(this.contentDiv);this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){},setCheck:function(a){this.contentDiv.checked=a},enable:function(){var d=this.page;var a=this;var b=this.contentDiv;this.disable();$(this.contentDiv).removeAttr("disabled","disabled");$(this.contentDiv).bind("click",function(){if(b.checked){d.setBranchingComponent(a)}d.handleEvent(jet.AppConstants.CHECKBOX,"click")})},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).attr("disabled","disabled")},getUserInput:function(){if(this.contentDiv.checked==true){return"true"}else{return"false"}},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},removeClass:function(a){$(this.div).removeClass(a)},setContentClass:function(a){$(this.contentDiv).attr("class",a)},addContentClass:function(a){$(this.contentDiv).addClass(a)}},{});puremvc.define({name:"jet.view.component.TextAreaComponent",parent:jet.view.component.ViewComponent,constructor:function(){this.div=document.createElement("textarea");this.div.className="longAnswer"}},{page:null,setParent:function(a,b){this.page=b;$(a).append(this.div);this.enable()},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.component!=null){$(this.component).css("opacity",a)}},setX:function(a){$(this.div).css("left",a+"px");this.componentX=a},setY:function(a){$(this.div).css("top",a+"px");this.componentY=a},setWidth:function(a){$(this.div).css("width",a);this.componentWidth=a},setHeight:function(a){$(this.div).css("height",a);this.componentHeight=a},enable:function(){var a=this.page;this.disable();$(this.div).removeAttr("disabled","disabled");$(this.div).bind("focus",function(){a.showCheckAnswerButton()})},disable:function(){$(this.div).unbind("focus");$(this.div).attr("disabled","disabled")},getUserInput:function(){return $.trim(this.div.value)},setUserInput:function(a){$(this.div).val(a)}},{});puremvc.define({name:"jet.view.component.TooltipComponent",constructor:function(a){this.mediator=a;this.div=document.createElement("div");this.show(false);this.contentDiv=document.createElement("div");this.div.className="tooltip";this.contentDiv.className="tooltipContent";this.closeButton=document.createElement("input");this.closeButton.type="button";this.setParent($("body")[0])}},{mediator:null,div:null,contentDiv:null,component:null,attachedNode:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,branchOptions:null,indexInComponentArray:null,closeButton:null,setParent:function(a){var b=this.div;$(a).append(this.div);$(this.div).append(this.contentDiv)},setClass:function(a){$(this.div).attr("class",a)},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);$(this.contentDiv).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);$(this.contentDiv).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");$(this.contentDiv).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");$(this.contentDiv).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.contentDiv!=null){$(this.contentDiv).css("opacity",a)}},setText:function(a){$(this.contentDiv).html(a);if(this.foregroundOpacity!=null){$(this.contentDiv).css("opacity",this.foregroundOpacity)}},setBackgroundColor:function(a){$(this.div).css("background-color","#"+a)},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},show:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}},setContent:function(a){$(this.contentDiv).html(a)}},{});puremvc.define({name:"jet.view.component.ViewerComponent",constructor:function(){var a=document.createElement("div");a.className="viewer";$(a).attr("role","main");getJetWrapper().append(a)}},{handleEvent:function(a){switch(a.type){case"keyup":if(this.checkbox.checked){this.dispatchTextChangedEvent()}break;case"click":a.preventDefault();this.dispatchTextChangedEvent();break}}},{});puremvc.define({name:"jet.view.gadget.Gadget",constructor:function(){this.div=document.createElement("div");this.div.className="gadget";var a=jet.ApplicationFacade.getIntance();this.setMediator(a.retrieveMediator(jet.view.mediator.DashboardMediator.NAME))}},{gadget:null,div:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,mediators:{},setParent:function(a,b){this.gadget=b;$(a).append(this.div)},removeFromParent:function(){$(this.div).remove()},setDataObject:function(a){},setPositioning:function(a){switch(a){case"static":$(this.div).removeAttr("style");$(this.div).css("position","static");break;case"absolute":$(this.div).removeAttr("style");$(this.div).css("position","absolute");break}},setClass:function(a){$(this.div).attr("class",a)},addClass:function(a){$(this.div).addClass(a)},removeClass:function(a){$(this.div).removeClass(a)},animatePosition:function(a,d,b){$(this.div).animate({left:a,top:d},{queue:false,duration:b,easing:"swing"})},setProperties:function(a){this.properties=a},getProperties:function(){return this.properties},setWidth:function(a){$(this.div).css("width",a);this.componentWidth=a},getWidth:function(){return this.componentWidth},setHeight:function(a){$(this.div).css("height",a);this.componentHeight=a},getHeight:function(){return this.componentHeight},setX:function(a){$(this.div).css("left",a+"px");this.componentX=a},setInitialX:function(a){this.initialComponentX=a},getInitialX:function(){return this.initialComponentX},setInitialY:function(a){this.initialComponentY=a},getInitialY:function(){return this.initialComponentY},getX:function(){this.updatePosition();return this.componentX},setY:function(a){$(this.div).css("top",a+"px");this.componentY=a},getY:function(){this.updatePosition();return this.componentY},getMargin:function(){},setBackgroundOpacity:function(a){$(this.div).css("opacity",a)},setForegroundOpacity:function(a){this.foregroundOpacity=a;if(this.div!=null){$(this.div).css("opacity",a)}},setText:function(a){$(this.div).html(a);if(this.foregroundOpacity!=null){$(this.div).css("opacity",this.foregroundOpacity)}},getText:function(){return $(this.div).text()},getHTML:function(){return $(this.div).html()},getDiv:function(){return this.div},setBackgroundColor:function(a){},updatePosition:function(){this.setX(parseInt($(this.div).css("left"),10));this.setY(parseInt($(this.div).css("top"),10))},getIndexInArray:function(){return this.indexInComponentArray},setIndexInArray:function(a){this.indexInComponentArray=a},handleEvent:function(a){switch(a.type){}},getUserInput:function(){},makeDraggable:function(){},disable:function(){$(this.div).unbind("click");$(this.div).unbind("hover");$(this.div).unbind("mousedown");$(this.div).unbind("mouseout");$(this.div).attr("disabled","disabled")},enable:function(){},setMediator:function(a,b){this.mediators[a]=b},getMediator:function(a){return this.mediators[a]},setVisible:function(a){if(a){$(this.div).show()}else{$(this.div).hide()}}},{TEXT_CHANGED:"textChanged",NAME:"Gadget"});puremvc.define({name:"jet.view.gadget.BarGraphGadget",parent:jet.view.gadget.Gadget,constructor:function(){this.div=document.createElement("div");$(this.div).addClass("bargraphgadget");$(this.div).attr("id","barGraph");$(".dashboard").append(this.div);var a=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);this.dashBoardMediator=a.retrieveMediator(jet.view.mediator.DashboardComponentMediator.NAME);this.dashBoardMediator.layoutDashboard()}},{gadget:null,div:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,mediators:{},dashBoardMediator:null,setDataObject:function(b){var d=null;var j=null;var a=null;var e=null;var i=null;var f=null;if(b.hasOwnProperty("data")){d=b.data}if(b.hasOwnProperty("ticks")){j=b.ticks}if(b.hasOwnProperty("minValue")){i=b.minValue}if(b.hasOwnProperty("maxValue")){f=b.maxValue}if(b.hasOwnProperty("seriesColors")){a=b.seriesColors}if(b.hasOwnProperty("series")){e=b.series}var k={seriesDefaults:{renderer:$.jqplot.BarRenderer,rendererOptions:{fillToZero:true}},seriesColors:a,series:e,legend:{show:false},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:j,},yaxis:{pad:1.05,min:i,max:f}}};var h=$.jqplot("barGraph",d,k);h.replot(d)},handleEvent:function(a){switch(a.type){}}},{TEXT_CHANGED:"textChanged"});puremvc.define({name:"jet.view.gadget.LegendGadget",parent:jet.view.gadget.Gadget,constructor:function(){this.div=document.createElement("div");$(this.div).addClass("legendgadget");$(this.div).attr("id","legendgadget");$(".dashboard").append(this.div);var a=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);this.dashBoardMediator=a.retrieveMediator(jet.view.mediator.DashboardComponentMediator.NAME);this.dashBoardMediator.layoutDashboard()}},{gadget:null,div:null,component:null,foregroundOpacity:null,componentWidth:0,componentHeight:0,componentX:0,componentY:0,initialComponentX:0,initialComponentY:0,componentMargin:0,properties:null,mediators:{},dashBoardMediator:null,setDataObject:function(b){$(this.div).empty();var e=null;var d=null;if(b.hasOwnProperty("data")){e=b.data}if(b.hasOwnProperty("seriesColors")){d=b.seriesColors}for(var a=0;a<e.length;a++){this.createLegendPart(e[a],this.div,d[a])}$(this.div).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:5})},createLegendPart:function(d,e,a){var b=document.createElement("div");b.className="legendGadgetPart";$(e).append(b);$(b).html(d+" <font color="+a+">&#x2588;</font>")},handleEvent:function(a){switch(a.type){}}},{TEXT_CHANGED:"textChanged",NAME:"LegendGadget"});puremvc.define({name:"jet.view.page.Node",parent:jet.view.component.ViewComponent,constructor:function(a){this.uid=a}},{uid:null,mediators:{},setUID:function(a){this.uid=a},getUID:function(){return this.uid},setMediator:function(a,b){this.mediators[a]=b},getMediator:function(a){return this.mediators[a]},getHTMLContent:function(){},getContentAsResource:function(){var a="<p style='text-align: center;'><font face='Segoe UI'><br></font></p><p style='text-align: center;'><font face='Arial'>This type of page cannot be displayed as a resource.</font></p>";return a},getClonedContent:function(){},show:function(a){},postProcess:function(){},processNotification:function(a){},handleEvent:function(b,a){},getProperty:function(d,b){var e=null;for(var a=d.length-1;a>-1;a--){if(e!=null){break}var f=d[a];if(!f.hasOwnProperty(b)){continue}else{e=d[a];break}}return e}},{NAME:"Node"});puremvc.define({name:"jet.view.page.Page",parent:jet.view.page.Node,constructor:function(a){this.uid=a;this.branchOptions={uid:a}}},{myDiv:null,contentDiv:null,totalPoints:0,userPoints:0,backgroundColor:"",userFeedback:"",branchOptions:{checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null},isUserCorrect:null,isInFlow:true,show:function(a){},buildComponent:function(d,b,a,e){},hideComponents:function(b){for(var a=0;a<b.length;a++){b[a].show(false)}},showComponents:function(b){for(var a=0;a<b.length;a++){b[a].show(true)}},setBranchOptions:function(a){this.branchOptions=a},getBranchOptions:function(){return this.branchOptions},setBranchingComponent:function(a){},setTotalPoints:function(a){this.totalPoints=a},getTotalPoints:function(){return this.totalPoints},setUserPoints:function(a){this.userPoints=a},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(a){this.backgroundColor=a},setUserFeedback:function(a){this.userFeedback=a},enableInteractivity:function(){},disableInteractivity:function(){},getUserPoints:function(){return Math.max(0,this.userPoints)},getUserFeedback:function(){return this.userFeedback},getTag:function(a){var b=this.getProperty(a,"tag");if(b!=null&&b!=undefined){return b.tag}return null},getDOMParent:function(){return $(this.myDiv).parent()},getDiv:function(){return this.myDiv},getContentDiv:function(){return this.contentDiv},setDiv:function(a){this.myDiv=a},getIsUserCorrect:function(){return this.isUserCorrect},setIsUserCorrect:function(a){this.isUserCorrect=a},handleEvent:function(b,a){},getName:function(){return"Page"},clearFeedback:function(){},clearBranchOptions:function(){},processNotification:function(b,a){},setInFlow:function(a){this.isInFlow=a},getInFlow:function(){return this.isInFlow},isPageLevelBranchOption:function(a){if(a==null||a==undefined){return false}if(a.checkedOption!=null&&a.checkedOption!=""&&a.checkedOption!="No Action"){return true}if(a.showFeedback!=null&&a.showFeedback!=""&&a.showFeedback!="false"){return true}return false}},{NAME:"Page"});puremvc.define({name:"jet.view.page.CategoriesPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("CategoriesPage");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.dragComponents=[];this.anchorComponents=[];this.randomNumbers=[];this.answerKeys=[];this.feedBackComponents=[]}},{tempXPos:0,tempYPos:0,originalAnchorTilePositions:[],originalDragTilePositions:[],answerKeys:null,feedBackComponents:null,components:null,userInputComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,isUserCorrect:null,questionStem:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(b,f,d,k,j){switch(f){case jet.AppConstants.AUDIO:if(k.length<1){return}var h=new jet.view.component.AudioComponent;h.setMediaURL(k);h.setAudioOptions(j);h.setParent(b.contentDiv);h.setProperties(d);b.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(h,d);this.components.push(h);break}var l=b.getTag(d);var h;if(l=="totalpoints"){b.setTotalPoints(k)}else{if(l=="flowstatus"){if(k=="true"){b.setInFlow("false")}}else{if(f==jet.AppConstants.NODES_MANAGER){b.branchOptions=j;if(l=="checkedNodeOptions"){b.checkedBranchOptions=j}if(l=="uncheckedNodeOptions"){b.unCheckedBranchOptions=j}}else{if(f==jet.AppConstants.TEXT&&k.length>0){var i=getProperty(d,"tag");if(i!=null){if(i.tag=="instructions"){h=this.createComponent(b,d,k);this.setQuestionStem(k)}if(i.tag.indexOf("draggable_a")>-1){var a=this.createComponent(b,d,"");a.setWidth(a.getWidth()*1.3);a.addClass("dragTarget");h=this.createComponent(b,d,k);h.addClass("dragTile");this.dragComponents.push(h);var e=parseInt(this.getProperty(d,"player_y").player_y,10);this.originalDragTilePositions.push(e);h.makeDraggable(this.dragStart,this.dragStop,this,this.dragComponents.length-1)}if(i.tag.indexOf("draggable_b")>-1){var a=this.createComponent(b,d,"");a.setWidth(a.getWidth()*1.3);a.addClass("dragTarget");h=this.createComponent(b,d,k);h.addClass("dragTile");this.dragComponents.push(h);var e=parseInt(this.getProperty(d,"player_y").player_y,10);this.originalDragTilePositions.push(e);h.makeDraggable(this.dragStart,this.dragStop,this,this.dragComponents.length-1)}else{if(i.tag=="anchored"){h=this.createComponent(b,d,k);h.addClass("categoryTitle");this.anchorComponents.push(h)}}}}}}}},postProcess:function(){},createComponent:function(d,b,e){var a=new jet.view.component.AnchorTileComponent;a.setParent(d.myDiv);a.setProperties(b);d.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(e);return a},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){for(var a=0;a<this.dragComponents.length;a++){this.dragComponents[a].enableDraggable();this.dragComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.dragComponents.length;a++){this.dragComponents[a].disableDraggable();this.dragComponents[a].disable()}},evaluateUserActivity:function(){this.disableInteractivity();var f="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var h=this.getTotalPoints()/this.dragComponents.length;for(var d=0;d<this.dragComponents.length;d++){var e=this.getProperty(this.dragComponents[d].getProperties(),"tag").tag=="draggable_a"?0:1;var b=this.anchorComponents[e];if(this.dragComponents[d].getX()!=this.anchorComponents[e].getX()){f="\u2718";this.setIsUserCorrect(false);var a=parseInt((this.getUserPoints()-h)*10)/10;this.setUserPoints(a);this.addFeedback(this.dragComponents[d],false)}else{this.addFeedback(this.dragComponents[d],true)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions}this.storeUserFeedback()}return f},getBranchOptions:function(){return this.branchOptions},processComponents:function(){for(var b=0;b<this.dragComponents.length;b++){this.randomNumbers.push(b)}this.shuffle(this.randomNumbers);if(this.dragComponents.length<=0){return}var h=this.dragComponents[0].getHeight();for(var b=0;b<this.dragComponents.length;b++){var e=this.randomNumbers[b];var a=this.dragComponents[e];var d=parseInt($(".viewer").css("width"));var f=480;a.setX(f);a.setInitialX(f);a.setY(30);a.setInitialY(b*h);a.setZindex(10+b)}},shuffle:function(b){for(var d,a,e=b.length;e;d=parseInt(Math.random()*e),a=b[--e],b[e]=b[d],b[d]=a){}},dragStart:function(a){},dragStop:function(k,m){this.showCheckAnswerButton();var l=parseInt($(k).css("left"),10);var j=parseInt($(k).css("top"),10);for(var h=0,d=10000,r=0;h<this.anchorComponents.length;h++){var f=Math.abs(l-this.anchorComponents[h].getX());if(f<d){d=f;r=h}}var b=this.anchorComponents[r];var n=this.dragComponents[m];var p=parseInt(b.getX(),10);var o=parseInt(n.getY(),10);var q=Math.abs(p-n.getX());if(q<n.getWidth()){for(var h=0,a=10000,r=0;h<this.originalDragTilePositions.length;h++){var e=Math.abs(j-this.originalDragTilePositions[h]);if(e<a){a=e;r=h}o=parseInt(this.originalDragTilePositions[r],10)}n.setX(p);n.setY(o)}else{n.animatePosition(n.getInitialX(),n.getInitialY(),1000)}},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("z-index","1");$(b).css("top",d.getY());$(b).css("left",d.getX()-13);var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},},{NAME:"CategoriesPage"});puremvc.define({name:"jet.view.page.CrosswordPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("CrosswordPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.crosswordDiv=document.createElement("div");$(this.contentDiv).append(this.crosswordDiv);this.crosswordDiv.id="crosswordDiv";this.acrossHintsDiv=document.createElement("div");$(this.contentDiv).append(this.acrossHintsDiv);this.acrossHintsDiv.id="acrossHintsDiv";this.acrossHintsDiv.className="hintsDiv";$(this.acrossHintsDiv).css("width","40%");this.downHintsDiv=document.createElement("div");$(this.contentDiv).append(this.downHintsDiv);this.downHintsDiv.id="downHintsDiv";this.downHintsDiv.className="hintsDiv";$(this.downHintsDiv).css("width","40%");this.directionDiv=document.createElement("div");$(this.contentDiv).append(this.directionDiv);this.directionDiv.id="directionDiv";this.directionDiv.className="directionDiv";$(this.directionDiv).html("&#x21E8");this.hintFieldDiv=document.createElement("div");$(this.crosswordDiv).after(this.hintFieldDiv);this.hintFieldDiv.id="hintFieldDiv";$(this.hintFieldDiv).width("100%");$(this.hintFieldDiv).height("30px");$(this.hintFieldDiv).css("background","transparent");$(this.hintFieldDiv).css("color","black");$(this.hintFieldDiv).css("text-align","center");$(this.hintFieldDiv).css("clear","both");$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.distractorComponents=[];this.hideAnswer=false;this.executedSetCustomScore={};this.questionStem="";this.questionTextBlock="";this.branchingOptionArray=new Array(10);this.puzzle={row:[]};this.clues={across:[],down:[]};this.crosswordObjects=[]}},{stemComponent:null,textBlockComponent:null,imageComponent:null,audioComponent:null,doInstructionsExist:false,stemYOffset:0,questionStem:null,questionTextBlock:null,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,branchOptionArray:null,randomStatus:null,NA:"_NA_",EMPTYCELL:"_",currentCellColor:"#FFFF33",normalCellColor:"#FFFFFF",currentCell:"#C0302",currentRow:"3",currentColumn:"2",direction:"across",determineDirectionFlag:true,numberOfNormalRows:11,numberOfOrphansAllowed:4,numberOfRows:15,numberOfColumns:"20",cellSize:"20",margin:"1.25",hintNumber:0,LEFT:37,RIGHT:39,UP:38,DOWN:40,ACROSS_DIRECTION:"across",DOWN_DIRECTION:"down",crosswordDiv:null,hintFieldDiv:null,acrossHintsDiv:null,downHintsDiv:null,directionDiv:null,acrossSelect:null,downSelect:null,puzzle:null,clues:null,xml:null,crosswordObjects:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(h,f,d,i,e){switch(f){case jet.AppConstants.NODES_MANAGER:var j=h.getTag(d);if(j=="checkedNodeOptions"){h.checkedBranchOptions=e}if(j=="uncheckedNodeOptions"){h.unCheckedBranchOptions=e}break;case jet.AppConstants.CROSSWORD:this.processXML(i,this.puzzle,this.clues);this.makeCrossword();this.makeHints();break;case jet.AppConstants.TEXT:var j=h.getTag(d);if(j=="totalpoints"){h.setTotalPoints(i)}break;case jet.AppConstants.CHECKBOX:var j=h.getTag(d);if(j=="hideAnswer"){h.setHideAnswer(i)}else{if(j=="flowstatus"){if(i=="true"){h.setInFlow("false")}}else{if(j=="randomstatus"){if(i=="true"){h.setRandomStatus("true")}}else{var b=new jet.view.component.CheckBoxComponent;b.setParent(h.contentDiv,this);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(b,d);this.answerKeys.push($.trim(i));this.userInputComponents.push(b);b.setIndexInArray(this.userInputComponents.length-1);b.addContentClass(j);var a=document.createElement("div");a.className="feedback";this.feedBackComponents.push(a)}}}break;case jet.AppConstants.IMAGE:this.imageComponent=new jet.view.component.ImageComponent;this.imageComponent.setParent(h.contentDiv);this.imageComponent.setProperties(d);this.imageComponent.addClass("questionImage");h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.imageComponent,d);this.imageComponent.setText(i);break;case jet.AppConstants.AUDIO:if(i.length<1){return}this.audioComponent=new jet.view.component.AudioComponent;this.audioComponent.setMediaURL(i);this.audioComponent.setAudioOptions(e);this.audioComponent.setParent(h.myDiv);this.audioComponent.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.audioComponent,d);this.components.push(this.audioComponent);break}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100},getBranchOptions:function(){return this.branchOptions},evaluateCrossWord:function(){var k=this.getUserPoints();var b=$(this.crosswordDiv).find(".puzzleInput");var a=b.length;var f=a;for(var e=0;e<b.length;e++){var d=b[e];var h=$(d).data("answer").toUpperCase();var j=$(d).val().toUpperCase();if(h==j){$(d).css("background-color","#5DFC0A")}else{--f;$(d).css("background-color","#FF0000");$(d).val("\u2718");this.setIsUserCorrect(false)}}this.setUserPoints(Math.ceil(f/a*k))},evaluateUserActivity:function(){var a="";this.disableInteractivity();var b="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());this.evaluateCrossWord();if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){a=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){a=this.branchOptions.feedback}}this.storeUserFeedback()}if(this.branchOptions&&this.branchOptions.feedback){this.branchOptions.feedback=a}return this.getHideAnswer()=="false"?b:"Sent"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();this.branchingOptionArray[b]=a;if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(b,d){var a=this.feedBackComponents[b];if(this.getHideAnswer()=="false"){$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).html("")}},clearBranchOptions:function(){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};this.setBranchOptions(a)},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setQuestionTextBlock:function(a){this.questionTextBlock=a},getQuestionTextBlock:function(){return this.questionTextBlock},setRandomStatus:function(a){this.randomStatus=a},getRandomStatus:function(){return this.randomStatus},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},processXML:function(k,r,l){xmlDoc=$.parseXML(k);var t=$(xmlDoc).find("crosswords");var o=t.attr("rowCount");var n=t.attr("colCount");if(o>0&&n>0){this.numberOfColumns=Number(n);this.numberOfNormalRows=Number(o)}this.initPuzzle(r);var m=$(xmlDoc).find("crossword");for(var j=0;j<m.length;j++){var p=m[j];var b=$(p).find("word")[0].textContent.trim();var d=$(p).find("orientation")[0].textContent;var f=1*$(p).find("column")[0].textContent;var s=1*$(p).find("row")[0].textContent;var h=$(p).find("hint")[0].textContent.trim();var q={word:b,orientation:d,row:s,column:f,hint:h,hintNumber:""};this.crosswordObjects.push(q);this.placeInPuzzle(b,d,f,s,r);this.placeInHints(h,b,d,f,s,l)}var e=$(xmlDoc).find("orphan");var a=this.numberOfNormalRows+Number(1);for(var j=0;j<e.length&&j<this.numberOfOrphansAllowed;j++){var p=e[j];var b=$(p).find("word")[0].textContent.trim();if(b.length<=this.numberOfColumns){var d="horiz";var f=0;var s=a++;var h=$(p).find("hint")[0].textContent.trim();var q={word:b,orientation:d,row:s,column:f,hint:h,hintNumber:""};this.crosswordObjects.push(q);this.placeInPuzzle(b,d,f,s,r);this.placeInHints(h,b,d,f,s,l)}}},initPuzzle:function(b){for(var a=0;a<this.numberOfRows+this.numberOfOrphansAllowed;a++){this.puzzle.row.push("___________________________________________________________________")}},placeInPuzzle:function(a,b,d,m,k){switch(b){case"horiz":var h=k.row[m];var f=h.substring(0,d);var l=h.substring(d+a.length,h.length);h=f+a+l;k.row[m]=h;break;case"vert":var j=0;for(var e=m;e<m+a.length;e++){var h=k.row[e];var f=h.substring(0,d);var l=d<h.length-1?h.substring(d+1,h.length):"";h=f+a.substring(j,j+1)+l;j++;k.row[e]=h}}},placeInHints:function(h,e,a,b,f,d){switch(a){case"horiz":var h={no:b,text:h,word:e,row:f,column:b};d.across.push(h);break;case"vert":var h={no:f,text:h,word:e,row:f,column:b};d.down.push(h);break}},getCellID:function(b,a){return"input_"+this.uid+"_"+(b*1000+a)},getAnswer:function(b,a){return $("#"+this.getCellID(b,a)).data("answer")},makeCrossword:function(){$(this.crosswordDiv).width(this.numberOfColumns*this.cellSize*this.margin+5);$(this.crosswordDiv).height(this.numberOfRows*this.cellSize*this.margin+5);_number=1;for(rowIndex=0;rowIndex<this.numberOfRows;rowIndex++){for(cIndex=0;cIndex<this.numberOfColumns;cIndex++){var a=document.createElement("div");$(a).addClass("square");$(a).width(this.cellSize+"px");$(a).height(this.cellSize+"px");$(a).css("position","absolute");$(a).css("top",rowIndex*(this.margin*this.cellSize)+"px");$(a).css("left",cIndex*(this.margin*this.cellSize)+"px");c=this.puzzle.row[rowIndex].substring(cIndex,cIndex+1);this.differentiateCell(a,c);$(this.crosswordDiv).append(a)}}},makeHints:function(){this.sortHints(this.clues.across);this.sortHints(this.clues.down);this.initHints(this.acrossHintsDiv,this.clues.across,this.ACROSS_DIRECTION);this.initHints(this.downHintsDiv,this.clues.down,this.DOWN_DIRECTION);var a=this;$(this.acrossSelect).change(function(b){a.hintClick(b,"across",a)});$(this.downSelect).change(function(b){a.hintClick(b,"down",a)})},sortHints:function(e){var b=false;while(!b){b=true;for(var d=0;d<e.length;d++){if(d<e.length-1){var a=e[d];if(a.row>e[d+1].row){e[d]=e[d+1];e[d+1]=a;b=false}}}}b=false;while(!b){b=true;for(var d=0;d<e.length;d++){if(d<e.length-1){var a=e[d];if(a.row==e[d+1].row){if(a.column>e[d+1].column){e[d]=e[d+1];e[d+1]=a;b=false}}}}}},differentiateCell:function(e,h){var i=this;if(h==this.EMPTYCELL){$(e).attr("class","emptySquare")}else{var j=document.createElement("input");var a=this.getCellID(rowIndex,cIndex);j.type="text";j.maxLength=1;j.id=a;$(j).addClass("puzzleInput");$(j).css("font-size","12pt");$(j).css("line-height","10pt");$(j).css("padding","0 0 2.5pt 5.5pt");$(j).width(this.cellSize*0.8+"px");$(j).height(this.cellSize*0.8+"px");$(j).data("answer",h);$(j).data("row",rowIndex);$(j).data("col",cIndex);var d=[{word:""},{word:""}];if(this.isInitial(rowIndex,cIndex,d)){$(j).css("background-color","#c7c7ff");$(j).data("hintNumber",++this.hintNumber);this.assignHintNumberToCrosswordObject(d,this.hintNumber);var f=document.createElement("div");$(f).css("width",this.cellSize/2);$(f).css("height",this.cellSize/2);$(f).css("left",2);$(f).css("top",2);$(f).css("position","absolute");$(f).css("font-size","6pt");$(f).html(this.hintNumber);$(e).append(f)}var k=this.EMPTYCELL;var b=this.EMPTYCELL;if(cIndex>0){k=this.puzzle.row[rowIndex].substring(cIndex-1,cIndex)}if(cIndex<this.puzzle.row.length-1){b=this.puzzle.row[rowIndex].substring(cIndex+1,cIndex+2)}if(k!=this.EMPTYCELL||b!=this.EMPTYCELL){$(j).data("orientation","horiz")}else{$(j).data("orientation","vert")}$(j).click(function(l){i.inputClick(l,true);i.showCheckAnswerButton()});$(j).bind("keyup",function(l){});$(j).bind("keydown",function(l){i.keyDownHandler(l)});$(j).bind("keypress",function(l){i.keyPressHandler(l)});$(e).append(j);this.normalCellColor=$(e).css("background-color")}},isInitial:function(h,f,e){var b=0;var a=false;for(var d=0;d<this.crosswordObjects.length;d++){if(h==this.crosswordObjects[d].row&&f==this.crosswordObjects[d].column){e[b++].word=this.crosswordObjects[d].word;a=true}}return a},assignHintNumberToCrosswordObject:function(b,d){for(var a=0;a<b.length;a++){if(this.getCrossWordObject(b[a].word)!=null){this.getCrossWordObject(b[a].word).hintNumber=d}}return},getCrossWordObject:function(b){for(var a=0;a<this.crosswordObjects.length;a++){if(b==this.crosswordObjects[a].word){return this.crosswordObjects[a]}}return null},keyDownHandler:function(b){if(b.which==this.LEFT||b.which==this.RIGHT||b.which==this.UP||b.which==this.DOWN){this.move(b.which);var a=$("#"+this.getCellID(this.currentRow,this.currentColumn));var d=a.attr("id");this.moveToCell("#"+d,false);b.preventDefault();return}},keyPressHandler:function(d){d.preventDefault();if(d.currentTarget.tagName!="INPUT"){return}if(d.which==this.LEFT||d.which==this.RIGHT||d.which==this.UP||d.which==this.DOWN){return}this.clearCurrentCell();var a=d.which||d.keyCode;var b=String.fromCharCode(a);$(d.currentTarget).val(b);this.keyUpHandler(d)},keyUpHandler:function(b){if(b.currentTarget.tagName!="INPUT"){return}if(b.which==this.LEFT||b.which==this.RIGHT||b.which==this.UP||b.which==this.DOWN){this.move(b.which);var a=$("#"+this.getCellID(this.currentRow,this.currentColumn));var d=a.attr("id");this.moveToCell("#"+d,false);return}if(this.direction==this.ACROSS_DIRECTION){this.move(this.RIGHT)}else{this.move(this.DOWN)}var a=$("#"+this.getCellID(this.currentRow,this.currentColumn));this.determineDirectionFlag=false;a.click()},inputClick:function(b,a){if(this.determineDirectionFlag==false){this.determineDirectionFlag=true;this.moveToCell("#"+b.currentTarget.id,false)}else{this.moveToCell("#"+b.currentTarget.id,true)}this.getHint(this.currentRow,this.currentColumn)},clearCurrentCell:function(){$(this.currentCell).val("")},hintClick:function(d,a,f){this.determineDirectionFlag=false;$("#acrossSelect").blur();$("#downSelect").blur();f.setDirection(a);clueIndex=d.target.selectedIndex;var h=this.clues[a][clueIndex].word;var b=this.getCrossWordObject(h);var e=b.hintNumber;var i=b.hint;$(this.hintFieldDiv).text(a+": "+i);for(rowIndex=0;rowIndex<this.numberOfRows;rowIndex++){for(cIndex=0;cIndex<this.numberOfColumns;cIndex++){var j="#"+this.getCellID(rowIndex,cIndex);if($(j).data("hintNumber")==e){$(j).click();break}}}this.resetCells();this.highlightCells(b.row,b.column,b.word,a,true)},resetCells:function(){for(var d=0;d<this.crosswordObjects.length;d++){var b=this.crosswordObjects[d];var h=b.row;var e=b.column;var f=b.word;var a=b.orientation;this.highlightCells(h,e,f,a,false)}},highlightCells:function(j,e,h,b,f){switch(b){case"horiz":case this.ACROSS_DIRECTION:for(var d=0;d<h.length;d++){var k="#"+this.getCellID(j,e++);var a=f?this.currentCellColor:"white";$(k).css("background-color",a)}break;case"vert":case this.DOWN_DIRECTION:for(var d=0;d<h.length;d++){var k="#"+this.getCellID(j++,e);var a=f?this.currentCellColor:"white";$(k).css("background-color",a)}break}},moveToCell:function(d,b){if(d.indexOf("input")<0){return}$(this.currentCell).css("background-color","white");$(d).css("background-color",this.currentCellColor);this.currentRow=$(d).data("row");this.currentColumn=$(d).data("col");if(b==true){var a=$(d).data("orientation");if(a=="horiz"){this.setDirection(this.ACROSS_DIRECTION)}if(a=="vert"){this.setDirection(this.DOWN_DIRECTION)}}this.currentCell="#"+this.getCellID(this.currentRow,this.currentColumn);$(this.currentCell).focus()},move:function(d){if(this.isValidMove(d)==false){return}var b=this.currentRow;var a=this.currentColumn;switch(d){case this.UP:this.setDirection(this.DOWN_DIRECTION);this.currentRow--;if(this.currentRow<0){this.currentRow=b}break;case this.DOWN:this.setDirection(this.DOWN_DIRECTION);this.currentRow++;if(this.currentRow>this.numberOfRows){this.currentRow=b}break;case this.LEFT:this.setDirection(this.ACROSS_DIRECTION);this.currentColumn--;if(this.currentColumn<0){this.currentColumn=a}break;case this.RIGHT:this.setDirection(this.ACROSS_DIRECTION);this.currentColumn++;if(this.currentColumn>this.numberOfColumns){this.currentColumn=a}break}},isValidMove:function(a){switch(a){case this.RIGHT:if(this.currentColumn+1>this.puzzle.row[this.currentRow].length||this.puzzle.row[this.currentRow].charAt(this.currentColumn+1)==this.EMPTYCELL){return false}break;case this.LEFT:if(this.currentColumn<1||this.puzzle.row[this.currentRow].charAt(this.currentColumn-1)==this.EMPTYCELL){return false}break;case this.UP:if(this.currentRow<1||this.puzzle.row[this.currentRow-1].charAt[this.currentColumn]==this.EMPTYCELL){return false}break;case this.DOWN:if(this.currentRow+1>this.puzzle.row.length||this.puzzle.row[this.currentRow+1].charAt(this.currentColumn)==this.EMPTYCELL){return false}break}return true},initHints:function(i,e,h){var f=document.createElement("select");f.id=h+"Select_"+this.uid;f.className="hintsSelect";$(f).css("width","100%");if(h=="across"){this.acrossSelect=f}else{this.downSelect=f}$(f).attr("size",e.length+1);$(i).append(f);var j=document.createElement("label");$(j).attr("for",h+"Select");$(j).text(h.toUpperCase());$(i).prepend(j);for(index=0;index<e.length;index++){var a=e[index].word;var b=h+e[index].no+"_"+this.uid;var d=this.getCrossWordObject(a);var k=d.hintNumber+"\t"+e[index].text;var l=document.createElement("option");l.id=b;$(l).data("crossWordObject",d);$(l).text(k);$(f).append(l)}},setDirection:function(a){this.direction=a;if(a==this.ACROSS_DIRECTION){$(this.directionDiv).html("&#x21E8")}else{$(this.directionDiv).html("&#x21E9")}},getHint:function(j,a){var f=$(this.hintFieldDiv).text();$(this.hintFieldDiv).text("");var q=Number(j);var b=Number(a);var l=$(this.acrossSelect).children();for(var h=0;h<l.length;h++){var o=l[h];$(o).css("background-color","#FFFFFF");var e=$(o).data("crossWordObject");var n=Number(e.row*1);var m=Number(e.column*1);if((n==q)&&(m==b)){$(o).css("background-color","#aaaaff");$(this.acrossSelect).val("");var k=$(o).data("crossWordObject");var d=k.hint;$(this.hintFieldDiv).text("across: "+d)}}l=$(this.downSelect).children();for(var h=0;h<l.length;h++){var o=l[h];$(o).css("background-color","#FFFFFF");var e=$(o).data("crossWordObject");var n=Number(e.row*1);var m=Number(e.column*1);if((n==q)&&(m==b)){$(o).css("background-color","#c7c7c7");$(this.downSelect).val("");var k=$(o).data("crossWordObject");var d=k.hint;var p=$(this.hintFieldDiv).text()+"        down:"+d;$(this.hintFieldDiv).text(p)}}if($(this.hintFieldDiv).text().length<1){$(this.hintFieldDiv).text(f)}},},{NAME:"CrosswordPage"});puremvc.define({name:"jet.view.page.DialogPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("DialogPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.questionContainerDiv=document.createElement("div");this.questionContainerDiv.className="dialogQuestionContainer";$(this.myDiv).append(this.questionContainerDiv);this.questionDiv=document.createElement("div");this.questionDiv.className="dialogQuestion";$(this.questionContainerDiv).append(this.questionDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,questionDiv:null,questionContainerDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",correctRating:null,additionalInfo:null,userAnswer:null,domainType:null,additionalInfoInput:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{this.initGadgets();b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var i=f.getTag(b);if(i=="checkedNodeOptions"){f.checkedBranchOptions=d}if(i=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.TEXT:var i=f.getTag(b);if(i=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.questionContainerDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialogStem");this.questionStem=h}else{if(i.match("dialog1")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog1")}}else{if(i.match("dialog2")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog2")}}else{if(i.match("correctRating")){this.correctRating=h.toUpperCase().trim()}else{if(i.match("additionalInfo")){this.additionalInfo=h.toUpperCase().trim();if(this.additionalInfo.length>0){this.additionalInfoInput=new jet.view.component.InputTextComponent;this.additionalInfoInput.setParent(f.questionContainerDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.additionalInfoInput,b);this.additionalInfoInput.setText("");this.additionalInfoInput.addClass("additionalInfoInput")}}else{if(i=="totalpoints"){this.setTotalPoints(h)}}}}}}break;case jet.AppConstants.COMBO_BOX:var i=f.getTag(b);if(i=="questionTypes"){this.createQuestionType(h)}if(i=="domainTypes"){this.setDomainType(h)}break;case jet.AppConstants.IMAGE:var i=f.getTag(b);if(i=="character1"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character1")}if(i=="character2"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character2")}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var i=f.getTag(b);if(i=="hideAnswer"){f.setHideAnswer(h)}if(i=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break}},getDomainType:function(){return this.domainType},setDomainType:function(a){switch(a.trim()){case"Criminal History":this.domainType="Criminal";break;case"Education/Employment":this.domainType="Education";break;case"Family/Marital":this.domainType="Family";break;case"Leisure/Recreation":this.domainType="Leisure";break;case"Companions":this.domainType="Companions";break;case"Alcohol/Drug Problem":this.domainType="Alcohol";break;case"Procriminal Attitude/Orientation":this.domainType="Procriminal";break;case"Antisocial Pattern":this.domainType="Antisocial";break}},createQuestionType:function(a){switch(a){case ("3-0 Rating"):this.createQPart("3",this.questionDiv);this.createQPart("2",this.questionDiv);this.createQPart("1",this.questionDiv);this.createQPart("0",this.questionDiv);break;case ("Yes No"):this.createQPart("No",this.questionDiv);this.createQPart("Yes",this.questionDiv);break;case ("True False"):this.createQPart("True",this.questionDiv);this.createQPart("False",this.questionDiv);break;default:}$(this.questionDiv).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},createQPart:function(d,e){var a=document.createElement("div");a.className="dialogQuestionPart";$(e).append(a);$(a).html(d);var b=this;$(a).on("click",function(){b.setUserAnswer(d.toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(a).addClass("selected");b.showCheckAnswerButton()})},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var a=this;$(this.questionContainerDiv).find(".dialogQuestionPart").on("click",function(){a.setUserAnswer($(this).text().toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(this).addClass("selected");a.showCheckAnswerButton()});if(this.additionalInfoInput!=null){this.additionalInfoInput.enable()}},disableInteractivity:function(){var b=this;var a=b.getContentDiv();$(this.questionContainerDiv).find(".dialogQuestionPart").unbind("click");if(this.additionalInfoInput!=null){this.additionalInfoInput.disable()}},processComponents:function(){},postProcess:function(){},getBranchOptions:function(){return this.branchOptions},setMetrics:function(d,a){if(d!=null){d=d.trim()}else{d="5"}switch(d){case"0":d=1;break;case"1":d=1;break;case"YES":d=1;break;default:d=0}var b=this.getDomainType();a[b]=a[b]+d},evaluateUserActivity:function(){var b=jet.view.page.DialogPage.USER_METRICS;var f=jet.view.page.DialogPage.EXPERT_METRICS;this.disableInteractivity();this.setMetrics(this.userAnswer,b);this.setMetrics(this.correctRating,f);this.sendGraphData(b,f);var i="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.userAnswer!=this.correctRating){i="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}if(this.additionalInfoInput!=null){var h=this.additionalInfoInput.getUserInput().toUpperCase();if(h!=this.additionalInfo.toUpperCase()){i="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}var e=this.domainType+"_"+this.questionStem;var a=this.getIsUserCorrect()?"correct":"incorrect";var d={uid:this.getUID(),questionType:"choice",question:e.substring(0,249),learnerResponse:this.userAnswer,correctResponse:this.correctRating,result:a};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.getUID(),d);return true?i:"Submitted"},sendGraphData:function(o,q){var l=this.scaleData("Criminal",o.Criminal);var f=this.scaleData("Education",o.Education);var m=this.scaleData("Family",o.Family);var p=this.scaleData("Leisure",o.Leisure);var i=this.scaleData("Companions",o.Companions);var u=this.scaleData("Alcohol",o.Alcohol);var b=this.scaleData("Procriminal",o.Procriminal);var a=this.scaleData("Antisocial",o.Antisocial);var t=[[m],[i],[l],[f],[p],[u],[b],[a]];var s=["2=Low, 3=Med, 4=High"];var e=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var j=0;var r=5;var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var d={};d.name="BARGRAPH";d.data=t;d.ticks=s;d.seriesColors=e;d.series=h;d.minValue=j;d.maxValue=r;var k=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);k.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,d);var n={};n.name="LEGEND";n.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];n.seriesColors=e;k.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,n)},storeUserFeedback:function(){},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){},disable:function(){},getName:function(){return"DialogPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setUserAnswer:function(a){this.userAnswer=a},getUserAnswer:function(){return this.userAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},initGadgets:function(){if(jet.view.page.DialogPage.INIT_GADGETS){return}jet.view.page.DialogPage.INIT_GADGETS=true;var j=1;var l=2;var f=1;var d=5;var n=1;var a=3;var p=1;var k=1;var i=[[f],[n],[j],[l],[d],[a],[p],[k]];var o=["2=Low, 3=Med, 4=High"];var b=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var e={};e.name="BARGRAPH";e.data=i;e.ticks=o;e.seriesColors=b;e.series=h;var q=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);q.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,e);var m={};m.name="LEGEND";m.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];m.seriesColors=b;q.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,m)},scaleData:function(b,a){88;switch(b){case"Criminal":case"Education":switch(a){case 0:case 1:return 1;case 2:case 3:return 2;case 4:case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5}break;case"Family":case"Companions":case"Procriminal":case"Antisocial":switch(a){case 0:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5}break;case"Leisure":switch(a){case 0:return 1;case 1:return 3;case 2:return 4}break;case"Alcohol":switch(a){case 0:return 1;case 1:case 2:return 2;case 3:case 4:return 3;case 5:case 6:return 4;case 7:case 8:return 5}break}}},{INIT_GADGETS:false,USER_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},EXPERT_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},NAME:"DialogPage"});puremvc.define({name:"jet.view.page.DragNDropPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.initialCanvasPositions=[];this.clickTouchEvents={};this.clickTouchAreaID=0;this.feedBackComponents=[];this.layers={};this.groups={};this.shapeProperties=["EnableClickTouch","EnableBranch","EnableMouseOver"];this.hideAnswer="false";this.hideCheckButton="false"}},{contentDiv:null,answerKeys:null,components:null,initialCanvasPositions:null,clickTouchEvents:null,clickTouchAreaID:0,feedBackComponents:null,layers:null,groups:null,ignoreXPosition:false,ignoreYPosition:false,branchOptions:null,shapeProperties:null,hideAnswer:"false",hideCheckButton:"false",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(b,e,d,i,h){var j=b.getTag(d);var f;if(j=="totalpoints"){b.setTotalPoints(i)}if(j=="IgnoreXPosition"){this.ignoreXPosition=i=="true"?true:false}if(j=="IgnoreYPosition"){this.ignoreYPosition=i=="true"?true:false}if(j=="hideAnswer"){this.setHideAnswer(i)}if(j=="hideCheckButton"){this.setHideCheckButton(i)}if(j=="flowstatus"){if(i=="true"){b.setInFlow("false")}}switch(e){case jet.AppConstants.IMAGE:var a=b.getMediator(jet.view.mediator.GraphicsMediator.NAME);if(i.length>=6){var k=i.substring(0,6);a.getXMLData(k,b)}break;case jet.AppConstants.NODES_MANAGER:b.branchOptions=h;break;case jet.AppConstants.AUDIO:if(i.length<1){return}var f=new jet.view.component.AudioComponent;f.setMediaURL(i);f.setAudioOptions(captionOptions);f.setParent(b.contentDiv);f.setProperties(d);b.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(f,d);this.components.push(f);break}},handleText:function(a){},showCheckAnswerButton:function(){if(this.getHideCheckButton()=="false"){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()}},processGraphicsObject:function(d,e,a){var i=this;var j=$(d).attr("class");if(i.isShapeProperty(j)){if(j.indexOf("EnableClickTouch")>-1){var k=++i.clickTouchAreaID;$(d).removeClass("EnableMotion");$(d).removeClass("ui-draggable");i.clickTouchEvents[k]={action:e.action,userClicked:false,canvas:d,objectMap:e};e.enabled=true;$(d).unbind("click");$(d).unbind("dragstop");$(d).unbind("dragstart");$(d).bind("click",function(){i.clickTouch(d,i,e,k)})}if(j.indexOf("EnableBranch")>-1){$(d).removeClass("EnableMotion");$(d).removeClass("ui-draggable");e.enabled=true;$(d).unbind("click");$(d).unbind("dragstop");$(d).unbind("dragstart");$(d).bind("click",function(){i.clickAndBranch(d,i,e)})}if(j.indexOf("EnableMouseOver")>-1){var h=parseInt($(d).css("left"));var b=parseInt($(d).css("top"));$(d).removeClass("EnableMotion");$(d).removeClass("ui-draggable");e.enabled=true;$(d).unbind("mouseenter");$(d).unbind("mouseleave");$(d).unbind("dragstop");$(d).unbind("dragstart");$(d).bind("mouseenter",function(){i.mediators[jet.view.mediator.PageMediator.NAME].showToolTip(e.mouseoveraction,h,b)});$(d).bind("mouseleave",function(){i.mediators[jet.view.mediator.PageMediator.NAME].hideToolTip()})}return}if(j.indexOf("EnableMotion")>-1&&j.indexOf("EnableModify")>-1){var f={};f.canvas=d;f.x=$(d).css("left");f.y=$(d).css("top");f.height=a.y;f.width=a.x;f.objectMap=e;this.initialCanvasPositions.push(f);$(d).unbind("dragstop");$(d).unbind("dragstart");$(d).bind("dragstop",function(){i.dragStop(d,i)});$(this.div).bind("dragstart",function(){})}},postProcessGraphics:function(){this.randomizeComponents()},clickTouch:function(d,e,f,a){var b=f.enabled;if(b){var h=0;e.showCheckAnswerButton();this.clickTouchEvents[a].userClicked=true;e.setJetValue(f);if(this.getHideCheckButton()=="true"){this.evaluateUserActivity()}else{$(d).css({border:"2px dashed #000000"})}}},clickAndBranch:function(b,d,e){var a=e.enabled;if(a){branchOptions={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};branchOptions.checkedOption=e.event;branchOptions.checkedValue=e.action;d.setJetValue(e);this.mediators[jet.view.mediator.PageMediator.NAME].executeBranch(branchOptions,true)}},dragStop:function(b,k){var p=new jet.controller.command.util.GraphicsUtils();k.showCheckAnswerButton();var n=k.initialCanvasPositions;var j=parseInt($(b).css("left"),10);var f=parseInt($(b).css("top"),10);var o={};o.x=j;o.y=f;var r=10000;var a=null;for(var h=0;h<n.length;h++){var q={};q.x=parseInt(n[h]["x"]);q.y=parseInt(n[h]["y"]);var e=p.calcMagnitude(o,q);if(e<r){r=e;a=q}}if(r<100){$(b).css("left",a.x);$(b).css("top",a.y)}else{var m=700;var l=200;var d=0;for(var h=0;h<k.initialCanvasPositions.length;h++){if(b===k.initialCanvasPositions[h]["canvas"]){d=k.initialCanvasPositions[h]["InitialPosition"]}}$(b).animate({left:m,top:d},{queue:false,duration:1000,easing:"swing"})}if(this.getHideCheckButton()=="true"){this.evaluateUserActivity()}},enableInteractivity:function(){var d=this;for(var b=0;b<this.initialCanvasPositions.length;b++){var a=this.initialCanvasPositions[b]["canvas"];$(a).draggable("option","disabled",false)}for(var f in d.clickTouchEvents){var a=d.clickTouchEvents[f].canvas;var e=d.clickTouchEvents[f].objectMap;e.enabled=true;d.clickTouchEvents[f].userClicked=false}},disableInteractivity:function(){for(var b=0;b<this.initialCanvasPositions.length;b++){var a=this.initialCanvasPositions[b]["canvas"];$(a).draggable("disable")}for(var e in this.clickTouchEvents){var a=this.clickTouchEvents[e].canvas;var d=this.clickTouchEvents[e].objectMap;$(a).css({border:"none"});d.enabled=false}},processComponents:function(){},randomizeComponents:function(){var f=[];var a=10;var i=700;var m=25;for(var d=0;d<this.initialCanvasPositions.length;d++){f.push(d)}this.shuffle(f);if(this.initialCanvasPositions.length<=0){return}for(var e=0;e<this.initialCanvasPositions.length;e++){var l=f[e];if(l>=this.initialCanvasPositions.length){continue}if(this.initialCanvasPositions[l]==undefined){continue}var b=this.initialCanvasPositions[l]["canvas"];if(b!=undefined&&b!=null){$(b).css("left",i+"px");$(b).css("top",a+"px");this.initialCanvasPositions[l]["InitialPosition"]=a;var h=this.initialCanvasPositions[l]["height"];a+=h;a+=10}}},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){var h=this.ignoreYPosition?10:0;var r=this.ignoreXPosition?10:0;if(this.getHideCheckButton()=="false"){this.disableInteractivity()}var l="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var a=this.getTotalPoints()/(this.initialCanvasPositions.length+this.clickTouchAreaID);for(var q=0;q<this.initialCanvasPositions.length;q++){var f=this.initialCanvasPositions[q]["canvas"];var k=parseInt($(f).css("left"));var j=parseInt($(f).css("top"));var o=parseInt(this.initialCanvasPositions[q]["x"]);var m=parseInt(this.initialCanvasPositions[q]["y"]);var p=Math.abs(k-o);var n=Math.abs(j-m);if((!this.ignoreXPosition&&p>h)||(!this.ignoreYPosition&&n>r)){l="\u2718";this.setIsUserCorrect(false);var s=parseInt((this.getUserPoints()-a)*10)/10;this.setUserPoints(s);this.addFeedback(f,false)}else{this.addFeedback(f,true);this.setJetValue(this.initialCanvasPositions[q]["objectMap"])}}for(var d in this.clickTouchEvents){var f=this.clickTouchEvents[d].canvas;var b=this.clickTouchEvents[d].action=="Judge Correct"?true:false;var e=this.clickTouchEvents[d].userClicked;if((b&&!e)||(!b&&e)){l="\u2718";this.setIsUserCorrect(false);var s=parseInt((this.getUserPoints()-a)*10)/10;this.setUserPoints(s);this.addFeedback(f,false)}else{if(b){this.addFeedback(f,true)}}}return this.getHideAnswer()=="false"?l:"Submitted"},setBranchOptions:function(a){this.branchOptions=a},setBranchingComponent:function(a){},handleEvent:function(b,a){},getName:function(){return"ImagePage"},getContentDiv:function(){return this.contentDiv},shufflex:function(b){for(var d,a,e=b.length;e;d=parseInt(Math.random()*e),a=b[--e],b[e]=b[d],b[d]=a){}},shuffle:function(b){for(var d,a,e=b.length;e>0;){d=parseInt(Math.random()*e);a=b[--e];b[e]=b[d];b[d]=a}},addFeedback:function(d,a){if(this.getHideAnswer()=="false"){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("z-index","11");$(b).css("top",$(d).css("top"));$(b).css("left",parseInt($(d).css("left"))-13+"px");var e=a?"\u2713":"\u2718";$(b).html(e)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},getGroups:function(){return this.groups},getLayers:function(){return this.layers},isShapeProperty:function(d){for(var b=0;b<this.shapeProperties.length;b++){var a=this.shapeProperties[b];if(d.indexOf(a)>-1){return true}}return false},setJetValue:function(e){if(e.hasOwnProperty("setvalueevent")&&e.hasOwnProperty("setvalueaction")){if(e.setvalueaction.length>0){var b=e.setvalueevent;switch(b){case jet.AppConstants.SET_VALUE:var a=e.setvalueaction;var d=a.split(",");if(d.length==2){whichProperty=d[0];whatValue=d[1];setJetValue(whichProperty,whatValue)}break;case jet.AppConstants.APPEND_VALUE:var a=e.setvalueaction;var d=a.split(",");if(d.length==2){whichProperty=d[0];whatValue=d[1];appendJetValue(whichProperty,whatValue)}break}}}},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setHideCheckButton:function(a){this.hideCheckButton=a},getHideCheckButton:function(){return this.hideCheckButton}},{NAME:"ImagePage"});puremvc.define({name:"jet.view.page.FlashCardPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("flashcard");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.feedBackComponents=[]}},{branchOptions:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,useRegEx:false,processedExpression:false,processedRegEx:false,originalExpression:null,isUserCorrect:null,feedBackComponents:null,feedbackToStudents:null,canvasDiv:null,resetRequired:false,storedUserInputProperties:null,deepClonedDiv:null,deepClonedUserInput:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);if(this.resetRequired){this.resetRequired=false;this.resetUserInputField()}}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:f.branchOptions=d;break;case jet.AppConstants.CHECKBOX:this.processedRegEx=true;if(h.toUpperCase()=="TRUE"){this.useRegEx=true}if(this.processedExpression&this.processedRegEx){this.processAnswerKeys()}var i=f.getTag(b);if(i=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break;case jet.AppConstants.TEXT:var i=f.getTag(b);if(i=="totalpoints"){f.setTotalPoints(h)}else{if(i=="expression"){this.storedUserInputProperties=b;this.processedExpression=true;this.originalExpression=h;var a=new jet.view.component.InputTextComponent;a.setParent(f.myDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);this.userInputComponents.push(a);if(this.processedExpression&this.processedRegEx){this.processAnswerKeys()}}else{if(i=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.myDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h)}else{if(i=="Feedback"){this.feedbackToStudents=h}}}}break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(f.myDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break}},handleText:function(a){},splitIntoAnswerKeys:function(d){if(this.useRegEx!=true){var a=$.trim(d).split("|");for(var b=0;b<a.length;b++){this.answerKeys.push(a[b])}}else{this.answerKeys.push(d)}},concatenateAnswerKeys:function(){if(this.answerKeys.length>0){var b=this.answerKeys[0];for(var a=1;a<this.answerKeys.length;a++){b+="|"+this.answerKeys[a]}this.answerKeys[0]=b}},processAnswerKeys:function(){if(this.useRegEx){this.answerKeys.push(this.originalExpression)}else{this.splitIntoAnswerKeys(this.originalExpression)}},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},processComponents:function(){this.applyBoxShadow()},applyBoxShadow:function(){$(this.myDiv).css("-webkit-box-shadow","0px 0px 10px rgba(0,0,0,.8)");$(this.myDiv).css("-moz-box-shadow","0px 0px 10px rgba(0,0,0,.8)");$(this.myDiv).css("box-shadow","0px 0px 10px rgba(0,0,0,.8)")},evaluateUserActivity:function(){this.deepClonedDiv=$(this.myDiv).clone(true);var b="\u2713";this.setInFlow(false);this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.useRegEx){if(!this.doesAnswerMatchExpression(this.userInputComponents[0].getUserInput())){b="\u2718";this.setInFlow(true);this.resetRequired=true;this.setIsUserCorrect(false);this.setUserPoints(0);this.addFeedback(this.userInputComponents[0],false)}else{this.addFeedback(this.userInputComponents[0],true)}}else{if(!this.isAnswerinArray(this.userInputComponents[0].getUserInput())){b="\u2718";this.setInFlow(true);this.resetRequired=true;this.setIsUserCorrect(false);this.setUserPoints(0);this.addFeedback(this.userInputComponents[0],false)}else{this.addFeedback(this.userInputComponents[0],true)}}var a=b=="\u2713"?"#bdffbd":"#ffc5bf";$(this.myDiv).flippy({color_target:a,direction:"right",duration:"500",verso:"<div style='margin:30px'><p style='margin-top:50px;font-size:xx-large' align='center'>"+b+"</p><p align='center'><b>Your answer:</b> "+this.userInputComponents[0].getUserInput()+"</p> <p style='margin-top:20px;font-size:xx-large' align='center'><b>Correct Answer: </b>"+this.feedbackToStudents+"</p></div>"});return b},getBranchOptions:function(){return this.branchOptions},doesAnswerMatchExpression:function(b){var a=false;$.each(this.answerKeys,function(d,e){if(b.match(e)){a=true}});return a},isAnswerinArray:function(b){var a=false;$.each(this.answerKeys,function(d,e){if($.trim(e.toUpperCase())==$.trim(b.toUpperCase())){a=true}});return a},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("top",d.getY());$(b).css("left",5);var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},resetUserInputField:function(){$(this.myDiv).empty();$(this.myDiv).remove();this.myDiv=this.deepClonedDiv;$(".viewer").append(this.myDiv);$(this.myDiv).show();var a=$(this.myDiv).find("input");this.userInputComponents[0].resetDiv(a)}},{NAME:"FlashCardPage"});puremvc.define({name:"jet.view.page.GatePage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.components=[];this.userInputComponents=[];this.branchingComponents=[];this.passBranchOptions=null;this.failBranchOptions=null;this.branchOptions=null;this.customVariables=null;this.overrideNavigation="false";this.allowNext="true";this.allowBack="true"}},{components:null,userInputComponents:null,branchOptions:null,passBranchOptions:null,failBranchOptions:null,branchingComponents:null,scoreThreshold:0,passMessage:"",failMessage:"",resetScore:false,resetInteractivityOnly:false,allowBack:"true",allowNext:"true",overrideNavigation:false,allowPassRegardlessOfScore:true,useCustomScore:false,usePercentage:false,customScoreVariableName:"",customVariables:"",show:function(a){},setScoreThreshold:function(a){this.scoreThreshold=a},getScoreThreshold:function(){return this.scoreThreshold},setPassMessage:function(a){this.passMessage=a},getPassMessage:function(){return this.passMessage},setFailMessage:function(a){this.failMessage=a},getFailMessage:function(){return this.failMessage},setResetScore:function(a){this.resetScore=a},getResetScore:function(){return this.resetScore},setResetInteractivityOnly:function(a){this.resetInteractivityOnly=a},getResetInteractivityOnly:function(){return this.resetInteractivityOnly},setAllowBack:function(a){this.allowBack=a},getAllowBack:function(){return this.allowBack},setAllowNext:function(a){this.allowNext=a},getAllowNext:function(){return this.allowNext},setNavigationDefault:function(a){this.overrideNavigation=a},getNavigationDefault:function(){return this.overrideNavigation},setAllowPassRegardlessOfScore:function(a){this.allowPassRegardlessOfScore=a},getAllowPassRegardlessOfScore:function(){return this.allowPassRegardlessOfScore},setPassOptions:function(a){this.passBranchOptions=a},setFailOptions:function(a){this.failBranchOptions=a},setUseCustomScore:function(a){this.useCustomScore=a},getUseCustomScore:function(){return this.useCustomScore},setUsePercentage:function(a){this.usePercentage=a},getUsePercentage:function(){return this.usePercentage},setCustomScoreVariableName:function(a){this.customScoreVariableName=a},getCustomScoreVariableName:function(){return this.customScoreVariableName},setCustomVariables:function(a){this.customVariables=a},getCustomVariables:function(){return this.customVariables},buildComponent:function(e,d,a,f,b){var h=e.getTag(a);switch(d){case jet.AppConstants.TEXT:switch(h){case"scoreThreshold":e.setScoreThreshold(f);break;case"passOptions":e.setPassOptions(b);break;case"failOptions":e.setFailOptions(b);break;case"customScoreVariableName":e.setCustomScoreVariableName(f);break;case"variables":e.setCustomVariables(f);break}break;case jet.AppConstants.CHECKBOX:switch(h){case"resetScore":e.setResetScore(f);break;case"resetInteractivityOnly":e.setResetInteractivityOnly(f);break;case"allowBack":e.setAllowBack(f);break;case"allowNext":e.setAllowNext(f);break;case"overrideNavigation":e.setNavigationDefault(f);break;case"passRegardlessOfScore":e.setAllowPassRegardlessOfScore(f);break;case"useCustomScore":e.setUseCustomScore(f);break;case"usePercentage":e.setUsePercentage(f);break}break}},handleText:function(a){},processComponents:function(){},postProcess:function(){this.mediators[jet.view.mediator.PageMediator.NAME].getReport();if(this.getResetScore()=="true"){this.mediators[jet.view.mediator.PageMediator.NAME].resetScore()}if(this.getResetInteractivityOnly()=="true"){this.mediators[jet.view.mediator.PageMediator.NAME].resetInteractivityOnly()}if(this.getCustomVariables().length>0){this.mediators[jet.view.mediator.PageMediator.NAME].resetCustomScores(this.getCustomVariables())}},processNotification:function(d,a){switch(d){case jet.AppConstants.REPORT_INTERNALLY:var b=a;var f=b.scoreTotal;var e;if(this.getUseCustomScore()=="true"){e=getJetValue(this.getCustomScoreVariableName())}else{e=b.userTotal}this.processBranch(e,f);break}},processBranch:function(d,e){if(this.getUsePercentage()=="true"){if(e>0){this.setBranchOptions((d/e*100)>=this.scoreThreshold?this.passBranchOptions:this.failBranchOptions)}else{this.setBranchOptions(this.passBranchOptions)}}else{this.setBranchOptions(d>=this.scoreThreshold?this.passBranchOptions:this.failBranchOptions)}var a=this.getBranchOptions();var b=new Object();b.getBranchOptions=function(){return a};this.mediators[jet.view.mediator.PageMediator.NAME].processFeedbackAndBranchingOptions(b,null,null)},getBranchOptions:function(){return this.branchOptions},setBranchOptions:function(a){this.branchOptions=a},getBranchOptions:function(){return this.branchOptions},getName:function(){return"Gate"}},{NAME:"GatePage"});puremvc.define({name:"jet.view.page.ImagePage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("ImagePage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.iFrames=[]}},{contentDiv:null,answerKeys:null,components:null,iFrames:null,IFRAMEWIDTH:930,IFRAMEHEIGHT:450,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.showIFrames(true)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.showIFrames(false)}},buildComponent:function(h,e,d,i,b){switch(e){case jet.AppConstants.IMAGE:if(i.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var f=i.replace(/.*?v=/,"");this.drawYouTubePlayer(f);return}var a=new jet.view.component.ImageComponent;a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);a.setText(i);a.setCaptionOptions(b);break;case jet.AppConstants.AUDIO:if(i.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(i);a.setAudioOptions(b);a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var j=h.getTag(d);if(j=="flowstatus"){if(i=="true"){h.setInFlow(false)}}break}},handleText:function(a){},enableInteractivity:function(){},disableInteractivity:function(){},processComponents:function(){},getBranchOptions:function(){},evaluateUserActivity:function(){},setBranchOptions:function(a){},getBranchOptions:function(){},setBranchingComponent:function(a){},handleEvent:function(b,a){},getName:function(){return"ImagePage"},drawYouTubePlayer:function(e){var d=this;var h=d.getMediator(jet.view.mediator.YouTubeMediator.NAME);var f=h.getVideoIndex();var b="player"+f;var a=document.createElement("iframe");this.iFrames.push(a);$(d.contentDiv).append(a);a.id=b;a.width=this.IFRAMEWIDTH;a.height=this.IFRAMEHEIGHT;a.src="https://www.youtube.com/embed/"+e+"?wmode=transparent&rel=0&enablejsapi=1";var i=setInterval(function(){if(h.isYTAvailable()){h.addPlayer(b,e);clearInterval(i)}},2000)},getContentAsResource:function(){return $(this.contentDiv).html()},showIFrames:function(a){for(var b=0;b<this.iFrames.length;b++){if(a){$(this.iFrames[b]).show();$(this.iFrames[b]).css("width",this.IFRAMEWIDTH+"px");$(this.iFrames[b]).css("height",this.IFRAMEHEIGHT+"px")}else{$(this.iFrames[b]).hide();$(this.iFrames[b]).css("width","0px");$(this.iFrames[b]).css("height","0px")}}}},{NAME:"ImagePage"});puremvc.define({name:"jet.view.page.InterviewPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("InterviewPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.mediators[jet.view.mediator.PageMediator.NAME].showMeter()}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].hideMeter()}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:f.branchOptions=d;break;case jet.AppConstants.TEXT:var i=f.getTag(b);if(i=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("interviewerStem");this.questionStem=h}else{if(i.match("distractor.*")){if(h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.enable=f.enable;a.disable=f.disable;a.enable();if(d!=null){this.branchingComponents.push(a);a.setIndexInArray(this.branchingComponents.length-1);a.setComponentLevelBranchOptions(d);a.addContentClass("interviewerDistractor")}}}else{if(i=="points"){this.pointValues.push(h)}}}break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("interviewImage");break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var i=f.getTag(b);if(i=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.branchingComponents.length;a++){this.branchingComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.branchingComponents.length;a++){this.branchingComponents[a].disable()}},processComponents:function(){var a=-1000;for(var b=0;b<this.pointValues.length;b++){var d=parseFloat(this.pointValues[b]);if(d>a){a=d}}this.setTotalPoints(a)},postProcess:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showMeter("Meter",100,100)},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){this.disableInteractivity();this.storeUserFeedback();return this.getHideAnswer()=="false"?correctAnswers:"Submitted"},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){var d=this.page;var a=this;var b=this.contentDiv;a.disable();$(b).hover(function(){$(this).animate({"background-color":"#d7d7d7"},1000,function(){})},function(){$(this).animate({"background-color":"transparent"},1000,function(){})});$(b).removeAttr("disabled","disabled");$(b).bind("click",function(){d.setBranchingComponent(a);d.handleEvent(b,jet.AppConstants.TEXT,"click")})},disable:function(){$(this.contentDiv).unbind("click");$(this.contentDiv).unbind("hover");$(this.contentDiv).attr("disabled","disabled")},getName:function(){return"InterviewPage"},addFeedback:function(b,d){if(this.getHideAnswer()=="false"){var a=document.createElement("div");a.className="feedback";$(this.contentDiv).append(a);this.feedBackComponents.push(a);$(a).css("position","absolute");$(a).css("top",b.getY());$(a).css("left",10);$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}}},{NAME:"InterviewPage"});puremvc.define({name:"jet.view.page.JournalPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="content";$(this.myDiv).addClass("JournalPage");this.printAnchor=document.createElement("a");$(this.printAnchor).addClass("printAnchor");this.printImage=document.createElement("img");this.printImage.src="lib/css/images/icon-print.png";$(this.printImage).addClass("printImage");$(this.printAnchor).append(this.printImage);this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[]}},{printAnchor:null,printImage:null,originalMessage:"",scoreMessage:"",components:null,show:function(a){if(a){$(this.myDiv).show();this.mediators[jet.view.mediator.PageMediator.NAME].requestJournalReport()}else{$(this.myDiv).hide()}},buildComponent:function(d,b,a,e){},handleText:function(a){},processComponents:function(){},processUserResponse:function(d){var e=d.split(/[\n|\r|\r\n]/);var b="";for(var a=0;a<e.length;a++){b+=e[a]+"<br>"}return b},processNotification:function(d,a){switch(d){case jet.AppConstants.REPORT_TO_JOURNAL:var j="";var k=a;for(var f=0;f<k.length;f++){var b=k[f];var h="<h3>"+b.heading+"</h3>";var e=this.processUserResponse(b.response);h+="<p class='reportParagraph'>"+e+"</p>";j+=h}$(this.myDiv).html(j);$(this.myDiv).prepend(this.printAnchor);$(this.printAnchor).on("click",function(){window.print()});break}}},{NAME:"JournalPage"});puremvc.define({name:"jet.view.page.Layout1Page",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("Layout1Page");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.topDiv=document.createElement("div");this.topDiv.className="layout1TopDiv";$(this.contentDiv).append(this.topDiv);this.bottomDiv=document.createElement("div");this.bottomDiv.className="layout1BottomDiv";$(this.contentDiv).append(this.bottomDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,topDiv:null,bottomDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",correctRating:null,additionalInfo:null,userAnswer:null,domainType:null,additionalInfoInput:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var i=f.getTag(b);if(i=="checkedNodeOptions"){f.checkedBranchOptions=d}if(i=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.TEXT:var i=f.getTag(b);if(i.match("dialog_1")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParentAndPosition(f.topDiv,f,"append");f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("layout1Dialog1");a.removeContentClass("text")}}else{if(i.match("dialog_2")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParentAndPosition(f.bottomDiv,f,"prepend");f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("layout1Dialog2");a.removeContentClass("text")}}else{if(i.match("correctRating")){this.correctRating=h.toUpperCase().trim()}else{if(i=="totalpoints"){this.setTotalPoints(h)}}}}break;case jet.AppConstants.COMBO_BOX:var i=f.getTag(b);if(i=="questionTypes"){this.createQuestionType(h)}if(i=="domainTypes"){this.setDomainType(h)}break;case jet.AppConstants.IMAGE:var i=f.getTag(b);if(i=="image_1"){var a=new jet.view.component.ImageComponent;a.setParentAndPosition(f.topDiv,f,"prepend");a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("layout1Image1")}if(i=="image_2"){var a=new jet.view.component.ImageComponent;a.setParentAndPosition(f.bottomDiv,f,"append");a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("layout1Image2")}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var i=f.getTag(b);if(i=="hideAnswer"){f.setHideAnswer(h)}if(i=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break}},getDomainType:function(){return this.domainType},setDomainType:function(a){switch(a.trim()){case"Criminal History":this.domainType="Criminal";break;case"Education/Employment":this.domainType="Education";break;case"Family/Marital":this.domainType="Family";break;case"Leisure/Recreation":this.domainType="Leisure";break;case"Companions":this.domainType="Companions";break;case"Alcohol/Drug Problem":this.domainType="Alcohol";break;case"Procriminal Attitude/Orientation":this.domainType="Procriminal";break;case"Antisocial Pattern":this.domainType="Antisocial";break}},createQuestionType:function(a){switch(a){case ("3-0 Rating"):this.createQPart("3",this.questionDiv);this.createQPart("2",this.questionDiv);this.createQPart("1",this.questionDiv);this.createQPart("0",this.questionDiv);break;case ("Yes No"):this.createQPart("No",this.questionDiv);this.createQPart("Yes",this.questionDiv);break;case ("True False"):this.createQPart("True",this.questionDiv);this.createQPart("False",this.questionDiv);break;default:}$(this.questionDiv).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},createQPart:function(d,e){var a=document.createElement("div");a.className="dialogQuestionPart";$(e).append(a);$(a).html(d);var b=this;$(a).on("click",function(){b.setUserAnswer(d.toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(a).addClass("selected");b.showCheckAnswerButton()})},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var a=this},disableInteractivity:function(){var b=this;var a=b.getContentDiv()},processComponents:function(){},postProcess:function(){},getBranchOptions:function(){return this.branchOptions},setMetrics:function(d,a){if(d!=null){d=d.trim()}else{d="5"}switch(d){case"0":d=1;break;case"1":d=1;break;case"YES":d=1;break;default:d=0}var b=this.getDomainType();a[b]=a[b]+d},evaluateUserActivity:function(){var b=jet.view.page.DialogPage.USER_METRICS;var f=jet.view.page.DialogPage.EXPERT_METRICS;this.disableInteractivity();this.setMetrics(this.userAnswer,b);this.setMetrics(this.correctRating,f);this.sendGraphData(b,f);var i="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.userAnswer!=this.correctRating){i="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}if(this.additionalInfoInput!=null){var h=this.additionalInfoInput.getUserInput().toUpperCase();if(h!=this.additionalInfo.toUpperCase()){i="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}var e=this.domainType+"_"+this.questionStem;var a=this.getIsUserCorrect()?"correct":"incorrect";var d={uid:this.getUID(),questionType:"choice",question:e.substring(0,249),learnerResponse:this.userAnswer,correctResponse:this.correctRating,result:a};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.getUID(),d);return true?i:"Submitted"},sendGraphData:function(o,q){var l=this.scaleData("Criminal",o.Criminal);var f=this.scaleData("Education",o.Education);var m=this.scaleData("Family",o.Family);var p=this.scaleData("Leisure",o.Leisure);var i=this.scaleData("Companions",o.Companions);var u=this.scaleData("Alcohol",o.Alcohol);var b=this.scaleData("Procriminal",o.Procriminal);var a=this.scaleData("Antisocial",o.Antisocial);var t=[[m],[i],[l],[f],[p],[u],[b],[a]];var s=["2=Low, 3=Med, 4=High"];var e=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var j=0;var r=5;var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var d={};d.name="BARGRAPH";d.data=t;d.ticks=s;d.seriesColors=e;d.series=h;d.minValue=j;d.maxValue=r;var k=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);k.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,d);var n={};n.name="LEGEND";n.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];n.seriesColors=e;k.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,n)},storeUserFeedback:function(){},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){},disable:function(){},getName:function(){return"DialogPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setUserAnswer:function(a){this.userAnswer=a},getUserAnswer:function(){return this.userAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},},{NAME:"Layout1Page"});puremvc.define({name:"jet.view.page.LongAnswerPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("LongAnswerPage");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.feedBackComponents=[]}},{branchOptions:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,useRegEx:false,isUserCorrect:null,feedBackComponents:null,isSCORMDATA:false,longAnswerComponent:null,heading:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));var d=page.getMediator(jet.view.mediator.QuestionProcessorMediator.NAME).getUserResponse(this.uid);if(d!=null){this.longAnswerComponent.setUserInput(d)}this.isSCORMDATA=true;this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:f.branchOptions=d;break;case jet.AppConstants.CHECKBOX:if(h.toUpperCase()=="TRUE"){this.useRegEx=true;this.concatenateAnswerKeys()}var i=f.getTag(b);if(i=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break;case jet.AppConstants.TEXT:var i=f.getTag(b);if(i=="totalpoints"){f.setTotalPoints(h)}else{if(i=="expression"){this.splitIntoAnswerKeys(h);var a=new jet.view.component.InputTextComponent;a.setParent(f.myDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);this.userInputComponents.push(a)}else{if(i=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.myDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h)}else{if(i=="longAnswer"){var a=new jet.view.component.TextAreaComponent;this.longAnswerComponent=a;a.setParent(f.myDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);this.userInputComponents.push(a)}else{if(i=="instructions"){var a=new jet.view.component.ViewComponent;a.setParent(f.myDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h)}else{if(i=="heading"){f.heading=h}}}}}}break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(f.myDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break}},handleText:function(a){},splitIntoAnswerKeys:function(d){var a=$.trim(d).split("|");for(var b=0;b<a.length;b++){this.answerKeys.push(a[b])}},concatenateAnswerKeys:function(){if(this.answerKeys.length>1){var b=this.answerKeys[0];for(var a=0;a<this.answerKeys.length;a++){b+="|"+this.answerKeys[a]}this.answerKeys[0]=b}},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},processComponents:function(){},evaluateUserActivity:function(){var b="Sent";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var a={heading:this.heading,response:this.userInputComponents[0].getUserInput()};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserResponse(this.uid,a);return b},getBranchOptions:function(){return this.branchOptions},doesAnswerMatchExpression:function(b){var a=false;$.each(this.answerKeys,function(d,e){if(b.match(e)){a=true}});return a},isAnswerinArray:function(b){var a=false;$.each(this.answerKeys,function(d,e){if($.trim(e.toUpperCase())==$.trim(b.toUpperCase())){a=true}});return a},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("top",d.getY());$(b).css("left",5);var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]}},{NAME:"ShortAnswerPage"});puremvc.define({name:"jet.view.page.MatchingPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("MatchingPage");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.dragComponents=[];this.anchorComponents=[];this.targetComponents=[];this.feedBackComponents=[];this.randomNumbers=[];this.answerKeys=[]}},{tempXPos:0,tempYPos:0,originalAnchorTilePositions:[],originalDragTilePositions:[],targetComponents:[],feedBackComponents:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,isUserCorrect:null,questionStem:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(b,e,d,j,i){var k=b.getTag(d);var f;if(k=="totalpoints"){b.setTotalPoints(j)}else{if(k=="flowstatus"){if(j=="true"){b.setInFlow(false)}}else{if(e==jet.AppConstants.NODES_MANAGER){b.branchOptions=i;if(k=="checkedNodeOptions"){b.checkedBranchOptions=i}if(k=="uncheckedNodeOptions"){b.unCheckedBranchOptions=i}}else{if(e==jet.AppConstants.TEXT&&j.length>0){var h=getProperty(d,"tag");if(h!=null){if(h.tag=="instructions"){f=this.createComponent(b,d,j);this.setQuestionStem(j)}if(h.tag=="draggable"){var a=this.createComponent(b,d,"");a.setWidth(a.getWidth()*1.3);a.addClass("dragTarget");this.targetComponents.push(a);f=this.createComponent(b,d,j);f.addClass("dragTile");this.originalDragTilePositions.push(f.getY());this.dragComponents.push(f);f.makeDraggable(this.dragStart,this.dragStop,this,this.dragComponents.length-1)}if(h.tag=="anchored"){f=this.createComponent(b,d,j);f.addClass("anchorTile");this.originalAnchorTilePositions.push(f.getY());this.anchorComponents.push(f)}}}}}}},postProcess:function(){for(var d=0;d<this.targetComponents.length;d++){var b=this.anchorComponents[d];var f=parseInt(b.getX(),10);var e=parseInt(b.getGutter(),10);var a=parseInt(b.getWidth(),10);this.targetComponents[d].setX(f+a+e);this.targetComponents[d].setY(b.getY())}},handleText:function(a){},createComponent:function(d,b,e){var a=new jet.view.component.AnchorTileComponent;a.setParent(d.myDiv);a.setProperties(b);d.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(e);return a},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){for(var a=0;a<this.dragComponents.length;a++){this.dragComponents[a].enableDraggable();this.dragComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.dragComponents.length;a++){this.dragComponents[a].disableDraggable();this.dragComponents[a].disable()}},evaluateUserActivity:function(){this.disableInteractivity();var f="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var h=this.getTotalPoints()/this.dragComponents.length;for(var d=0;d<this.dragComponents.length;d++){var e=this.dragComponents[d].getIndexInArray();var b=this.anchorComponents[e];if(this.dragComponents[d].getY()!=b.getY()){f="\u2718";this.setIsUserCorrect(false);var a=parseInt((this.getUserPoints()-h)*10)/10;this.setUserPoints(a);this.addFeedback(this.dragComponents[d],false)}else{this.addFeedback(this.dragComponents[d],true)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions}this.storeUserFeedback()}return f},getBranchOptions:function(){return this.branchOptions},processComponents:function(){for(var b=0;b<this.dragComponents.length;b++){this.randomNumbers.push(b)}this.shuffle(this.randomNumbers);if(this.dragComponents.length<=0){return}var j=this.dragComponents[0].getHeight();var h=100;for(var b=0;b<this.dragComponents.length;b++){var e=this.randomNumbers[b];var a=this.dragComponents[e];var d=parseInt($(".viewer").css("width"));var f=480;a.setX(f);a.setInitialX(f);a.setY(30);a.setInitialY(b*j+h);a.setZindex(10+b)}},shuffle:function(b){for(var d,a,e=b.length;e;d=parseInt(Math.random()*e),a=b[--e],b[e]=b[d],b[d]=a){}},dragStart:function(a){},dragStop:function(k,l){this.showCheckAnswerButton();var j=parseInt($(k).css("top"),10);for(var h=0,b=10000,p=0;h<this.anchorComponents.length;h++){var e=Math.abs(j-this.anchorComponents[h].getY());if(e<b){b=e;p=h}}var d=this.anchorComponents[p];var m=this.dragComponents[l];var n=parseInt(d.getX(),10);var a=parseInt(d.getWidth(),10);var f=parseInt(d.getGutter(),10);var o=Math.abs(n+a-m.getX());if(o<m.getWidth()){m.setY(d.getY());m.setX(n+a+f)}else{m.animatePosition(m.getInitialX(),m.getInitialY(),1000)}},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("top",d.getY());$(b).css("left",5);var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},},{NAME:"MatchingPage"});puremvc.define({name:"jet.view.page.MenuPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("MenuPage");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.branchingComponents=[]}},{answerKeys:null,components:null,userInputComponents:null,branchOptions:null,branchingComponents:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.TEXT:var i=f.getTag(b);var a=new jet.view.component.ViewComponent;a.setParent(f.myDiv,f);if(i=="stem"){$(a.contentDiv).addClass("instructionsContent")}if(i=="index"){$(a.contentDiv).hide()}else{if(h.length>0){a.enable=this.enableText;a.enable();a.addContentClass("menutext")}}f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);if(d!=null){this.branchingComponents.push(a);a.setIndexInArray(this.branchingComponents.length-1);a.setComponentLevelBranchOptions(d)}break;case jet.AppConstants.IMAGE:if(h.length<1){return}var a=new jet.view.component.ImageComponent;a.setParent(f.myDiv,f);a.enable=this.enable;a.enable();a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("menu");this.userInputComponents.push(a);a.setIndexInArray(this.userInputComponents.length-1);break;case jet.AppConstants.CHECKBOX:var i=f.getTag(b);if(i=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break}},handleText:function(a){},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){},setBranchOptions:function(a){this.branchOptions=a},getBranchOptions:function(){return this.branchOptions},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a)},handleEvent:function(b,a){if(b==jet.AppConstants.IMAGE){switch(a){case"click":this.mediators[jet.view.mediator.PageMediator.NAME].processFeedbackAndBranchingOptions(this,true,null);break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":this.mediators[jet.view.mediator.PageMediator.NAME].processFeedbackAndBranchingOptions(this,true,null);break}}},getName:function(){return"QuestionPage"},enable:function(){var b=this.page;var a=this;this.disable();$(this.contentDiv).removeAttr("disabled","disabled");$(this.contentDiv).bind("click",function(){b.setBranchingComponent(a);b.handleEvent(jet.AppConstants.IMAGE,"click")});$(this.contentDiv).css("cursor","pointer");$(this.contentDiv).bind("hover",function(){$(this).stop().animate({opacity:".5"},"slow")});$(this.contentDiv).bind("mousedown",function(){$(this).css("border-style","solid");$(this).css("border-width","1px")});$(this.contentDiv).bind("mouseout",function(){$(this).css("border-style","none");$(this).css("border-width","0px");$(this).stop().animate({opacity:"1"},"slow")})},enableText:function(){var b=this.page;var a=this;this.disable();$(this.contentDiv).removeAttr("disabled","disabled");$(this.contentDiv).bind("click",function(){b.setBranchOptions(a.getComponentLevelBranchOptions());b.handleEvent(jet.AppConstants.TEXT,"click")});$(this.contentDiv).css("cursor","pointer");$(this.contentDiv).bind("hover",function(){$(this).stop().animate({"background-color":"beige"},"slow")});$(this.contentDiv).bind("mousedown",function(){$(this).css("border-style","solid");$(this).css("border-width","1px")});$(this.contentDiv).bind("mouseout",function(){$(this).css("border-style","none");$(this).css("border-width","0px");$(this).stop().animate({"background-color":"transparent"},"slow")})}},{NAME:"MenuPage"});puremvc.define({name:"jet.view.page.OpenQuestionPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("OpenQuestionPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:"false",executedSetCustomScore:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){$(".jp-jplayer").jPlayer("clearMedia");b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,l,h,o,n){switch(l){case jet.AppConstants.NODES_MANAGER:f.branchOptions=n;break;case jet.AppConstants.TEXT:var p=f.getTag(h);if(p=="totalpoints"){f.setTotalPoints(o)}else{if(p=="textBlock"&&o.length>0){var m=new jet.view.component.ViewComponent;f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(m,h);var e=/(<body.*>)([\D|\d]*)(<\/body>)/ig;var b=e.exec(o);var d=b[2];if(d==""){d=b[1]}var k=d;var j=k.split("&lt;s&gt;");for(var a=0;a<j.length;a++){if(j[a]!=null&&j[a]!=undefined){this.processQuestionComponent(j[a])}}}}break;case jet.AppConstants.CHECKBOX:var p=f.getTag(h);if(p=="hideAnswer"){f.setHideAnswer(o)}if(p=="flowstatus"){if(o=="true"){f.setInFlow(false)}}break;case jet.AppConstants.AUDIO:if(o.length<1){return}var m=new jet.view.component.AudioComponent;m.setMediaURL(o);m.setAudioOptions(n);m.setParent(this.myDiv);m.setProperties(h);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(m,h);this.components.push(m);break}},processQuestionComponent:function(l){var k=new jet.view.component.OpenQuestionComponent;this.components.push(k);k.setContentClass("qitem");k.setParent(this.contentDiv,this);var j=l.split("&lt;d&gt;");if(j!=null){k.addQuestionStem(j[0]);for(var d=1;d<j.length;d++){if(j[d]==null|j[d]==undefined){continue}var b="false";var a=/(\*)/;var f=j[d];if(a.test(f)){b="true"}var e=/\*/;var h=f.replace(e,"");k.addDistractor(h,b)}}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100},getBranchOptions:function(){return this.branchOptions},calculateNumberOfCorrectAnswers:function(){var a=0;for(var b=0;b<this.answerKeys.length;b++){if(this.answerKeys[b]=="true"){a++}}return a},evaluateUserActivity:function(){this.disableInteractivity();var e="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var f=this.getTotalPoints()/this.calculateNumberOfCorrectAnswers();for(var d=0;d<this.userInputComponents.length&&d<this.answerKeys.length;d++){if(this.userInputComponents[d].getUserInput()!=this.answerKeys[d]){e="\u2718";this.setIsUserCorrect(false);var b=parseInt((this.getUserPoints()-f)*10)/10;this.setUserPoints(b);var a="\u2718";if(this.answerKeys[d]=="true"){a="\u25BA"}this.addFeedback(this.userInputComponents[d],a)}if(this.userInputComponents[d].getUserInput()==this.answerKeys[d]&&this.userInputComponents[d].getUserInput()=="true"){this.addFeedback(this.userInputComponents[d],"\u2713")}}return this.getHideAnswer()=="false"?e:"Submitted"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(a){},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(d,e){if(this.getHideAnswer()=="false"){var b=document.createElement("div");b.className="feedback";var a=$(d.getDiv());$(a).prepend(b);this.feedBackComponents.push(b);$(b).css("position","relative");$(b).css("float","left");$(b).css("top","0px");$(b).html(e)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){for(var a=0;a<this.components.length;a++){if(this.components[a].initialize){this.components[a].initialize()}}return $(this.contentDiv).html()},getContentAsResource:function(){for(var a=0;a<this.components.length;a++){if(this.components[a].initialize){this.components[a].initialize()}}return $(this.contentDiv).html()}},{NAME:"OpenQuestionPage"});puremvc.define({name:"jet.view.page.OrganizerPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="organizerPage";this.myDiv.id=a;this.instructionsDiv=document.createElement("div");this.instructionsDiv.className="instructions";$(this.instructionsDiv).css("width","75%");$(this.instructionsDiv).css("padding","10px");$(this.instructionsDiv).css("margin-left","10%");$(this.instructionsDiv).css("margin-right","10%");$(this.instructionsDiv).css("margin-bottom","20px");$(this.myDiv).append(this.instructionsDiv);this.contentDiv=document.createElement("div");this.contentDiv.className="organizerContent";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.textArray=[];this.tileDivArray=[];this.rowArray={row1:[],row2:[],row3:[],row4:[],row5:[],row6:[],row7:[],row8:[],row9:[],row10:[],};this.dropArea=document.createElement("div");this.dropArea.className="dropDiv";this.divRow1=document.createElement("div");this.divRow1.className="divRow";this.divRow1.id="Row1";this.divRow2=document.createElement("div");this.divRow2.className="divRow";this.divRow2.id="Row2";this.divRow3=document.createElement("div");this.divRow3.className="divRow";this.divRow3.id="Row3";this.divRow4=document.createElement("div");this.divRow4.className="divRow";this.divRow4.id="Row4";this.divRow5=document.createElement("div");this.divRow5.className="divRow";this.divRow5.id="Row5";this.divRow6=document.createElement("div");this.divRow6.className="divRow";this.divRow6.id="Row6";this.divRow7=document.createElement("div");this.divRow7.className="divRow";this.divRow7.id="Row7";this.divRow8=document.createElement("div");this.divRow8.className="divRow";this.divRow8.id="Row8";this.divRow9=document.createElement("div");this.divRow9.className="divRow";this.divRow9.id="Row9";this.divRow10=document.createElement("div");this.divRow10.className="divRow";this.divRow10.id="Row10";$(this.contentDiv).append(this.divRow1);$(this.contentDiv).append(this.divRow2);$(this.contentDiv).append(this.divRow3);$(this.contentDiv).append(this.divRow4);$(this.contentDiv).append(this.divRow5);$(this.contentDiv).append(this.divRow6);$(this.contentDiv).append(this.divRow7);$(this.contentDiv).append(this.divRow8);$(this.contentDiv).append(this.divRow9);$(this.contentDiv).append(this.divRow10)}},{rowHeight:40,initialLeft:700,mediator:null,xml:null,uid:null,components:null,arrayT:null,arrayI:null,arrayO:null,textArray:null,tileDivArray:null,rowArray:null,concatenatedArray:null,backgroundTile:null,instructionsDiv:null,branchOptions:{checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null},show:function(a){if(a){$(this.myDiv).show();this.getMediator(jet.view.mediator.PageMediator.NAME).reportUserActivity(this,this.uid)}else{$(this.myDiv).hide()}},showCheckAnswerButton:function(){this.getMediator(jet.view.mediator.PageMediator.NAME).showCheckAnswerButton()},buildComponent:function(f,d,a,h,b){if(d==jet.AppConstants.DATA_INPUT&&h.length>0){var e=f.processXML(h);this.xml=h}if(d==jet.AppConstants.TEXT&&h.length>0){var i=f.getTag(a);if(i=="totalpoints"){f.setTotalPoints(h)}if(i=="instructions"){$(this.instructionsDiv).text(h)}}if(d==jet.AppConstants.IMAGE){this.backgroundTile=h;$(this.myDiv).css("background-image","url(base/"+h+")")}},processXML:function(j){this.xml=j;xmlDoc=$.parseXML(j);var f=$(xmlDoc).find("dataPage");for(var e=0;e<f.length;e++){var d=f[e];var m=$(d).find("Text")[0].textContent.trim();var b=$(d).find("Optional_Image")[0].textContent.trim();if(b!=""){m=b}var o=$(d).find("Row")[0].textContent.trim();var k=$(d).find("Position")[0].textContent.trim();var h=$(d).find("Italic")[0].textContent.trim();var n=$(d).find("Pinned")[0].textContent.trim();var a=$(d).find("OptionalWidth")[0].textContent.trim();var l={Text:m,Row:o,Position:k,Italic:h,Pinned:n,OptionalWidth:a};this.textArray.push(l)}this.renderTiles();this.pinTiles()},rowNumber:function(){var a=$(".rowNumber");a.attr("type","number");a.children().each(function(b,d){$(d).text((b+1)+". "+$(d).text())})},getTilesDiv:function(){return this.tilesDiv},getDropDiv:function(){return this.dropDiv},renderTiles:function(){var n=this;var a=this.getMediator(jet.view.mediator.PageMediator.NAME);var b=this.calcNumberOfUnpinnedTiles();var f=this.generateRandom(b);var l=0;var k=parseInt($(".viewer").css("height"));var d=f.length*(this.rowHeight*2+10)<k?this.rowHeight*2:(k-100)/f.length;for(var h=0;h<this.textArray.length;h++){var e=this.textArray[h];var j=document.createElement("div");this.tileDivArray.push(j);$(this.contentDiv).append(j);$(j).height(this.rowHeight);$(j).data("Text",e.Text);$(j).data("Row",e.Row);$(j).data("Position",e.Position);var q=this.isTileDataPinned(e.Pinned);$(j).data("Pinned",q);$(j).data("OptionalWidth",e.OptionalWidth);if(e.OptionalWidth.length>0){$(j).css("width",e.OptionalWidth+"px")}if(e.Pinned.length<1){var m=f[l]*d;$(j).css("top",m+"px");var o=100-(parseInt(m/k*100));$(j).css("z-index",10+o);$(j).addClass("initialState");l++}else{$(j).addClass("Pinned")}$(j).css("position","absolute");$(j).css("left",this.initialLeft+"px");this.prepareTileHTML(j,e.Text);$(j).addClass("OrganizerTileDiv");if(e.Italic.toUpperCase()=="YES"){$(j).addClass("ItalicOrganizerTileDiv")}var p=this.rowHeight;$(j).draggable({start:function(){$(this).removeClass("tileInPosition");$(this).removeClass("initialState");$(this).css("opacity","0.5")},stop:function(){var i=parseInt($(this).css("top"));var r=parseInt(i/p);var s=r*p+p;var t=s-i;var i=t>p/2?r*p:r*p+p;$(this).css("top",i+"px");$(this).addClass("tileInPosition");$(this).css("opacity","1");n.showCheckAnswerButton()}})}},prepareTileHTML:function(d,f){if(f.toUpperCase().indexOf("JPG")>0||f.toUpperCase().indexOf("PNG")>0||f.toUpperCase().indexOf("JPEG")>0){var b="<img src = 'base/"+f+"'/>";$(d).html(b);var a=150;var h=parseInt($(d).css("width"));var e=Math.max(parseInt((h-a)/2),0);e=e+"px";$(d).css("margin-left",e);$(d).css("margin-right",e);$(d).removeAttr("height").removeAttr("width");$(d).css("height","").css("width","")}else{$(d).html(f)}},pinTiles:function(){for(var e=0;e<this.tileDivArray.length;e++){var d=this.tileDivArray[e];var b=$(d).data("Pinned");var j=$(d).data("Row");var a=$(d).data("Position");if(b.length<1){continue}var h=this.getXPositionInRow(j,a);var f=this.rowHeight*(j-1);$(d).css("left",h+"px");$(d).css("top",f+"px");$(d).draggable("disable")}},calcNumberOfUnpinnedTiles:function(){var b=0;for(var a=0;a<this.textArray.length;a++){var d=this.textArray[a];if(d.Pinned.length>0){continue}b++}return b},isTileDataPinned:function(a){if(a.length<1){return""}if(a.toUpperCase().contains("NO")){return""}return"yes"},getXPositionInRow:function(p,l){var o="row"+p;var n=this.tileDivArray;var j=0;for(var h=0;h<n.length;h++){var m=n[h];var k=$(m).data("Row");var f=$(m).data("Position");if(p!=k||f>=l){continue}var b=parseInt($(m).width());var d=parseInt($(m).css("margin-left"));var e=parseInt($(m).css("margin-right"));var a=b+d+e;j+=a}return j},getRowXRange:function(h,b,f){var a={lowX:-1,highX:-1};var i=b-1;var e=this.rowArray["row"+h];if(e.length>i){var d=e[i];a.lowX=this.getXPositionInRow(1,b)}if(e.length>i+1){var d=e[i+1];a.highX=this.getXPositionInRow(1,b+1)}return a},generateRandom:function(b){var a=new Array(b);for(var e=0;e<b;e++){a[e]=e}for(var e=b-1;e>0;e--){var h=Math.random()*(b-1);var f=Math.round(h);var d=a[e];a[e]=a[f];a[f]=d}return a},getNumberOfTexts:function(){var a=0;for(text in this.tiles){a++}return a},resetRowArrays:function(){this.rowArray={row1:[],row2:[],row3:[],row4:[],row5:[],row6:[],row7:[],row8:[],row9:[],row10:[]}},placeInArray:function(e,f){var b=parseInt($(e).css("left"));for(var d=0;d<f.length;d++){var a=parseInt($(f[d]).css("left"));if(b<a){f.splice(d,0,e);return}}f.push(e)},concatenateArrays:function(){this.concatenatedArray=[];for(var b in this.rowArray){var d=this.rowArray[b];for(var a=0;a<d.length;a++){this.concatenatedArray.push(d[a])}}},evaluateUserActivity:function(){this.disableInteractivity();var a=this.rowHeight;var n=this.tileDivArray;var j=this.getTotalPoints();var b=n.length;ratio=j/b;var d=this.calculateFirstRow(n);for(var f=0;f<n.length;f++){var k=n[f];var m=parseInt($(k).css("top"));switch(m){case d:this.placeInArray(k,this.rowArray.row1);break;case d+1*a:this.placeInArray(k,this.rowArray.row2);break;case d+2*a:this.placeInArray(k,this.rowArray.row3);break;case d+3*a:this.placeInArray(k,this.rowArray.row4);break;case d+4*a:this.placeInArray(k,this.rowArray.row5);break;case d+5*a:this.placeInArray(k,this.rowArray.row6);break;case d+6*a:this.placeInArray(k,this.rowArray.row7);break;case d+7*a:this.placeInArray(k,this.rowArray.row8);break;case d+8*a:this.placeInArray(k,this.rowArray.row9);break;case d+9*a:this.placeInArray(k,this.rowArray.row10);break}}this.concatenateArrays();var p=1;for(var l in this.rowArray){this.evaluateArray(this.rowArray[l],p,ratio);p++}var h="\u2713";var e="\u2718";var o=this.getUserPoints();if(o>0.99*this.getTotalPoints()){this.setUserPoints(Math.ceil(this.getUserPoints()))}return j==this.getUserPoints()?h:e},calculateFirstRow:function(a){var f=500;for(var d=0;d<a.length;d++){var e=a[d];var b=parseInt($(e).css("top"));var h=parseInt($(e).css("left"));if(b<f&&h<this.initialLeft){f=b}}return f},evaluateArray:function(k,b,n){var j=this.getUserPoints();for(var e=0;e<k.length;e++){var l=k[e];var h=$(l).data("Position");var r=$(l).data("Row");var d=$(l).data("Pinned").length>0?"":"</br>\u2713";var o=2;if(($.isNumeric(h)||this.isWild(h))&&($.isNumeric(r)||this.isWild(r))){o=2}else{if($.isNumeric(h)){o=1}else{o=0}}switch(o){case 0:if(b!=r){$(l).append("</br>\u2718")}else{j+=n}if(b==r){$(l).append(d)}break;case 1:var q=this.concatenatedArray[h-1];if(l!==q){$(l).append("</br>\u2718")}else{j+=n}if(l===q){$(l).append(d)}break;case 2:var p=$(l).text();var a=this.getRowXRange("1",h,p);var f=parseInt($(l).css("left"));var m=this.isCorrectPosition(r,h,e,k[e],a,f,p,this.isWild(r));if((b!=r&&!this.isWild(r))||(!m&&!this.isWild(h))){$(l).append("</br>\u2718")}else{j+=n;$(l).append(d)}break}this.setUserPoints(j)}},isCorrectPosition:function(l,f,h,i,a,d,k,b){var e=false;var j=0.9;if(!b){if(f!=h+1){e=false}else{e=true}}else{if(a.lowX>-1&&a.highX>-1){type=2}else{if(a.lowX>1){type=1}else{type=0}}switch(type){case 0:e=false;break;case 1:if(d>=(a.lowX*j)){e=true}break;case 2:if(d>=(a.lowX*j)&&d<a.highX*j){e=true}break}}return e},isWild:function(a){return a=="*"?true:false},enableInteractivity:function(){this.resetRowArrays();var a=this.tileDivArray;for(var b=0;b<a.length;b++){var d=a[b];$(d).draggable("enable");var e=$(d).data("Text");$(d).empty();this.prepareTileHTML(d,e)}},disableInteractivity:function(){var a=this.tileDivArray;for(var b=0;b<a.length;b++){var d=a[b];$(d).draggable("disable")}},processComponents:function(){},postProcess:function(){}},{NAME:"OrganizerPage"});puremvc.define({name:"jet.view.page.QuestionPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("QuestionPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.distractorComponents=[];this.hideAnswer=false;this.executedSetCustomScore={};this.questionStem="";this.questionTextBlock="";this.branchingOptionArray=new Array(10);this.tempArray=[];this.isMultipleChoice="false"}},{stemComponent:null,textBlockComponent:null,imageComponent:null,audioComponent:null,doInstructionsExist:false,stemYOffset:0,questionStem:null,questionTextBlock:null,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,branchOptionArray:null,randomStatus:null,tempArray:null,isMultipleChoice:"false",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){$(".jp-jplayer").jPlayer("clearMedia");b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components);if(typeof MathJax!=="undefined"&&MathJax.Hub){MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.contentDiv])}}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(h,f,d,i,e){switch(f){case jet.AppConstants.NODES_MANAGER:var j=h.getTag(d);if(j=="checkedNodeOptions"){h.checkedBranchOptions=e}if(j=="uncheckedNodeOptions"){h.unCheckedBranchOptions=e}break;case jet.AppConstants.TEXT:var j=h.getTag(d);if(j=="totalpoints"){h.setTotalPoints(i)}else{if(j=="textBlock"&&i.length>0){this.textBlockComponent=new jet.view.component.ViewComponent;this.textBlockComponent.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.textBlockComponent,d);this.textBlockComponent.setText(i);$(this.myDiv).addClass("LayoutB");h.setQuestionTextBlock(i)}if(j=="stem"){this.stemComponent=new jet.view.component.ViewComponent;this.stemComponent.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.stemComponent,d);this.stemComponent.setText(i);this.stemComponent.addContentClass("stem");h.setQuestionStem(i)}else{if(j.match("distractor.*")){var b=new jet.view.component.ViewComponent;b.setParent(h.contentDiv);this.distractorComponents.push(b);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(b,d);b.setText(i);b.addContentClass("distractor");b.addContentClass(j);if(e!=null){this.branchingComponents.push(b);b.setIndexInArray(this.branchingComponents.length-1);b.setComponentLevelBranchOptions(e)}}}}break;case jet.AppConstants.CHECKBOX:var j=h.getTag(d);if(j=="hideAnswer"){h.setHideAnswer(i)}else{if(j=="flowstatus"){if(i=="true"){h.setInFlow("false")}}else{if(j=="randomstatus"){if(i=="true"){h.setRandomStatus("true")}}else{if(j=="MC"){if(i=="true"){h.setIsMultipleChoice("true")}}else{var a={type:f,text:i,properties:d,tag:j};this.tempArray.push(a)}}}}break;case jet.AppConstants.IMAGE:this.imageComponent=new jet.view.component.ImageComponent;this.imageComponent.setParent(h.contentDiv);this.imageComponent.setProperties(d);this.imageComponent.addClass("questionImage");h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.imageComponent,d);this.imageComponent.setText(i);break;case jet.AppConstants.AUDIO:if(i.length<1){return}this.audioComponent=new jet.view.component.AudioComponent;this.audioComponent.setMediaURL(i);this.audioComponent.setAudioOptions(e);this.audioComponent.setParent(h.myDiv);this.audioComponent.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.audioComponent,d);this.components.push(this.audioComponent);break}},handleText:function(a){},setIsMultipleChoice:function(a){this.isMultipleChoice=a},getIsMultipleChoice:function(){return this.isMultipleChoice},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}this.prepareQuestion()},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},makeAnswerComponents:function(){var b=this.getIsMultipleChoice();for(var e=0;e<this.tempArray.length;e++){var f=this.tempArray[e];var d=b=="false"?new jet.view.component.CheckBoxComponent:new jet.view.component.RadioButtonComponent;d.setParent(this.contentDiv,this);this.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(d,f.properties);this.answerKeys.push($.trim(f.text));this.userInputComponents.push(d);d.setIndexInArray(this.userInputComponents.length-1);d.addContentClass(f.tag);var a=document.createElement("div");a.className="feedback";this.feedBackComponents.push(a)}},processComponents:function(){this.makeAnswerComponents();for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100;this.prepareQuestion()},prepareQuestion:function(){var e=[];$(this.contentDiv).empty();if(this.audioComponent!=undefined&&this.audioComponent!=null){this.audioComponent.setParent(this.myDiv)}if(this.textBlockComponent!=undefined&&this.textBlockComponent!=null){$(this.textBlockComponent.getContentDiv()).removeAttr("style");$(this.textBlockComponent.getContentDiv()).css("position","static");$(this.textBlockComponent.getContentDiv()).css("margin-bottom","0px");$(this.textBlockComponent.getContentDiv()).css("margin-top","10px");$(this.textBlockComponent.getContentDiv()).css("height","155px");this.textBlockComponent.setParent(this.contentDiv)}if(this.imageComponent!=undefined&&this.imageComponent!=null){$(this.imageComponent.getContentDiv()).removeAttr("style");$(this.imageComponent.getContentDiv()).css("position","static");$(this.imageComponent.getContentDiv()).css("margin-bottom","0px");$(this.imageComponent.getContentDiv()).css("margin-top","10px");$(this.imageComponent.getContentDiv()).css("height","240px");this.imageComponent.setParent(this.contentDiv)}$(this.stemComponent.getContentDiv()).removeAttr("style");$(this.stemComponent.getContentDiv()).css("position","static");$(this.stemComponent.getContentDiv()).css("margin-bottom","20px");$(this.stemComponent.getContentDiv()).css("margin-top","20px");this.stemComponent.setParent(this.contentDiv);for(var f=0;f<this.userInputComponents.length;f++){e.push(f)}if(this.randomStatus=="true"){for(var f=e.length-1;f>0;f--){var l=e[f];var j=parseInt(Math.random()*(f+1));e[f]=e[j];e[j]=l}}for(var f=0;f<this.userInputComponents.length;f++){var h=e[f];var n=this.distractorComponents[h];var b=n.getText();if(b==null||b==undefined||b.length<1){continue}var m=document.createElement("div");$(this.contentDiv).append(m);m.className="distractorHost";$(m).removeAttr("style");$(m).css("position","static");$(m).css("margin-top","10px");$(m).css("margin-bottom","40px");$(m).css("display","block");var a=this.feedBackComponents[h];$(m).append(a);$(a).css("height","10px");$(a).css("width","10px");var k=this.userInputComponents[h];k.removeFromParent();$(k.getContentDiv()).removeAttr("style");k.setParent(m,this);$(k.getContentDiv()).css("margin-right","20px");$(k.getContentDiv()).css("margin-left","50px");var d=this.distractorComponents[h];d.removeFromParent();$(d.getContentDiv()).removeAttr("style");d.setParent(m,this);$(".componentX").remove()}},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){var m="";this.disableInteractivity();var a="";var d="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());for(var h=0;h<this.userInputComponents.length&&h<this.answerKeys.length;h++){if(this.userInputComponents[h].getUserInput()=="true"){var l=this.distractorComponents[h];a+=l.getText()+"; ";if(this.branchingOptionArray[h]&&this.branchingOptionArray[h].feedback){m+=this.branchingOptionArray[h].feedback+"<br />"}}if(this.userInputComponents[h].getUserInput()!=this.answerKeys[h]){d="\u2718";this.setIsUserCorrect(false);var b="\u2718";if(this.answerKeys[h]=="true"){b="\u25BA"}this.addFeedback(h,b);this.setUserPoints(0)}if(this.userInputComponents[h].getUserInput()==this.answerKeys[h]&&this.userInputComponents[h].getUserInput()=="true"){this.addFeedback(h,"\u2713")}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){m=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){m=this.branchOptions.feedback}}this.storeUserFeedback()}if(this.branchOptions&&this.branchOptions.feedback){this.branchOptions.feedback=m}var f=this.questionStem;var n=this.getIsUserCorrect()?"correct":"incorrect";var k="";for(var j=0;j<this.answerKeys.length;j++){if(this.answerKeys[j]=="true"){k+=this.distractorComponents[j].getText()+"; "}}var e={uid:this.getUID(),questionType:"choice",question:f.substring(0,249),learnerResponse:a,correctResponse:k,result:n};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.getUID(),e);return this.getHideAnswer()=="false"?d:"Submitted"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();this.branchingOptionArray[b]=a;if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(b,d){var a=this.feedBackComponents[b];if(this.getHideAnswer()=="false"){$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).html("")}},clearBranchOptions:function(){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};this.setBranchOptions(a)},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setQuestionTextBlock:function(a){this.questionTextBlock=a},getQuestionTextBlock:function(){return this.questionTextBlock},setRandomStatus:function(a){this.randomStatus=a},getRandomStatus:function(){return this.randomStatus},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){return $(this.contentDiv).html()},},{NAME:"QuestionPage"});puremvc.define({name:"jet.view.page.RCCCDialogPageType1",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("DialogPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.questionContainerDiv=document.createElement("div");this.questionContainerDiv.className="dialogQuestionContainer";$(this.myDiv).append(this.questionContainerDiv);this.questionDiv=document.createElement("div");this.questionDiv.className="dialogQuestion";$(this.questionContainerDiv).append(this.questionDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{pageID:null,doInstructionsExist:false,stemYOffset:0,contentDiv:null,questionDiv:null,questionContainerDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",correctRating:null,additionalInfo:null,userAnswer:null,domainType:null,additionalInfoInput:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{this.initGadgets();b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var i=f.getTag(b);if(i=="checkedNodeOptions"){f.checkedBranchOptions=d}if(i=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.TEXT:var i=f.getTag(b);if(i=="index"){this.pageID=h}if(i=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.questionContainerDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialogStem");this.questionStem=h}else{if(i.match("dialog1")){if(h&&h.length>0){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog1")}}else{if(i.match("dialog2")){if(h&&h.length>0){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog2")}}else{if(i.match("correctRating")){this.correctRating=h.toUpperCase().trim()}else{if(i.match("additionalInfo")){this.additionalInfo=h.toUpperCase().trim();if(this.additionalInfo.length>0){this.additionalInfoInput=new jet.view.component.InputTextComponent;this.additionalInfoInput.setParent(f.questionContainerDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.additionalInfoInput,b);this.additionalInfoInput.setText("");this.additionalInfoInput.addClass("additionalInfoInput")}}else{if(i=="totalpoints"){this.setTotalPoints(h)}}}}}}break;case jet.AppConstants.COMBO_BOX:var i=f.getTag(b);if(i=="questionTypes"){this.createQuestionType(h)}if(i=="domainTypes"){this.setDomainType(h)}break;case jet.AppConstants.IMAGE:var i=f.getTag(b);if(i=="character1"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character1")}if(i=="character2"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character2")}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var i=f.getTag(b);if(i=="hideAnswer"){f.setHideAnswer(h)}if(i=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break}},getDomainType:function(){return this.domainType},setDomainType:function(a){switch(a.trim()){case"Criminal History":this.domainType="Criminal";break;case"Education/Employment":this.domainType="Education";break;case"Family/Marital":this.domainType="Family";break;case"Leisure/Recreation":this.domainType="Leisure";break;case"Companions":this.domainType="Companions";break;case"Alcohol/Drug Problem":this.domainType="Alcohol";break;case"Procriminal Attitude/Orientation":this.domainType="Procriminal";break;case"Antisocial Pattern":this.domainType="Antisocial";break}},createQuestionType:function(a){switch(a){case ("3-0 Rating"):this.createQPart("3",this.questionDiv);this.createQPart("2",this.questionDiv);this.createQPart("1",this.questionDiv);this.createQPart("0",this.questionDiv);break;case ("Yes No"):this.createQPart("No",this.questionDiv);this.createQPart("Yes",this.questionDiv);break;case ("True False"):this.createQPart("True",this.questionDiv);this.createQPart("False",this.questionDiv);break;default:}$(this.questionDiv).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},createQPart:function(d,e){var a=document.createElement("div");a.className="dialogQuestionPart";$(e).append(a);$(a).html(d);var b=this;$(a).on("click",function(){b.setUserAnswer(d.toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(a).addClass("selected");b.showCheckAnswerButton()})},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var a=this;$(this.questionContainerDiv).find(".dialogQuestionPart").on("click",function(){a.setUserAnswer($(this).text().toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(this).addClass("selected");a.showCheckAnswerButton()});if(this.additionalInfoInput!=null){this.additionalInfoInput.enable()}},disableInteractivity:function(){var b=this;var a=b.getContentDiv();$(this.questionContainerDiv).find(".dialogQuestionPart").unbind("click");if(this.additionalInfoInput!=null){this.additionalInfoInput.disable()}},processComponents:function(){},postProcess:function(){},getBranchOptions:function(){return this.branchOptions},setMetrics:function(d,a){if(d!=null){d=d.trim()}else{d="5"}switch(d){case"0":d=1;break;case"1":d=1;break;case"YES":d=1;break;default:d=0}var b=this.getDomainType();a[b]=a[b]+d},evaluateUserActivity:function(){var a=jet.view.page.RCCCDialogPageType1.USER_METRICS;var m=jet.view.page.RCCCDialogPageType1.EXPERT_METRICS;this.disableInteractivity();this.setMetrics(this.userAnswer,a);this.setMetrics(this.correctRating,m);this.sendGraphData(a,m);var b="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.userAnswer==null){this.userAnswer=""}var l=this.getNormalizedAnswer(this.userAnswer);var k=this.getNormalizedAnswer(this.correctRating);if(l!=k){b="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}if(this.additionalInfoInput!=null&&this.isUserCorrect){var f=this.additionalInfoInput.getUserInput().toUpperCase();var j=this.additionalInfo.toUpperCase().split("|");for(var h=0;h<j.length;h++){if(f!=j[h]){b="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}else{b="\u2713";this.setIsUserCorrect(true);break}}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}var e=this.domainType+"_"+this.questionStem;var n=this.getIsUserCorrect()?"correct":"incorrect";var d={uid:this.uid,questionType:"choice",question:e.substring(0,249),learnerResponse:this.userAnswer,correctResponse:this.correctRating,result:n};jet.view.page.RCCCDialogPageType1.USER_RESPONSES.push(d);this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.uid,d);return true?b:"Submitted"},getNormalizedAnswer:function(a){switch(a.trim()){case"0":return"0";case"1":return"0";case"2":return"2";case"3":return"2";default:return a.trim()}},sendGraphData:function(o,q){var l=this.scaleData("Criminal",o.Criminal);var f=this.scaleData("Education",o.Education);var m=this.scaleData("Family",o.Family);var p=this.scaleData("Leisure",o.Leisure);var i=this.scaleData("Companions",o.Companions);var u=this.scaleData("Alcohol",o.Alcohol);var b=this.scaleData("Procriminal",o.Procriminal);var a=this.scaleData("Antisocial",o.Antisocial);var t=[[m],[i],[l],[f],[p],[u],[b],[a]];var s=["2=Low, 3=Med, 4=High"];var e=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var j=0;var r=5;var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var d={};d.name="BARGRAPH";d.data=t;d.ticks=s;d.seriesColors=e;d.series=h;d.minValue=j;d.maxValue=r;var k=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);k.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,d);var n={};n.name="LEGEND";n.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];n.seriesColors=e;k.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,n)},storeUserFeedback:function(){},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){},disable:function(){},getName:function(){return"DialogPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setUserAnswer:function(a){this.userAnswer=a},getUserAnswer:function(){return this.userAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},initGadgets:function(){if(jet.view.page.RCCCDialogPageType1.INIT_GADGETS){return}jet.view.page.RCCCDialogPageType1.INIT_GADGETS=true;var j=1;var l=2;var f=1;var d=5;var n=1;var a=3;var p=1;var k=1;var i=[[f],[n],[j],[l],[d],[a],[p],[k]];var o=["2=Low, 3=Med, 4=High"];var b=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var e={};e.name="BARGRAPH";e.data=i;e.ticks=o;e.seriesColors=b;e.series=h;var q=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);q.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,e);var m={};m.name="LEGEND";m.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];m.seriesColors=b;q.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,m)},scaleData:function(b,a){switch(b){case"Criminal":case"Education":switch(a){case 0:return 0;case 1:return 1;case 2:case 3:return 2;case 4:case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5}break;case"Family":case"Companions":case"Procriminal":case"Antisocial":switch(a){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5}break;case"Leisure":switch(a){case 0:return 0;case 1:return 3;case 2:return 4}break;case"Alcohol":switch(a){case 0:return 0;case 1:case 2:return 2;case 3:case 4:return 3;case 5:case 6:return 4;case 7:case 8:return 5}break}}},{INIT_GADGETS:false,USER_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},EXPERT_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},NAME:"RCCCDialogPageType1",USER_RESPONSES:[]});puremvc.define({name:"jet.view.page.RCCCDialogPageType2",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("DialogPage");$(this.myDiv).addClass("DialogItemPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.questionContainerDiv=document.createElement("div");this.questionContainerDiv.className="dialogQuestionContainer";$(this.myDiv).append(this.questionContainerDiv);this.questionDiv=document.createElement("div");this.questionDiv.className="dialogQuestion";$(this.questionContainerDiv).append(this.questionDiv);this.itemContainerDiv=document.createElement("div");this.itemContainerDiv.className="dialogItemContainer";$(this.contentDiv).append(this.itemContainerDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.rcccCheckboxComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.pointValues=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,questionDiv:null,questionContainerDiv:null,itemContainerDiv:null,answerKeys:null,components:null,userInputComponents:null,rcccCheckboxComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,branchingComponents:null,pointValues:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,questionStem:"",correctRating:null,additionalInfo:null,userAnswer:null,domainType:null,additionalInfoInput:null,dataXML:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.processXML(this.dataXML)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:var i=f.getTag(b);if(i=="checkedNodeOptions"){f.checkedBranchOptions=d}if(i=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.DATA_INPUT:this.dataXML=h;break;case jet.AppConstants.TEXT:var i=f.getTag(b);if(i=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.questionContainerDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialogStem");this.questionStem=h}else{if(i.match("dialog1")){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog1")}else{if(i.match("dialog2")){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog2")}else{if(i.match("correctRating")){this.correctRating=h.toUpperCase().trim()}else{if(i.match("additionalInfo")){this.additionalInfo=h.toUpperCase().trim();if(this.additionalInfo.length>0){this.additionalInfoInput=new jet.view.component.InputTextComponent;this.additionalInfoInput.setParent(f.questionContainerDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.additionalInfoInput,b);this.additionalInfoInput.setText("");this.additionalInfoInput.addClass("additionalInfoInput")}}else{if(i=="totalpoints"){this.setTotalPoints(h)}}}}}}break;case jet.AppConstants.COMBO_BOX:var i=f.getTag(b);if(i=="questionTypes"){this.createQuestionType(h)}if(i=="domainTypes"){this.setDomainType(h)}break;case jet.AppConstants.IMAGE:var i=f.getTag(b);if(i=="character1"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character1")}if(i=="character2"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character2")}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var i=f.getTag(b);if(i=="hideAnswer"){f.setHideAnswer(h)}if(i=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break}},getDomainType:function(){return this.domainType},setDomainType:function(a){switch(a.trim()){case"Criminal History":this.domainType="Criminal";break;case"Education/Employment":this.domainType="Education";break;case"Family/Marital":this.domainType="Family";break;case"Leisure/Recreation":this.domainType="Leisure";break;case"Companions":this.domainType="Companions";break;case"Alcohol/Drug Problem":this.domainType="Alcohol";break;case"Procriminal Attitude/Orientation":this.domainType="Procriminal";break;case"Antisocial Pattern":this.domainType="Antisocial";break}},createQuestionType:function(a){switch(a){case ("3-0 Rating"):this.createQPart("3",this.questionDiv);this.createQPart("2",this.questionDiv);this.createQPart("1",this.questionDiv);this.createQPart("0",this.questionDiv);break;case ("Yes No"):this.createQPart("No",this.questionDiv);this.createQPart("Yes",this.questionDiv);break;case ("True False"):this.createQPart("True",this.questionDiv);this.createQPart("False",this.questionDiv);break;default:}$(this.questionDiv).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},createQPart:function(d,e){var a=document.createElement("div");a.className="dialogQuestionPart";$(e).append(a);$(a).html(d);var b=this;$(a).on("click",function(){b.setUserAnswer(d.toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(a).addClass("selected");b.showCheckAnswerButton()})},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var a=this;$(this.questionContainerDiv).find(".dialogQuestionPart").on("click",function(){a.setUserAnswer($(this).text().toUpperCase().trim());$(".dialogQuestionPart").removeClass("selected");$(this).addClass("selected");a.showCheckAnswerButton()});if(this.additionalInfoInput!=null){this.additionalInfoInput.enable()}},disableInteractivity:function(){var b=this;var a=b.getContentDiv();$(this.questionContainerDiv).find(".dialogQuestionPart").unbind("click");if(this.additionalInfoInput!=null){this.additionalInfoInput.disable()}},processComponents:function(){},postProcess:function(){},getBranchOptions:function(){return this.branchOptions},setMetrics:function(d,a){if(d!=null){d=d.trim()}else{d="5"}switch(d){case"0":d=1;break;case"1":d=1;break;case"YES":d=1;break;default:d=0}var b=this.getDomainType();a[b]=a[b]+d},evaluateUserActivity:function(){var b=jet.view.page.RCCCDialogPageType1.USER_METRICS;var n=jet.view.page.RCCCDialogPageType1.EXPERT_METRICS;this.disableInteractivity();this.setMetrics(this.userAnswer,b);this.setMetrics(this.correctRating,n);this.sendGraphData(b,n);var d="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.userAnswer!=this.correctRating){d="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}var k=this.rcccCheckboxComponents;for(var j=0;j<k.length;j++){var l=k[j];var m=$(l).data("isChecked").toUpperCase().contains("YES");var a=$(l).get(0).checked;if(m!=a){d="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0);$(l).css("outline","1px solid #1e0000")}}if(this.additionalInfoInput!=null){var h=this.additionalInfoInput.getUserInput().toUpperCase();if(h!=this.additionalInfo.toUpperCase()){d="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){branchOptionsFeedback=this.branchOptions.feedback}}}var f=this.domainType+"_"+this.questionStem;var o=this.getIsUserCorrect()?"correct":"incorrect";var e={uid:this.uid,questionType:"choice",question:f.substring(0,249),learnerResponse:this.userAnswer,correctResponse:this.correctRating,result:o};jet.view.page.RCCCDialogPageType1.USER_RESPONSES.push(e);this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.uid,e);return true?d:"Submitted"},sendGraphData:function(o,q){var l=this.scaleData("Criminal",o.Criminal);var f=this.scaleData("Education",o.Education);var m=this.scaleData("Family",o.Family);var p=this.scaleData("Leisure",o.Leisure);var i=this.scaleData("Companions",o.Companions);var u=this.scaleData("Alcohol",o.Alcohol);var b=this.scaleData("Procriminal",o.Procriminal);var a=this.scaleData("Antisocial",o.Antisocial);var t=[[m],[i],[l],[f],[p],[u],[b],[a]];var s=["2=Low, 3=Med, 4=High"];var e=["#ebb207","#cc0606","#cc0606","#ffff70","#ffff70","#ebb207","#cc0606","#cc0606"];var j=0;var r=5;var h=[{label:"Family"},{label:"Companions"},{label:"Criminal"},{label:"Education"},{label:"Leisure"},{label:"Alcohol"},{label:"Procriminal"},{label:"Antisocial"}];var d={};d.name="BARGRAPH";d.data=t;d.ticks=s;d.seriesColors=e;d.series=h;d.minValue=j;d.maxValue=r;var k=jet.ApplicationFacade.getInstance(jet.ApplicationFacade.NAME);k.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,d);var n={};n.name="LEGEND";n.data=["Family","Companions","Criminal","Education","Leisure","Alcohol","Procriminal","Antisocial"];n.seriesColors=e;k.sendNotification(jet.AppConstants.REQUEST_GADGET_UPDATE,n)},storeUserFeedback:function(){},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.branchingComponents);this.setUserPoints(parseFloat(this.pointValues[b]));var a=d.getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(d,b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){switch(a){case"click":$(".interviewerDistractor").css("text-decoration","none");$(d).css("text-decoration","underline");this.showCheckAnswerButton();break}}},enable:function(){},disable:function(){},getName:function(){return"DialogPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setUserAnswer:function(a){this.userAnswer=a},getUserAnswer:function(){return this.userAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},scaleData:function(b,a){switch(b){case"Criminal":case"Education":switch(a){case 0:case 1:return 1;case 2:case 3:return 2;case 4:case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5}break;case"Family":case"Companions":case"Procriminal":case"Antisocial":switch(a){case 0:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5}break;case"Leisure":switch(a){case 0:return 1;case 1:return 3;case 2:return 4}break;case"Alcohol":switch(a){case 0:return 1;case 1:case 2:return 2;case 3:case 4:return 3;case 5:case 6:return 4;case 7:case 8:return 5}break}},processXML:function(d){this.rcccCheckboxComponents=[];$(this.itemContainerDiv).empty();this.xml=d;xmlDoc=$.parseXML(d);var b=$(xmlDoc).find("dataPage");for(var f=0;f<b.length;f++){var e=b[f];var j=$(e).find("Item")[0].textContent.trim();var a=$(e).find("Question_Number")[0].textContent.trim();var k=$(e).find("isChecked")[0].textContent.trim();var h={item:j,question_number:a,isChecked:k,};this.renderQuestion(h)}},renderQuestion:function(f){var b=false;var d=document.createElement("div");d.className="dialogItem";var e=document.createElement("input");this.rcccCheckboxComponents.push(e);e.className="dialogCheckbox";e.type="checkbox";$(e).data("isChecked",f.isChecked);if(this.getUserResponse(f.question_number)){e.checked=true}else{e.checked=false}var a=document.createElement("div");a.className="dialogItemPart";$(a).html(f.item);$(d).append(e);$(d).append(a);$(d).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20});$(this.itemContainerDiv).append(d);$(this.itemContainerDiv).layout({type:"flow",resize:true,alignment:"left",vgap:10,hgap:20})},getUserResponse:function(b){if(b==undefined||b==null){return false}if(!this.isNumber(b)){return false}var d=jet.view.page.RCCCDialogPageType1.USER_RESPONSES;if(d==null||d==undefined){return false}for(var f=0;f<d.length;f++){var a=d[f].question.trim();var h=d[f].learnerResponse.toUpperCase();var e;var k=/.*_(\d*).*/;var j=k.exec(a);var e=j[1];if(e==b){if(h=="YES"||h=="0"||h=="1"){return true}}}return false},isNumber:function(a){return !isNaN(a-0)&&a!==null&&a!==""&&a!==false}},{INIT_GADGETS:false,USER_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},EXPERT_METRICS:{Criminal:0,Education:0,Family:0,Leisure:0,Companions:0,Alcohol:0,Procriminal:0,Antisocial:0},NAME:"RCCCDialogPageType2"});puremvc.define({name:"jet.view.page.RCCCEvaluationPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="content";$(this.myDiv).addClass("RCCCEvaluationPage");this.myDiv.id=a;this.reportDiv=document.createElement("div");this.reportDiv.className="reportDiv";$(this.reportDiv).attr("id","reportDiv");this.legendDiv=document.createElement("div");this.legendDiv.className="legendDiv";$(this.legendDiv).attr("id","legendDiv");$(this.legendDiv).attr("width","650px");this.barGraphDiv=document.createElement("div");this.barGraphDiv.className="evaluationBargraph";this.barGraphID="barGraph_"+jet.view.page.RCCCEvaluationPage.INSTANCE_ID++;$(this.barGraphDiv).attr("id",this.barGraphID);this.labelsDiv=document.createElement("div");this.labelsDiv.className="labelsDiv";$(this.labelsDiv).attr("id","labelsDiv");$(this.labelsDiv).attr("width","650px");this.graphScaleExplanationDiv=document.createElement("div");this.graphScaleExplanationDiv.className="graphScaleExplanationDiv";$(this.graphScaleExplanationDiv).attr("id","graphScaleExplanationDiv");$(this.graphScaleExplanationDiv).attr("width","650px");this.components=[];this.userInputComponents=[];$(".viewer").append(this.myDiv);$(this.myDiv).append(this.reportDiv);$(this.myDiv).append(this.legendDiv);$(this.myDiv).append(this.barGraphDiv);$(this.myDiv).append(this.labelsDiv);$(this.myDiv).append(this.graphScaleExplanationDiv);this.buildLegend(this.legendDiv);this.buildGraphLabels(this.labelsDiv);this.buildGraphScaleExplanation(this.graphScaleExplanationDiv)}},{uid:null,originalMessage:"",scoreMessage:"",riskScoreMessage:"",logMessage:"",components:null,barGraphDiv:null,legendDiv:null,labelsDiv:null,graphScaleExplanationDiv:null,reportDiv:null,barGraphID:0,show:function(a){if(a){$(this.myDiv).show();$(this.legendDiv).show();this.mediators[jet.view.mediator.PageMediator.NAME].requestReport();this.mediators[jet.view.mediator.PageMediator.NAME].requestFeedbackReport();this.mediators[jet.view.mediator.PageMediator.NAME].requestObjectiveAnswersReport();this.sendGraphData(jet.view.page.RCCCDialogPageType1.USER_METRICS,jet.view.page.RCCCDialogPageType1.EXPERT_METRICS)}else{$(this.myDiv).hide();$(this.legendDiv).hide()}},buildComponent:function(d,b,a,e){if(b==jet.AppConstants.TEXT){$(this.reportDiv).html(e);if(e.length>0){this.originalMessage=e}}},handleText:function(a){},processComponents:function(){},requestConfirmation:function(){this.mediators[jet.view.mediator.PageMediator.NAME].requestConfirmation()},handleShow:function(){this.mediators[jet.view.mediator.PageMediator.NAME].requestConfirmationReport()},processNotification:function(w,l){var k=this.components[this.components.length-1];switch(w){case jet.AppConstants.REPORT_INTERNALLY:var r=0;var u=0;r=l.scoreTotal;u=l.userTotal;this.scoreMessage="<hr><p class='reportDiv'>Questions correctly assessed: "+u+"/"+r+"</p><p class='reportDiv'>Scoring Accuracy: "+parseInt(u/r*100)+"%";var v=this.getRiskScore();this.riskScoreMessage="<hr><p class='riskScoreExplanation'>Your risk score: <span class='riskScore'>"+v.userRiskScore+"</span> <span class='riskScoreExplanation'>Our risk score:</span><span class='riskScore'>"+v.expertRiskScore+"</span></p>";var b=this.getProtectiveFactorScore();this.riskScoreMessage+="<hr><p class='riskScoreExplanation'>Your protective factors score: <span class='protectiveScore'>"+b.userPFScore+"</span> <span class='riskScoreExplanation'>  Our protective factors score: </span><span class='protectiveScore'>"+b.expertPFScore+"</span></p>";var m=this.originalMessage+this.scoreMessage+this.riskScoreMessage+this.logMessage;$(this.reportDiv).html(m);this.requestConfirmation();break;case jet.AppConstants.REPORT_FEEDBACK_INTERNALLYX:var m=this.originalMessage+this.scoreMessage;var a=l;for(var p=0;p<l.length;p++){var e=l[p];if((e.feedback!=null&&e.feedback!=undefined)&&(e.feedback.length>0)){m+="<p>Q: "+e.question+"</p>";m+="<p>Feedback: "+e.feedback+"</p>"}}k.setText(m);break;case jet.AppConstants.REQUEST_CONFIRMATION:var m=this.originalMessage+this.scoreMessage+this.riskScoreMessage;var s=new Date();var t=s.getDate();var q=s.getMonth()+1;var n=s.getFullYear();var f=s.getHours();var o=s.getMinutes();var d="<p>Requested confirmation at "+q+"/"+t+"/"+n+" "+f+":"+o+"</p>";d="";this.logMessage+=d;$(this.reportDiv).html(m+this.logMessage);break;case jet.AppConstants.REPORT_CONFIRMATION:var m=this.originalMessage+this.scoreMessage+this.riskScoreMessage;var s=new Date();var t=s.getDate();var q=s.getMonth()+1;var n=s.getFullYear();var f=s.getHours();var o=s.getMinutes();var j=l;var h="";switch(j.status){case"Success":h=" Received confirmation at "+q+"/"+t+"/"+n+" "+f+":"+o;h+=" Score Reported: "+j.rawValue;break;case"Failure":h="Received confirmation at "+q+"/"+t+"/"+n+" "+f+":"+o;h+=" "+j.message+" ";break;default:h="<p>Something unexpected happened.</p>";break}this.logMessage+=h;$(this.reportDiv).html(m+this.logMessage);break}},buildLegend:function(a){this.createLegendPart("Family",a,"#ebb207");this.createLegendPart("Companions",a,"#cc0606");this.createLegendPart("Criminal",a,"#cc0606");this.createLegendPart("Education",a,"#ffff70");this.createLegendPart("Leisure",a,"#ffff70");this.createLegendPart("Alcohol",a,"#ebb207");this.createLegendPart("Procriminal",a,"#cc0606");this.createLegendPart("Antisocial",a,"#cc0606");$(a).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:30})},createLegendPart:function(d,e,a){var b=document.createElement("div");b.className="legendPart";$(e).append(b);$(b).html(d+" <font color="+a+">&#x2588;</font>")},createGraphScalePart:function(d,e,a){var b=document.createElement("div");b.className="graphScalePart";$(e).append(b);$(b).html(" <font color="+a+">"+d+"</font>")},createLabelPart:function(f,h,b,a){b="#999999";var e=0;left=e+a*82;f=f+"          ";f=f.substring(0,11);var d=document.createElement("div");d.className="labelPart";$(d).css("left",left);$(d).css("top","0px");$(h).append(d);$(d).html(" <font color="+b+">"+f+"</font>")},buildGraphLabels:function(a){this.createLabelPart("Family",a,"#ebb207",0);this.createLabelPart("Companions",a,"#cc0606",1);this.createLabelPart("Criminal",a,"#cc0606",2);this.createLabelPart("Education",a,"#ffff70",3);this.createLabelPart("Leisure",a,"#ffff70",4);this.createLabelPart("Alcohol",a,"#ebb207",5);this.createLabelPart("Procriminal",a,"#cc0606",6);this.createLabelPart("Antisocial",a,"#cc0606",7)},buildGraphScaleExplanation:function(a){this.createGraphScalePart("1=Very Low",a,"#000000");this.createGraphScalePart("2=Low",a,"#000000");this.createGraphScalePart("3=Medium",a,"#000000");this.createGraphScalePart("4=High",a,"#000000");this.createGraphScalePart("5=Very High",a,"#000000");$(a).layout({type:"flow",resize:true,alignment:"left",vgap:3,hgap:20})},sendGraphData:function(r,t){var p=this.scaleData("Criminal",r.Criminal);var i=this.scaleData("Education",r.Education);var q=this.scaleData("Family",r.Family);var s=this.scaleData("Leisure",r.Leisure);var k=this.scaleData("Companions",r.Companions);var y=this.scaleData("Alcohol",r.Alcohol);var b=this.scaleData("Procriminal",r.Procriminal);var a=this.scaleData("Antisocial",r.Antisocial);var l=this.scaleData("Criminal",t.Criminal);var h=this.scaleData("Education",t.Education);var n=this.scaleData("Family",t.Family);var o=this.scaleData("Leisure",t.Leisure);var m=this.scaleData("Companions",t.Companions);var u=this.scaleData("Alcohol",t.Alcohol);var w=this.scaleData("Procriminal",t.Procriminal);var d=this.scaleData("Antisocial",t.Antisocial);var x=[[q],[n],[k],[m],[p],[l],[i],[h],[s],[o],[y],[u],[b],[w],[a],[d]];var v=[""];var f=["#ebb207","#00e700","#cc0606","#00e700","#cc0606","#00e700","#ffff70","#00e700","#ffff70","#00e700","#ebb207","#00e700","#cc0606","#00e700","#cc0606","#00e700"];var j=[{label:"Family"},{label:""},{label:"Companions"},{label:""},{label:"Criminal"},{label:""},{label:"Education"},{label:""},{label:"Leisure"},{label:""},{label:"Alcohol"},{label:""},{label:"Procriminal"},{label:""},{label:"Antisocial"},{label:""}];var e={};e.name="BARGRAPH";e.data=x;e.ticks=v;e.seriesColors=f;e.series=j;this.setDataObject(e)},setDataObject:function(d){var h=null;var e=null;var f=null;var b=null;if(d.hasOwnProperty("data")){h=d.data}if(d.hasOwnProperty("ticks")){e=d.ticks}if(d.hasOwnProperty("seriesColors")){f=d.seriesColors}if(d.hasOwnProperty("series")){b=d.series}var a={seriesDefaults:{renderer:$.jqplot.BarRenderer,rendererOptions:{fillToZero:true},pointLabels:{show:true,location:"n",edgeTolerance:-15}},seriesColors:f,series:b,legend:{show:false},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:e},yaxis:{pad:1.05,min:0,max:5.5,tickOptions:{showLabel:false}}}};var i=$.jqplot(this.barGraphID,h,a);i.replot(h)},scaleData:function(b,a){switch(b){case"Criminal":case"Education":switch(a){case 0:return 0;case 1:return 1;case 2:case 3:return 2;case 4:case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5}break;case"Family":case"Companions":case"Procriminal":case"Antisocial":switch(a){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5}break;case"Leisure":switch(a){case 0:return 0;case 1:return 3;case 2:return 4}break;case"Alcohol":switch(a){case 0:return 0;case 1:case 2:return 2;case 3:case 4:return 3;case 5:case 6:return 4;case 7:case 8:return 5}break}},getRiskScore:function(){var d=0;var j=0;var h=jet.view.page.RCCCDialogPageType1.USER_RESPONSES;for(var b=0;b<h.length;b++){response=h[b];var e=response.learnerResponse.toUpperCase();if(e<=1||e=="YES"){d++}var a=response.correctResponse.toUpperCase();if(a<=1||a=="YES"){j++}}var f={userRiskScore:d,expertRiskScore:j};return f},getProtectiveFactorScore:function(){var e=0;var j=0;var h=jet.view.page.RCCCDialogPageType1.USER_RESPONSES;for(var b=0;b<h.length;b++){response=h[b];var d=response.learnerResponse.toUpperCase();switch(d){case"0":case"1":case"2":case"3":e+=Number(d);break;default:}var a=response.correctResponse.toUpperCase();switch(a){case"0":case"1":case"2":case"3":j+=Number(a);break;default:}}var f={userPFScore:e,expertPFScore:j};return f}},{INSTANCE_ID:0,NAME:"RCCCEvaluationPage"});puremvc.define({name:"jet.view.page.ReportPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="content";$(this.myDiv).addClass("ReportPage");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[]}},{hasEmbeddedVariables:false,sourceText:null,originalMessage:"",scoreMessage:"",logMessage:"",feedbackMessage:"",components:null,show:function(a){if(a){this.evaluateEmbeddedVariables();$(this.myDiv).show();this.mediators[jet.view.mediator.PageMediator.NAME].requestReport();this.mediators[jet.view.mediator.PageMediator.NAME].requestFeedbackReport()}else{$(this.myDiv).hide()}},buildComponent:function(e,d,b,f){if(d==jet.AppConstants.TEXTX){var a=new jet.view.component.ViewComponent;a.setParent(e.myDiv);e.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(f);this.components.push(a);if(f.length>0){this.originalMessage=f}}if(d==jet.AppConstants.TEXT){$(this.myDiv).html(f);if(f.length>0){this.originalMessage=f}}},handleText:function(a){},processComponents:function(){},requestConfirmation:function(){this.mediators[jet.view.mediator.PageMediator.NAME].requestConfirmation()},processNotification:function(u,k){var j=this.components[this.components.length-1];switch(u){case jet.AppConstants.REPORT_INTERNALLY:var q=0;var t=0;q=k.scoreTotal;t=k.userTotal;this.scoreMessage="<hr><p class='report'>"+t+"/"+q+"</p><p>"+parseInt(t/q*100)+"%";var l=this.originalMessage+this.scoreMessage+this.logMessage;$(this.myDiv).html(l);this.requestConfirmation();break;case jet.AppConstants.REPORT_FEEDBACK_INTERNALLY:var l=this.originalMessage+this.scoreMessage+this.logMessage;var a=k;for(var o=0;o<k.length;o++){var d=k[o];if((d.feedback!=null&&d.feedback!=undefined)&&(d.feedback.length>0)){this.feedbackMessage="<p>Q: "+d.question+"</p>";this.feedbackMessage+="<p>Feedback: "+d.feedback+"</p>"}}l+=this.feedbackMessage;$(this.myDiv).html(l);break;case jet.AppConstants.REQUEST_CONFIRMATION:var l=this.originalMessage+this.scoreMessage+this.feedbackMessage;var r=new Date();var s=r.getDate();var p=r.getMonth()+1;var m=r.getFullYear();var e=r.getHours();var n=r.getMinutes();var b="<p>Requested confirmation at "+p+"/"+s+"/"+m+" "+e+":"+n+"</p>";this.logMessage+=b;$(this.myDiv).html(l+this.logMessage);break;case jet.AppConstants.REPORT_CONFIRMATION:var l=this.originalMessage+this.scoreMessage+this.feedbackMessage;var r=new Date();var s=r.getDate();var p=r.getMonth()+1;var m=r.getFullYear();var e=r.getHours();var n=r.getMinutes();var h=k;var f="";if(typeof isChild!="undefined"){if(isChild()){return}}switch(h.status){case"Success":f="<p>Received confirmation at "+p+"/"+s+"/"+m+" "+e+":"+n+"</p>";f+="<p> Score Reported: "+h.rawValue+"</p>";f+="<p>When you're done, do not quit the browser. Move to the next topic so that your score will be pushed to the gradebook.</p>";break;case"Failure":f="<p>Received confirmation at "+p+"/"+s+"/"+m+" "+e+":"+n+"</p>";f+="<p>"+h.message+"</p>";break;default:f="<p>Something unexpected happened.</p>";break}this.logMessage+=f;$(this.myDiv).html(l+this.logMessage);break}},evaluateEmbeddedVariables:function(){if(this.hasEmbeddedVariables||$(this.myDiv).html().match(/({)(\S*)(})/)!=null){this.hasEmbeddedVariables=true;if(this.getSourceText()==null){this.setSourceText($(this.myDiv).html())}$(this.myDiv).html(this.getSourceText());var d=$(this.myDiv).find("p:contains('{')");for(var b=0;b<d.length;b++){var e=$(d[b]).text();captureGroups=e.match(/({)(\S*)(})/);if(captureGroups!=null&&captureGroups.length>2){var a=captureGroups[2];var f=getJetValue(a);if(f!=null&&f!=undefined){e=e.replace(/{.*}/,f);$(d[b]).html(e)}}}}this.originalMessage=$(this.myDiv).html()},setSourceText:function(a){this.sourceText=a},getSourceText:function(){return this.sourceText},},{NAME:"ReportPage"});puremvc.define({name:"jet.view.page.ShortAnswerPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("ShortAnswerPage");this.myDiv.id=a;$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.feedBackComponents=[]}},{branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,useRegEx:false,processedExpression:false,processedRegEx:false,originalExpression:null,isUserCorrect:null,feedBackComponents:null,questionStem:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:f.branchOptions=d;var i=f.getTag(b);if(i=="checkedNodeOptions"){f.checkedBranchOptions=d}if(i=="uncheckedNodeOptions"){f.unCheckedBranchOptions=d}break;case jet.AppConstants.CHECKBOX:this.processedRegEx=true;if(h.toUpperCase()=="TRUE"){this.useRegEx=true}if(this.processedExpression&this.processedRegEx){this.processAnswerKeys()}var i=f.getTag(b);if(i=="flowstatus"){if(h=="true"){f.setInFlow(false)}}break;case jet.AppConstants.TEXT:var i=f.getTag(b);if(i=="totalpoints"){f.setTotalPoints(h)}else{if(i=="expression"){this.processedExpression=true;this.originalExpression=h;var a=new jet.view.component.InputTextComponent;a.setParent(f.myDiv,this);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);this.userInputComponents.push(a);if(this.processedExpression&this.processedRegEx){this.processAnswerKeys()}}else{if(i=="stem"){var a=new jet.view.component.ViewComponent;a.setParent(f.myDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);f.setQuestionStem(h)}}}break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(f.myDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break}},handleText:function(a){},splitIntoAnswerKeys:function(d){if(this.useRegEx!=true){var a=$.trim(d).split("|");for(var b=0;b<a.length;b++){this.answerKeys.push(a[b])}}else{this.answerKeys.push(d)}},concatenateAnswerKeys:function(){if(this.answerKeys.length>0){var b=this.answerKeys[0];for(var a=1;a<this.answerKeys.length;a++){b+="|"+this.answerKeys[a]}this.answerKeys[0]=b}},processAnswerKeys:function(){if(this.useRegEx){this.answerKeys.push(this.originalExpression)}else{this.splitIntoAnswerKeys(this.originalExpression)}},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},processComponents:function(){},evaluateUserActivity:function(){this.disableInteractivity();var a="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());if(this.useRegEx){if(!this.doesAnswerMatchExpression(this.userInputComponents[0].getUserInput())){a="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0);this.addFeedback(this.userInputComponents[0],false)}else{this.addFeedback(this.userInputComponents[0],true)}}else{if(!this.isAnswerinArray(this.userInputComponents[0].getUserInput())){a="\u2718";this.setIsUserCorrect(false);this.setUserPoints(0);this.addFeedback(this.userInputComponents[0],false)}else{this.addFeedback(this.userInputComponents[0],true)}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions}this.storeUserFeedback()}return a},getBranchOptions:function(){return this.branchOptions},doesAnswerMatchExpression:function(b){var a=false;$.each(this.answerKeys,function(d,e){if(b.match(e)){a=true}});return a},isAnswerinArray:function(b){var a=false;$.each(this.answerKeys,function(d,e){if($.trim(e.toUpperCase())==$.trim(b.toUpperCase())){a=true}});return a},addFeedback:function(d,a){var b=document.createElement("div");b.className="feedback";$(this.myDiv).append(b);this.feedBackComponents.push(b);$(b).css("position","absolute");$(b).css("top",d.getY());$(b).css("left",5);var e=a?"\u2713":"\u2718";$(b).html(e)},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem}},{NAME:"ShortAnswerPage"});puremvc.define({name:"jet.view.page.TextPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("TextPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.answerKeys=[];this.branchingComponents=[]}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,branchOptions:null,branchingComponents:null,$embedObject:null,show:function(a){if(a){$(this.myDiv).fadeIn(1000);this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{$(this.myDiv).hide();this.hideComponents(this.components)}},buildComponent:function(h,e,b,i,d){switch(e){case jet.AppConstants.NODES_MANAGER:h.branchOptions=d;break;case jet.AppConstants.TEXT:var j=h.getTag(b);if(j=="totalpoints"){h.setTotalPoints(i)}else{if(j=="text"&&i.length>0){this.doInstructionsExist=true}if(j=="stem"){var f=this.getProperty(b,"player_y");if(f!=null&&f!=undefined){this.stemYOffset=parseInt(f.player_y)}}var a=new jet.view.component.ViewComponent;a.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(i);if(d!=null){this.branchingComponents.push(a);a.setIndexInArray(this.branchingComponents.length-1);a.setComponentLevelBranchOptions(d);this.components.push(a)}}break;case jet.AppConstants.CHECKBOX:var a=new jet.view.component.CheckBoxComponent;a.setParent(h.contentDiv,this);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.answerKeys.push($.trim(i));this.userInputComponents.push(a);a.setIndexInArray(this.userInputComponents.length-1);this.components.push(a);break;case jet.AppConstants.IMAGE:var a=new jet.view.component.ImageComponent;a.setParent(h.contentDiv);a.setProperties(b);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(i);this.components.push(a);break;case jet.AppConstants.AUDIO:if(i.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(i);a.setAudioOptions(d);a.setParent(h.contentDiv);a.setProperties(b);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable()}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){this.disableInteractivity();var b="correct";this.setUserPoints(this.getTotalPoints());for(var a=0;a<this.userInputComponents.length&&a<this.answerKeys.length;a++){if(this.userInputComponents[a].getUserInput()!=this.answerKeys[a]){b="incorrect";this.setUserPoints(0)}}return b},setBranchOptions:function(a){this.branchOptions=a},getBranchOptions:function(){return this.branchOptions},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"}},{NAME:"QuestionPage"});puremvc.define({name:"jet.view.page.TilesPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("TilesPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);this.tilesDiv=document.createElement("div");$(this.tilesDiv).addClass("tilesDiv");this.scoreFrame=document.createElement("div");$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.distractorComponents=[];this.hideAnswer=false;this.executedSetCustomScore={};this.questionStem="";this.questionTextBlock="";this.branchingOptionArray=new Array(10);this.tiles={}}},{imageComponent:null,audioComponent:null,doInstructionsExist:false,stemYOffset:0,questionStem:null,questionTextBlock:null,contentDiv:null,tilesDiv:null,scoreFrame:null,score:0,totalPointsCounter:0,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,branchOptionArray:null,randomStatus:null,tiles:null,xml:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){$(".jp-jplayer").jPlayer("clearMedia");b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,d,a,h,b){switch(d){case jet.AppConstants.NODES_MANAGER:var i=f.getTag(a);if(i=="checkedNodeOptions"){f.checkedBranchOptions=b}if(i=="uncheckedNodeOptions"){f.unCheckedBranchOptions=b}break;case jet.AppConstants.DATA_INPUT:var e=f.processXML(h);break;case jet.AppConstants.TEXT:var i=f.getTag(a);if(i=="totalpoints"){f.setTotalPoints(h)}break;case jet.AppConstants.CHECKBOX:var i=f.getTag(a);if(i=="hideAnswer"){f.setHideAnswer(h)}else{if(i=="flowstatus"){if(h=="true"){f.setInFlow("false")}}}break;case jet.AppConstants.IMAGE:this.imageComponent=new jet.view.component.ImageComponent;this.imageComponent.setParent(f.contentDiv);this.imageComponent.setProperties(a);this.imageComponent.addClass("tilesImage");f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.imageComponent,a);this.imageComponent.setText(h);break;case jet.AppConstants.AUDIO:if(h.length<1){return}this.audioComponent=new jet.view.component.AudioComponent;this.audioComponent.setMediaURL(h);this.audioComponent.setAudioOptions(b);this.audioComponent.setParent(f.myDiv);this.audioComponent.setProperties(a);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.audioComponent,a);this.components.push(this.audioComponent);break}},getCategory:function(a){var b=this.tiles[a];if(b==null){this.tiles[a]=[]}return this.tiles[a]},insertToCategory:function(a,d){for(var b=0;b<a.length;b++){if(Number(d.Points)<Number(a[b].Points)){a.splice(b,0,d);return}}a.push(d)},processXML:function(k){this.xml=k;this.totalPointsCounter=0;xmlDoc=$.parseXML(k);var j=$(xmlDoc).find("dataPage");for(var h=0;h<j.length;h++){var b=j[h];var a=$(b).find("Category")[0].textContent.trim();var q=this.getCategory(a);var p=$(b).find("Points")[0].textContent.trim();var o=$(b).find("Question_Stem")[0].textContent.trim();var n=$(b).find("Feedback")[0].textContent.trim();var m=$(b).find("Correct_Answer")[0].textContent.trim();var f=$(b).find("Distractor_1")[0].textContent.trim();var e=$(b).find("Distractor_2")[0].textContent.trim();var d=$(b).find("Distractor_3")[0].textContent.trim();var l={Category:a,Points:p,Question_Stem:o,Feedback:n,Correct_Answer:m,Distractor_1:f,Distractor_2:e,Distractor_3:d};this.insertToCategory(q,l)}this.renderCategories();this.renderTiles()},getTilesDiv:function(){return this.tilesDiv},getNumberOfCategories:function(){var a=0;for(category in this.tiles){a++}return a},renderCategories:function(){var f=5;var d=4;var i=this.tilesDiv;$(this.contentDiv).append(i);$(i).css("display","inline-block");$(i).css("width","600px");$(i).css("height","400px");$(i).css("margin-top","10px");this.makeGauge(600,400);var a=0;for(var b in this.tiles){if(a<d){var h=document.createElement("div");$(h).css("width","193px");$(h).css("height","70px");$(h).css("font-size","24px");$(h).css("color","rgba(0,0,0,0.6)");$(h).css("padding-top","5px");$(h).css("text-shadow","2px 8px 6px rgba(0,0,0,0.2),0px -5px 35px rgba(255,255,255,0.3)");$(i).append(h);h.className="categoryDiv";h.id=a;$(h).html(b);var e=this.getCategory(b);this.renderTiles(e,f);a++}}var d=4;$(i).layout({type:"grid",columns:d,rows:f,vgap:3,hgap:3,fill:"vertical"})},renderTiles:function(l,a){var h=this;if(l==null||l==undefined){return}var e;var b=Math.min(a-1,l.length);for(e=0;e<b;e++){var m=l[e];var k=this.tilesDiv;var f=document.createElement("div");$.data(f,"question",m);$(f).css("width","193px");$(f).css("height","60px");$(f).css("font-size","24px");$(k).append(f);f.className="tileDiv";this.totalPointsCounter+=Number(m.Points);$(f).html(m.Points);$(f).on("click",function(i){h.tileClickHandler(i,h)})}for(var d=e+1;d<a;d++){var k=this.tilesDiv;var f=document.createElement("div");$(f).css("width","200px");$(f).css("height","50px");$(k).append(f);f.className="tile"}},testAlert:function(){window.alert("hi")},tileClickHandler:function(d,l){var k=d.target;var h=$.data(d.target,"question");$(k).off();var i=document.createElement("div");i.className="TilesQuestion";$(i).css("display","inline-block");$(i).css("width","700px");$(i).css("height","450px");$(i).css("overflow-x","hidden");$(i).css("overflow-y","scroll");$(i).css("padding","50px");$(i).css("background-color","#F7F7F7");$(i).css("border-style","double");$(i).css("border-width","5px");$(i).css("font-size","24px");var m=document.createElement("div");$(m).html(h.Question_Stem);$(m).css("width","600px");$(m).css("margin","20px");$(m).css("height","50px");$(m).css("background-color","#F7F7F7");$(i).append(m);var b=[];if(h.Correct_Answer!=""){b.push(h.Correct_Answer)}if(h.Distractor_1!=""){b.push(h.Distractor_1)}if(h.Distractor_2!=""){b.push(h.Distractor_2)}if(h.Distractor_3!=""){b.push(h.Distractor_3)}l.shuffle(b);for(var e=0;e<b.length;e++){var a=b[e]==h.Correct_Answer?true:false;var f=l.makeDistractor(l,b[e],a,h,i,k);$(i).append(f)}var n=l.getTilesDiv();$(n).append(i);$.colorbox({html:i,overlayClose:false,onComplete:function(){}})},makeDistractor:function(i,k,a,f,e,h){var j=document.createElement("div");$(j).on("click",function(){i.feedbackHandler(a,f,e,i,h)});$(j).mouseover(function(){$(this).css("background-color","#e7e7e7")}).mouseout(function(){$(this).css("background-color","transparent")});var d=document.createElement("input");d.type="radio";d.name="group1";$(d).addClass("questionRadioButton");$(d).css("width","10px");$(d).css("height","30px");$(d).css("margin","10px");$(d).on("click",function(){i.feedbackHandler(a,f,e,i,h)});$(j).append(d);var b=document.createElement("div");$(b).html(k);$(b).css("display","inline-block");$(b).css("width","400px");$(b).css("height","50px");$(b).css("margin","20px");$(j).append(b);return j},feedbackHandler:function(h,f,b,e,a){var d="<div style='margin:20px'>";d+="<div style='color:white;margin-left:auto;margin-right:auto;padding:20px;background-color:#ababab;border-color:#f7f7f7; border-style:solid;border-radius: 20px;";if(h){$(a).append("<span style='padding:10px;color:green'>&#x2611;</span>");d+="<p style='font-color:#00FF00;font-size:40px'>Correct</p>";d+="</div>";d+="<div style='height:300px;padding:20px;background-color:#ebebeb;border-color:#fefefe; border-style:solid;border-radius: 20px;";d+="<p style = 'margin-top: 20px'>You earn "+f.Points+" points.";d+="<p>"+f.Feedback+"</p>";e.appendScore(f.Points)}else{$(a).append("<span style='padding:10px;color:red'>&#9746;</span>");d+="<p style='color:#ff0000;font-size:40px'>Incorrect</p>";d+="</div>";d+="<div style='height:300px;padding:20px;background-color:#ebebeb;border-color:#fefefe; border-style:solid;border-radius: 20px'";d+="<p>You lose "+f.Points+" points.";d+="<p>"+f.Feedback+"</p>";e.appendScore(-1*parseInt(f.Points))}d+="<p style='margin-top:20px;margin-bottom:40px;font-size:16px'>After you have answered all of the questions, click on the 'Submit' button to register your points.</p>";d+="<button style='margin-top:20px;font-size:24px' onclick='$.colorbox.close()'>Continue</button>";d+="</div>";d+="</div>";$(b).html(d);e.showCheckAnswerButton()},shuffle:function(e){var d=e.length,b,a;while(0!==d){a=Math.floor(Math.random()*d);d-=1;b=e[d];e[d]=e[a];e[a]=b}return e},makeGauge:function(f,a){var d=document.createElement("div");$(d).addClass("gauge");$(d).css("width","300px");$(d).css("height","30px");$(d).css("top",a+"px");$(d).css("margin-top","10px");$(d).css("margin-left","auto");$(d).css("margin-right","auto");$(d).css("z-index","100");$(d).css("border-style","solid");$(d).css("border-color","#c7c7c7");$(d).css("border-radius","15px");$(d).css("background-color","#121212");var e=document.createElement("div");$(e).addClass("labelFrame");$(e).css("width","100px");$(e).css("height","25px");$(e).css("float","left");$(e).css("margin","5px");$(e).css("background-color","#121212");$(e).css("font-size","18px");$(e).css("color","#FFFFFF");$(e).html("SCORE");$(d).append(e);var b=this.scoreFrame;$(b).addClass("scoreFrame");$(b).css("width","140px");$(b).css("height","25px");$(b).css("float","left");$(b).css("margin","5px");$(b).css("background-color","#121212");$(b).css("font-size","18px");$(b).css("color","#FFFFFF");$(b).html("O pts");$(d).append(b);$(this.contentDiv).append(d)},setScoreFrame:function(a){$(this.scoreFrame).html(a+" Pts")},setScore:function(a){this.score=Number(a);this.setScoreFrame(a)},appendScore:function(a){this.score=this.score+Number(a);this.setScoreFrame(this.score)},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};this.tiles={};$(this.contentDiv).empty();$(this.tilesDiv).empty();this.processXML(this.xml);this.score=0},disableInteractivity:function(){},processComponents:function(){for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100;this.prepareQuestion()},prepareQuestion:function(){},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){var a=0.8;var b="";this.disableInteractivity();var e="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var d=this.score/this.totalPointsCounter;this.setUserPoints(Math.floor(this.getTotalPoints()*d));if(d>=a){this.setIsUserCorrect(true)}else{this.setIsUserCorrect(false)}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){b=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){b=this.branchOptions.feedback}}this.storeUserFeedback()}if(this.branchOptions&&this.branchOptions.feedback){this.branchOptions.feedback=b}return this.getHideAnswer()=="false"?e:"Sent"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();this.branchingOptionArray[b]=a;if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(b,d){var a=this.feedBackComponents[b];if(this.getHideAnswer()=="false"){$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).html("")}},clearBranchOptions:function(){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};this.setBranchOptions(a)},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setQuestionTextBlock:function(a){this.questionTextBlock=a},getQuestionTextBlock:function(){return this.questionTextBlock},setRandomStatus:function(a){this.randomStatus=a},getRandomStatus:function(){return this.randomStatus},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},},{NAME:"TilesPage"});puremvc.define({name:"jet.view.page.VideoPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("VideoPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.iFrames=[];this.videoSrc}},{contentDiv:null,answerKeys:null,components:null,iFrames:null,IFRAMEWIDTH:930,IFRAMEHEIGHT:450,videoSrc:null,isYouTube:true,captionResource:null,videoResource:null,startTime:null,endTime:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.showIFrames(true);this.showVideo(true)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.showIFrames(false);this.showVideo(false)}},buildComponent:function(h,e,d,i,b){switch(e){case jet.AppConstants.VIDEO:if(i.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var f=i.replace(/.*?v=/,"");this.drawYouTubePlayer(f);this.isYouTube=true;return}else{this.videoSrc=i;this.isYouTube=false;return}var a=new jet.view.component.ImageComponent;a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);a.setText(i);a.setCaptionOptions(b);break;case jet.AppConstants.AUDIO:if(i.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(i);a.setAudioOptions(b);a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var j=h.getTag(d);if(j=="flowstatus"){if(i=="true"){h.setInFlow(false)}}break;case jet.AppConstants.RESOURCE:var j=h.getTag(d);if(j=="videoResource"){this.videoResource="base/"+i}if(j=="captionResource"){this.captionResource="base/"+i}break;case jet.AppConstants.TEXT:var j=h.getTag(d);if(j=="start_time"){this.startTime=i}if(j=="end_time"){this.endTime=i}break}},handleText:function(a){},enableInteractivity:function(){},disableInteractivity:function(){},processComponents:function(){this.drawVideoPlayer()},getBranchOptions:function(){},evaluateUserActivity:function(){},setBranchOptions:function(a){},getBranchOptions:function(){},setBranchingComponent:function(a){},handleEvent:function(b,a){},getName:function(){return"VideoPage"},getType:function(a){switch(a.toUpperCase()){case"MP4":return"mp4";default:return a}},drawVideoPlayer:function(){if(this.isYouTube){return}if(this.videoSrc==null&&this.videoResource==null){return}if((this.videoSrc==null||this.videoSrc=="")&&this.videoResource!=null){this.videoSrc=this.videoResource}var h=this.videoSrc.substr((this.videoSrc.lastIndexOf(".")+1));var b="video/"+this.getType(h);var f=this;var e=document.createElement("video");$(this.contentDiv).append(e);$(e).addClass("video");$(e).attr("type",b);this.videoSrc=this.videoSrc+"#t="+this.startTime+","+this.endTime;$(e).attr("src",this.videoSrc);$(e).attr("controls","");if(this.captionResource!=null&&this.captionResource!=""){var a=document.createElement("track");$(a).attr("src",this.captionResource);$(a).attr("kind","captions");$(a).attr("srclang","en");$(a).attr("label","English");$(a).attr("mode","hidden");$(e).append(a);var d=document.createElement("button");$(d).append("CC");$(d).addClass("captionButton");$(d).css("background","#000000");$(d).css("color","#FFFFFF");$(d).css("font-size","8px");$(d).css("border","1px");$(d).css("border-radius","5px");$(d).css("float","right");$(d).css("height","20px");$(d).css("width","30px");$(d).css("position","absolute");$(d).css("left","90%");$(d).css("top","0%");$(this.contentDiv).append(d);$(d).on("click",function(j){var i=$(this).parent().find(".video")[0].textTracks;var k=i[0];if(k.mode!="showing"){k.mode="showing"}else{k.mode="hidden"}})}$(e).css("width","98%");$(e).css("height","98%")},drawYouTubePlayer:function(e){var d=this;var h=d.getMediator(jet.view.mediator.YouTubeMediator.NAME);var f=h.getVideoIndex();var b="player"+f;var a=document.createElement("iframe");this.iFrames.push(a);$(d.contentDiv).append(a);a.id=b;$(a).css("width","98%");$(d.contentDiv).css("padding-bottom","56.25%");a.src="https://www.youtube.com/embed/"+e+"?wmode=transparent&rel=0&enablejsapi=1&start="+this.startTime+"&end="+this.endTime;var i=setInterval(function(){if(h.isYTAvailable()){h.addPlayer(b,e);clearInterval(i)}},2000)},showVideo:function(a){if(a){}else{if($("video").size()>0){$("video").each(this.handleVideo)}}},handleVideo:function(a,b){b.pause()},showIFrames:function(a){for(var b=0;b<this.iFrames.length;b++){if(a){$(this.iFrames[b]).show();$(this.iFrames[b]).css("width","98%");$(this.iFrames[b]).css("height","98%")}else{$(this.iFrames[b]).hide();$(this.iFrames[b]).css("width","0px");$(this.iFrames[b]).css("height","0px")}}},getContentAsResource:function(){if(this.isYouTube){var a="<p style='text-align: center;'><font face='Segoe UI'><br></font></p><p style='text-align: center;'><font face='Arial'>This type of page cannot be displayed as a resource.</font></p>";return a}else{return"CLONE"}},getClonedContent:function(){return $(this.myDiv).clone(true,true)},},{NAME:"VideoPage"});puremvc.define({name:"jet.view.page.VideoScenarioPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("VideoScenarioPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.contentDiv).css("width","90%");$(this.contentDiv).css("height","66%");$(this.contentDiv).css("margin-left","2%");$(this.contentDiv).css("margin-bottom","2%");$(this.contentDiv).css("background-color","#000000");$(this.contentDiv).css("color","#FFFFFF");$(this.contentDiv).css("font-size","20pt");$(this.contentDiv).css("padding","5%");$(this.contentDiv).css("-webkit-box-shadow","inset 0px 0px 20px 6px rgba(139, 139, 147, 1)");$(this.contentDiv).css("-moz-box-shadow","inset 0px 0px 20px 6px rgba(139, 139, 147, 1)");$(this.contentDiv).css("box-shadow","inset 0px 0px 20px 6px rgba(139, 139, 147, 1)");$(this.myDiv).append(this.contentDiv);this.textDiv=document.createElement("div");this.textDiv.className="scenarioTextDiv";$(this.textDiv).css("width","90%");$(this.textDiv).css("height","66%");$(this.textDiv).css("margin-left","2%");$(this.textDiv).css("margin-bottom","2%");$(this.textDiv).css("background-color","#000000");$(this.textDiv).css("color","#FFFFFF");$(this.textDiv).css("font-size","20pt");$(this.textDiv).css("padding","5%");$(this.textDiv).css("z-index","10");$(this.contentDiv).append(this.textDiv);this.scenarioDiv=document.createElement("div");this.scenarioDiv.className="scenarioDiv";$(this.scenarioDiv).css("width","100%");$(this.scenarioDiv).css("height","33%");$(this.myDiv).append(this.scenarioDiv);$(".viewer").append(this.myDiv);this.components=[];this.iFrames=[];this.scenarioArray=[];this.videoSrc;this.scenarioDescription="";this.youTubeMediator=null;this.whichPlayer=0;this.youTubeObject=null;this.scenarioFeedback="You must choose a numbered option first.";this.numberOfTries=0}},{contentDiv:null,textDiv:null,answerKeys:null,components:null,iFrames:null,IFRAMEWIDTH:930,IFRAMEHEIGHT:450,videoSrc:null,isYouTube:true,captionResource:null,videoResource:null,xml:null,scenarioArray:null,scenarioDescription:null,youTubeMediator:null,whichPlayer:null,youTubeObject:null,videoObject:null,scenarioFeedback:"Pick an Option",numberOfTries:0,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);b.startShowTransition($(this.myDiv));this.showComponents(this.components);this.showIFrames(false);this.showVideo(false)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components);this.clearVideo()}},buildComponent:function(h,e,d,i,b){switch(e){case jet.AppConstants.DATA_INPUT:if(i.length>0){h.processXML(i);this.xml=i;h.processScenarios()}break;case jet.AppConstants.VIDEO:if(i.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var f=i.replace(/.*?v=/,"");this.drawYouTubePlayer(f);this.isYouTube=true;return}else{this.videoSrc=i;this.isYouTube=false;return}var a=new jet.view.component.ImageComponent;a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);a.setText(i);a.setCaptionOptions(b);break;case jet.AppConstants.AUDIO:if(i.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(i);a.setAudioOptions(b);a.setParent(h.contentDiv);a.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,d);this.components.push(a);break;case jet.AppConstants.CHECKBOX:var j=h.getTag(d);if(j=="flowstatus"){if(i=="true"){h.setInFlow(false)}}break;case jet.AppConstants.RESOURCE:var j=h.getTag(d);if(j=="videoResource"){this.videoResource="base/"+i}if(j=="captionResource"){this.captionResource="base/"+i}break;case jet.AppConstants.TEXT:var j=h.getTag(d);if(j=="heading"){this.scenarioDescription=i}if(j=="totalpoints"){h.setTotalPoints(i)}break}},processXML:function(k){this.xml=k;xmlDoc=$.parseXML(k);var h=$(xmlDoc).find("dataPage");for(var f=0;f<h.length;f++){var e=h[f];var n=$(e).find("Points")[0].textContent.trim();var j=$(e).find("Option")[0].textContent.trim();var b=$(e).find("Feedback")[0].textContent.trim();var a=$(e).find("URL")[0].textContent.trim();var d=$(e).find("Start_Time")[0].textContent.trim();var l=$(e).find("End_Time")[0].textContent.trim();var m={Points:n,Option:j,Feedback:b,Url:a,StartTime:d,EndTime:l};this.scenarioArray.push(m)}},processScenarios:function(){var e=this;var b=document.createElement("button");$(b).className="showScenarioButton";$(b).attr("type","button");$(b).css("width","130px");$(b).css("height","50px");$(b).css("margin-right","10px");$(b).css("margin-left","30px");$(b).css("z-index","21");$(b).text("Show Scenario");this.addScenarioButtonClickHandler(e,b);$(this.scenarioDiv).append(b);var b=document.createElement("button");$(b).className="scenarioFeedbackButton";$(b).attr("type","button");$(b).css("width","130px");$(b).css("height","50px");$(b).css("margin-right","10px");$(b).css("z-index","21");$(b).text("Show Feedback");this.addScenarioFeedbackButtonClickHandler(e,b);$(this.scenarioDiv).append(b);for(var a=0;a<this.scenarioArray.length;a++){var d=this.scenarioArray[a];var b=document.createElement("button");$(b).addClass("scenarioButton");$(b).attr("type","button");$(b).css("width","50px");$(b).css("height","50px");$(b).css("margin-right","10px");$(b).css("z-index","21");$(b).text(a+1);this.addHoverHandler(e,b,d.Option);this.addClickHandler(e,b,d.Url,d.StartTime,d.EndTime,d.Feedback,d.Points);$(this.scenarioDiv).append(b)}},addHoverHandler:function(b,a,d){$(a).hover(function(){$(b.textDiv).html("<p align='center'>"+d+"</p>")},function(){if(b.isVideoShowing()){return}$(b.textDiv).text(b.scenarioDescription);$(b.videoObject).hide();$(b.youTubeObject).hide();$(b.textDiv).show()})},addClickHandler:function(i,e,d,h,b,a,f){$(e).click(function(){i.numberOfTries++;i.scenarioFeedback=a;if($(this).data("selected")!=true){var k=i.getUserPoints();k+=f/i.numberOfTries;k=Math.min(k,i.getTotalPoints());k=Math.ceil(k);i.setUserPoints(k);i.scenarioFeedback+=" You have earned a total of "+k+" point(s).";i.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(i,i.uid)}$(this).data("selected",true);i.clearVideo();if(d.toUpperCase().indexOf("WWW.YOUTUBE.COM")>-1){var j=i.youTubeMediator.normalizeURL(d);i.youTubeMediator.cueYTVideoById(i.youTubeObject,i.whichPlayer,j,h,b);$(i.textDiv).hide();$(i.videoObject).hide();$(i.youTubeObject).show()}else{i.youTubeMediator.cueVideoById(i.videoObject,i.whichPlayer,d,h,b);$(i.textDiv).hide();$(i.youTubeObject).hide();$(i.videoObject).show()}})},addScenarioButtonClickHandler:function(b,a){$(a).click(function(){b.clearVideo();$(b.textDiv).show();$(b.textDiv).text(b.scenarioDescription);b.scenarioFeedback="You must choose a numbered option to get feedback."})},addScenarioFeedbackButtonClickHandler:function(b,a){$(a).click(function(){b.clearVideo();$(b.textDiv).show();$(b.textDiv).text(b.scenarioFeedback)})},isVideoShowing:function(){if($(this.videoObject).css("display")=="none"&&$(this.youTubeObject).css("display")=="none"){return false}else{return true}},clearVideo:function(){$(this.videoObject).hide();$(this.youTubeObject).hide();$(this.videoObject).attr("src","");$(this.youTubeObject).attr("src","")},handleText:function(a){},enableInteractivity:function(){$(this.scenarioDiv).find(".scenarioButton").data("selected",false);this.setUserPoints(0);this.numberOfTries=0},disableInteractivity:function(){},processComponents:function(){this.drawVideoPlayer();this.drawYouTubePlayer();$(this.textDiv).text(this.scenarioDescription)},getBranchOptions:function(){},evaluateUserActivity:function(){},setBranchOptions:function(a){},getBranchOptions:function(){},setBranchingComponent:function(a){},handleEvent:function(b,a){},getName:function(){return"VideoPage"},getType:function(a){switch(a.toUpperCase()){case"MP4":return"mp4";default:return a}},drawVideoPlayer:function(){var a=document.createElement("video");this.videoObject=a;$(this.contentDiv).append(a);$(a).addClass("video");$(a).attr("controls","");$(a).css("width","98%");$(a).css("height","98%");$(a).hide()},drawYouTubePlayer:function(){var d=this;this.youTubeMediator=d.getMediator(jet.view.mediator.YouTubeMediator.NAME);var e=this.youTubeMediator.getVideoIndex();this.whichPlayer=e;var b="player"+e;var a=document.createElement("iframe");this.youTubeObject=a;this.iFrames.push(a);$(d.contentDiv).append(a);a.id=b;$(a).css("width","400px");$(a).css("height","300px");var f=setInterval(function(){if(this.youTubeMediator&&this.youTubeMediator.isYTAvailable()){this.youTubeMediator.addPlayer(b,videoID);clearInterval(f)}},2000);$(a).hide()},showVideo:function(a){if(a){}else{if($("video").size()>0){$("video").each(this.handleVideo)}}},handleVideo:function(a,b){b.pause()},showIFrames:function(a){for(var b=0;b<this.iFrames.length;b++){if(a){$(this.iFrames[b]).show();$(this.iFrames[b]).css("width",this.IFRAMEWIDTH+"px");$(this.iFrames[b]).css("height",this.IFRAMEHEIGHT+"px")}else{$(this.iFrames[b]).hide();$(this.iFrames[b]).css("width","0px");$(this.iFrames[b]).css("height","0px")}}}},{NAME:"VideoScenarioPage"});puremvc.define({name:"jet.view.page.WallPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a}},{show:function(a){},getName:function(){return"Wall"},processComponents:function(){}},{NAME:"WallPage"});puremvc.define({name:"jet.view.page.WidgetPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("WidgetPage");$(this.myDiv).addClass("OpenQuestionPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.hideAnswer=false;this.executedSetCustomScore={};this.components=[]}},{contentDiv:null,components:null,isUserCorrect:null,hideAnswer:"false",executedSetCustomScore:null,latitude:null,longitude:null,latitudeProximity:null,longitudeProximity:null,title:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){$(".jp-jplayer").jPlayer("clearMedia");b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(d,f,e,j,i){switch(f){case jet.AppConstants.NODES_MANAGER:d.branchOptions=i;break;case jet.AppConstants.TEXT:var k=d.getTag(e);if(k=="totalpoints"){d.setTotalPoints(j)}if(k=="backgroundColor"){d.setBackgroundColor(j)}if(k=="textBlock"&&j.length>0){var a=this.getMediator(jet.view.mediator.WidgetMediator.NAME);var h=a.processBasicComponent(d,j,e);var b=h.getContentDiv();var h=a.findWidgets(d,b)}if(k=="latitude"&&j.length>0){this.latitude=j}if(k=="latitudeProximity"&&j.length>0){this.latitudeProximity=j}if(k=="longitude"&&j.length>0){this.longitude=j}if(k=="longitudeProximity"&&j.length>0){this.longitudeProximity=j}if(k=="index"&&j.length>0){this.title=j;$(this.myDiv).attr("data-title",j)}break;case jet.AppConstants.CHECKBOX:var k=d.getTag(e);if(k=="hideAnswer"){d.setHideAnswer(j)}if(k=="flowstatus"){if(j=="true"){d.setInFlow(false)}}break;case jet.AppConstants.AUDIO:if(j.length<1){return}var h=new jet.view.component.AudioComponent;h.setMediaURL(j);h.setAudioOptions(i);h.setParent(this.myDiv);h.setProperties(e);d.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(h,e);this.components.push(h);break}},handleText:function(a){},getLatitude:function(){return this.latitude},getLongitude:function(){return this.longitude},getLatitudeProximity:function(){return this.latitudeProximity},getLongitudeProximity:function(){return this.longitudeProximity},getTitle:function(){return this.title},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var a=this.getMediator(jet.view.mediator.WidgetMediator.NAME);a.enableInteractivity(this.contentDiv)},disableInteractivity:function(){},processComponents:function(){},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(a){},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(a,b){},clearFeedback:function(){},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){for(var a=0;a<this.components.length;a++){if(this.components[a].initialize){this.components[a].initialize()}}return $(this.contentDiv).html()},getContentAsResource:function(){for(var a=0;a<this.components.length;a++){if(this.components[a].initialize){this.components[a].initialize()}}return $(this.contentDiv).html()}},{NAME:"WidgetPage"});puremvc.define({name:"jet.view.page.mobile.mDialogPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="page";$(this.myDiv).addClass("DialogPage");this.myDiv.id=a;this.contentDiv=document.createElement("div");this.contentDiv.className="content";$(this.myDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[]}},{contentDiv:null,components:null,dialog1:null,dialog2:null,character1:null,character2:null,userInputComponents:null,feedBackComponents:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchOptions:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){$(".jp-jplayer").jPlayer("clearMedia");b.startShowTransition($(this.myDiv));this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,e,b,h,d){switch(e){case jet.AppConstants.NODES_MANAGER:f.branchOptions=d;break;case jet.AppConstants.TEXT:var i=f.getTag(b);if(i.match("dialog1")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog1");f.dialog1=a.getContentDiv()}}else{if(i.match("dialog2")){if(h&&h!=""){var a=new jet.view.component.ViewComponent;a.setParent(f.contentDiv,f);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addContentClass("dialog2");f.dialog2=a.getContentDiv()}}}break;case jet.AppConstants.IMAGE:var i=f.getTag(b);if(i=="character1"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character1");f.character1=a.getImageParent()}if(i=="character2"){var a=new jet.view.component.ImageComponent;a.setParent(f.contentDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);a.setText(h);a.addClass("character2");f.character2=a.getImageParent()}break;case jet.AppConstants.AUDIO:if(h.length<1){return}var a=new jet.view.component.AudioComponent;a.setMediaURL(h);a.setAudioOptions(d);a.setParent(this.myDiv);a.setProperties(b);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(a,b);this.components.push(a);break}},handleText:function(a){},processComponents:function(){$(this.contentDiv).prepend(this.dialog2);$(this.contentDiv).prepend(this.dialog1);$(this.dialog1).append(this.character1);$(this.dialog2).append(this.character2)},evaluateUserActivity:function(){},},{NAME:"mDialoPage"});puremvc.define({name:"jet.view.page.mobile.mQuestionPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="container";$(this.myDiv).addClass("mQuestionPage");this.rowDiv=document.createElement("div");this.rowDiv.className="row";$(this.myDiv).append(this.rowDiv);this.contentDiv=document.createElement("div");this.contentDiv.className="column";$(this.rowDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.distractorComponents=[];this.hideAnswer=false;this.executedSetCustomScore={};this.questionStem="";this.questionTextBlock="";this.branchingOptionArray=new Array(10);this.tempArray=[];this.isMultipleChoice="false"}},{stemComponent:null,textBlockComponent:null,imageComponent:null,audioComponent:null,doInstructionsExist:false,stemYOffset:0,questionStem:null,questionTextBlock:null,contentDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,checkedBranchOptions:null,unCheckedBranchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:false,executedSetCustomScore:null,branchOptionArray:null,randomStatus:null,tempArray:null,isMultipleChoice:"false",show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){$(".jp-jplayer").jPlayer("clearMedia");b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(h,f,d,i,e){switch(f){case jet.AppConstants.NODES_MANAGER:var j=h.getTag(d);if(j=="checkedNodeOptions"){h.checkedBranchOptions=e}if(j=="uncheckedNodeOptions"){h.unCheckedBranchOptions=e}break;case jet.AppConstants.TEXT:var j=h.getTag(d);if(j=="totalpoints"){h.setTotalPoints(i)}else{if(j=="textBlock"&&i.length>0){this.textBlockComponent=new jet.view.component.ViewComponent;this.textBlockComponent.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.textBlockComponent,d);this.textBlockComponent.setText(i);$(this.myDiv).addClass("LayoutB");h.setQuestionTextBlock(i)}if(j=="stem"){this.stemComponent=new jet.view.component.ViewComponent;this.stemComponent.setParent(h.contentDiv);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.stemComponent,d);this.stemComponent.setText(i);this.stemComponent.addContentClass("stem");h.setQuestionStem(i)}else{if(j.match("distractor.*")){var b=new jet.view.component.ViewComponent;b.setParent(h.contentDiv);this.distractorComponents.push(b);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(b,d);b.setText(i);getOuterBackgroundColor(b.getContentDiv());b.addContentClass("distractor");b.addContentClass(j);if(e!=null){this.branchingComponents.push(b);b.setIndexInArray(this.branchingComponents.length-1);b.setComponentLevelBranchOptions(e)}}}}break;case jet.AppConstants.CHECKBOX:var j=h.getTag(d);if(j=="hideAnswer"){h.setHideAnswer(i)}else{if(j=="flowstatus"){if(i=="true"){h.setInFlow("false")}}else{if(j=="randomstatus"){if(i=="true"){h.setRandomStatus("true")}}else{if(j=="MC"){if(i=="true"){h.setIsMultipleChoice("true")}}else{var a={type:f,text:i,properties:d,tag:j};this.tempArray.push(a)}}}}break;case jet.AppConstants.IMAGE:this.imageComponent=new jet.view.component.ImageComponent;this.imageComponent.setParent(h.contentDiv);this.imageComponent.setProperties(d);this.imageComponent.addClass("questionImage");h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.imageComponent,d);this.imageComponent.setText(i);break;case jet.AppConstants.AUDIO:if(i.length<1){return}this.audioComponent=new jet.view.component.AudioComponent;this.audioComponent.setMediaURL(i);this.audioComponent.setAudioOptions(e);this.audioComponent.setParent(h.myDiv);this.audioComponent.setProperties(d);h.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(this.audioComponent,d);this.components.push(this.audioComponent);break}},handleText:function(a){},setIsMultipleChoice:function(a){this.isMultipleChoice=a},getIsMultipleChoice:function(){return this.isMultipleChoice},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){var b=this;this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}this.prepareQuestion()},disableInteractivity:function(){var b=this;for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}$(b.myDiv).find(".distractorHost").each(function(){b.removeInteractivityFromDistractor(this)})},makeAnswerComponents:function(){var b=this.getIsMultipleChoice();for(var e=0;e<this.tempArray.length;e++){var f=this.tempArray[e];var d=b=="false"?new jet.view.component.CheckBoxComponent:new jet.view.component.RadioButtonComponent;d.setParent(this.contentDiv,this);this.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(d,f.properties);this.answerKeys.push($.trim(f.text));this.userInputComponents.push(d);d.setIndexInArray(this.userInputComponents.length-1);$(d.getContentDiv()).attr("id",this.userInputComponents.length-1);d.addContentClass(f.tag);var a=document.createElement("div");a.className="feedback";this.feedBackComponents.push(a)}},processComponents:function(){this.makeAnswerComponents();for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100;this.prepareQuestion()},prepareQuestion:function(){var e=[];$(this.contentDiv).empty();if(this.audioComponent!=undefined&&this.audioComponent!=null){this.audioComponent.setParent(this.myDiv)}if(this.textBlockComponent!=undefined&&this.textBlockComponent!=null){$(this.textBlockComponent.getContentDiv()).removeAttr("style");$(this.textBlockComponent.getContentDiv()).css("position","static");$(this.textBlockComponent.getContentDiv()).css("margin-bottom","0px");$(this.textBlockComponent.getContentDiv()).css("margin-top","10px");$(this.textBlockComponent.getContentDiv()).css("height","155px");this.textBlockComponent.setParent(this.contentDiv)}if(this.imageComponent!=undefined&&this.imageComponent!=null){$(this.imageComponent.getContentDiv()).removeAttr("style");$(this.imageComponent.getContentDiv()).css("position","static");$(this.imageComponent.getContentDiv()).css("margin-bottom","0px");$(this.imageComponent.getContentDiv()).css("margin-top","10px");$(this.imageComponent.getContentDiv()).css("height","240px");this.imageComponent.setParent(this.contentDiv)}$(this.stemComponent.getContentDiv()).removeAttr("style");$(this.stemComponent.getContentDiv()).css("position","static");$(this.stemComponent.getContentDiv()).css("margin-bottom","20px");$(this.stemComponent.getContentDiv()).css("margin-top","20px");this.stemComponent.setParent(this.contentDiv);for(var f=0;f<this.userInputComponents.length;f++){e.push(f)}if(this.randomStatus=="true"){for(var f=e.length-1;f>0;f--){var l=e[f];var j=parseInt(Math.random()*(f+1));e[f]=e[j];e[j]=l}}for(var f=0;f<this.userInputComponents.length;f++){var h=e[f];var n=this.distractorComponents[h];var b=n.getText();if(b==null||b==undefined||b.length<1){continue}var m=document.createElement("div");$(this.contentDiv).append(m);m.className="distractorHost";$(m).removeAttr("style");$(m).css("position","static");$(m).css("margin-top","10px");$(m).css("margin-bottom","40px");$(m).css("display","block");var a=this.feedBackComponents[h];$(m).append(a);$(a).css("height","10px");$(a).css("width","10px");$(a).css("margin-left","10px");var k=this.userInputComponents[h];k.removeFromParent();$(k.getContentDiv()).removeAttr("style");k.setParent(m,this);$(k.getContentDiv()).css("margin-right","20px");$(k.getContentDiv()).css("margin-left","50px");var d=this.distractorComponents[h];d.removeFromParent();$(d.getContentDiv()).removeAttr("style");d.setParent(m,this);$(".componentX").remove();this.removeInteractivityFromDistractor(m);this.addInteractivityToDistractor(m,k.getContentDiv());getOuterBackgroundColor(m)}},addInteractivityToDistractor:function(a,b){var d=this;$(a).on("click",function(){if($(b).prop("checked")){$(b).prop("checked",false)}else{$(b).prop("checked",true);var f=$(b).attr("id");var e=d.userInputComponents[f];d.setBranchingComponent(e);d.handleEvent(jet.AppConstants.CHECKBOX,"click")}})},removeInteractivityFromDistractor:function(a){$(a).off()},getBranchOptions:function(){return this.branchOptions},evaluateUserActivity:function(){var m="";this.disableInteractivity();var a="";var d="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());for(var h=0;h<this.userInputComponents.length&&h<this.answerKeys.length;h++){if(this.userInputComponents[h].getUserInput()=="true"){var l=this.distractorComponents[h];a+=l.getText()+"; ";if(this.branchingOptionArray[h]&&this.branchingOptionArray[h].feedback){m+=this.branchingOptionArray[h].feedback+"<br />"}}if(this.userInputComponents[h].getUserInput()!=this.answerKeys[h]){d="\u2718";this.setIsUserCorrect(false);var b="\u2718";if(this.answerKeys[h]=="true"){b="\u25BA"}this.addFeedback(h,b);this.setUserPoints(0)}if(this.userInputComponents[h].getUserInput()==this.answerKeys[h]&&this.userInputComponents[h].getUserInput()=="true"){this.addFeedback(h,"\u2713")}}if(this.getIsUserCorrect()){if(this.isPageLevelBranchOption(this.checkedBranchOptions)){this.branchOptions=this.checkedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){m=this.branchOptions.feedback}}}else{if(this.isPageLevelBranchOption(this.unCheckedBranchOptions)){this.branchOptions=this.unCheckedBranchOptions;if(this.branchOptions&&this.branchOptions.feedback){m=this.branchOptions.feedback}}this.storeUserFeedback()}if(this.branchOptions&&this.branchOptions.feedback){this.branchOptions.feedback=m}var f=this.questionStem;var n=this.getIsUserCorrect()?"correct":"incorrect";var k="";for(var j=0;j<this.answerKeys.length;j++){if(this.answerKeys[j]=="true"){k+=this.distractorComponents[j].getText()+"; "}}var e={uid:this.uid,questionType:"choice",question:f.substring(0,249),learnerResponse:a,correctResponse:k,result:n};this.mediators[jet.view.mediator.PageMediator.NAME].recordUserInteraction(this.uid,e);return this.getHideAnswer()=="false"?d:"Submitted"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(d){var b=$.inArray(d,this.userInputComponents);var a=this.branchingComponents[b].getComponentLevelBranchOptions();this.branchingOptionArray[b]=a;if(a==null||a==undefined){return}if(a.checkedOption=="No action"||a.checkedOption.length<1){return}this.setBranchOptions(a);this.processBranchOption(b,a)},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(b,d){var a=this.feedBackComponents[b];if(this.getHideAnswer()=="false"){$(a).html(d)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).html("")}},clearBranchOptions:function(){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};this.setBranchOptions(a)},storeUserFeedback:function(){var a="";var b=this.getBranchOptions();if(b!=null){a=b.feedback}this.setUserFeedback({question:this.getQuestionStem(),feedback:a});this.mediators[jet.view.mediator.PageMediator.NAME].reportUserFeedbackActivity(this)},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},setQuestionStem:function(a){this.questionStem=a},getQuestionStem:function(){return this.questionStem},setQuestionTextBlock:function(a){this.questionTextBlock=a},getQuestionTextBlock:function(){return this.questionTextBlock},setRandomStatus:function(a){this.randomStatus=a},getRandomStatus:function(){return this.randomStatus},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){return $(this.contentDiv).html()},},{NAME:"mQuestionPage"});puremvc.define({name:"jet.view.page.mobile.mTextPage",parent:jet.view.page.Page,constructor:function(a){this.uid=a;this.myDiv=document.createElement("div");this.myDiv.className="container";$(this.myDiv).addClass("mPage");this.rowDiv=document.createElement("div");this.rowDiv.className="row";$(this.myDiv).append(this.rowDiv);this.contentDiv=document.createElement("div");this.contentDiv.className="column";$(this.rowDiv).append(this.contentDiv);$(".viewer").append(this.myDiv);this.components=[];this.userInputComponents=[];this.feedBackComponents=[];this.answerKeys=[];this.branchingComponents=[];this.hideAnswer=false;this.executedSetCustomScore={}}},{doInstructionsExist:false,stemYOffset:0,contentDiv:null,rowDiv:null,answerKeys:null,components:null,userInputComponents:null,feedBackComponents:null,branchOptions:null,branchingComponents:null,isUserCorrect:null,hideAnswer:"false",executedSetCustomScore:null,show:function(a){var b=this.getMediator(jet.view.mediator.PageMediator.NAME);if(a){$(".jp-jplayer").jPlayer("clearMedia");b.startShowTransition($(this.myDiv));this.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(this,this.uid);this.showComponents(this.components)}else{b.startHideTransition($(this.myDiv));this.hideComponents(this.components)}},buildComponent:function(f,l,h,o,n){switch(l){case jet.AppConstants.NODES_MANAGER:f.branchOptions=n;break;case jet.AppConstants.TEXT:var p=f.getTag(h);if(p=="totalpoints"){f.setTotalPoints(o)}else{if(p=="textBlock"&&o.length>0){var m=new jet.view.component.ViewComponent;m.setParent(f.contentDiv);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(m,h);var e=/(<body.*>)([\D|\d]*)(<\/body>)/ig;var b=e.exec(o);var d=b[2];if(d==""){d=b[1]}var k=d;var j=k.split("&lt;s&gt;");for(var a=0;a<j.length;a++){if(j[a]!=null&&j[a]!=undefined){this.processQuestionComponent(j[a])}}}}break;case jet.AppConstants.CHECKBOX:var p=f.getTag(h);if(p=="hideAnswer"){f.setHideAnswer(o)}if(p=="flowstatus"){if(o=="true"){f.setInFlow(false)}}break;case jet.AppConstants.AUDIO:if(o.length<1){return}var m=new jet.view.component.AudioComponent;m.setMediaURL(o);m.setAudioOptions(n);m.setParent(this.myDiv);m.setProperties(h);f.getMediator(jet.view.mediator.PageMediator.NAME).parseProperties(m,h);this.components.push(m);break}},processQuestionComponent:function(l){var k=new jet.view.component.OpenQuestionComponent;this.components.push(k);k.setContentClass("qitem");k.setParent(this.contentDiv,this);var j=l.split("&lt;d&gt;");if(j!=null){k.addQuestionStem(j[0]);for(var d=1;d<j.length;d++){if(j[d]==null|j[d]==undefined){continue}var b="false";var a=/(\*)/;var f=j[d];if(a.test(f)){b="true"}var e=/\*/;var h=f.replace(e,"");k.addDistractor(h,b)}}},handleText:function(a){},showCheckAnswerButton:function(){this.mediators[jet.view.mediator.PageMediator.NAME].showCheckAnswerButton()},enableInteractivity:function(){this.executedSetCustomScore={};for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].enable();this.userInputComponents[a].setCheck(false)}},disableInteractivity:function(){for(var a=0;a<this.userInputComponents.length;a++){this.userInputComponents[a].disable()}},processComponents:function(){for(var a=0;a<this.userInputComponents.length&&a<this.branchingComponents.length;a++){if(this.branchingComponents[a].getText().length<1){this.userInputComponents[a].removeFromParent()}}var b=100},getBranchOptions:function(){return this.branchOptions},calculateNumberOfCorrectAnswers:function(){var a=0;for(var b=0;b<this.answerKeys.length;b++){if(this.answerKeys[b]=="true"){a++}}return a},evaluateUserActivity:function(){this.disableInteractivity();var e="\u2713";this.setIsUserCorrect(true);this.setUserPoints(this.getTotalPoints());var f=this.getTotalPoints()/this.calculateNumberOfCorrectAnswers();for(var d=0;d<this.userInputComponents.length&&d<this.answerKeys.length;d++){if(this.userInputComponents[d].getUserInput()!=this.answerKeys[d]){e="\u2718";this.setIsUserCorrect(false);var b=parseInt((this.getUserPoints()-f)*10)/10;this.setUserPoints(b);var a="\u2718";if(this.answerKeys[d]=="true"){a="\u25BA"}this.addFeedback(this.userInputComponents[d],a)}if(this.userInputComponents[d].getUserInput()==this.answerKeys[d]&&this.userInputComponents[d].getUserInput()=="true"){this.addFeedback(this.userInputComponents[d],"\u2713")}}return this.getHideAnswer()=="false"?e:"Submitted"},setBranchOptions:function(a){this.branchOptions=this.cloneBranchOptions(a)},getBranchOptions:function(){return this.branchOptions},cloneBranchOptions:function(b){var a={checkedOption:null,checkedValue:null,showFeedback:null,feedback:null,branchOptions:null,branchDelay:null};a.checkedOption=b.checkedOption;a.checkedValue=b.checkedValue;a.showFeedback=b.showFeedback;a.feedback=b.feedback;a.branchOptions=b.branchOptions;a.branchDelay=b.branchDelay;return a},setBranchingComponent:function(a){},handleEvent:function(b,a){if(b==jet.AppConstants.CHECKBOX){switch(a){case"click":this.showCheckAnswerButton();break}}if(b==jet.AppConstants.TEXT){}},getName:function(){return"QuestionPage"},addFeedback:function(d,e){if(this.getHideAnswer()=="false"){var b=document.createElement("div");b.className="feedback";var a=$(d.getDiv());$(a).prepend(b);this.feedBackComponents.push(b);$(b).css("position","relative");$(b).css("float","left");$(b).css("top","0px");$(b).html(e)}},clearFeedback:function(){for(var a=0;a<this.feedBackComponents.length;a++){$(this.feedBackComponents[a]).remove()}this.feedBackComponents=[]},setHideAnswer:function(a){this.hideAnswer=a},getHideAnswer:function(){return this.hideAnswer},processBranchOption:function(index,tempBO){var branchingOptions=tempBO;if(branchingOptions==null||branchingOptions==undefined){return}var whichOption;var whichValue;whichOption=branchingOptions.checkedOption;whichValue=branchingOptions.checkedValue;switch(whichOption){case jet.AppConstants.OPEN_URL:var url=$.trim(whichValue);if(url.match(/^javascript:.+/)){url=url.replace(/javascript:\i\g/,"");if(!this.executedSetCustomScore.hasOwnProperty(index)){eval(url);this.executedSetCustomScore[index]="true";var nodeLevelBranchOptions=this.getBranchOptions();nodeLevelBranchOptions.checkedValue="";nodeLevelBranchOptions.checkedOption=""}}break}},getHTMLContent:function(){return $(this.contentDiv).html()},getContentAsResource:function(){return $(this.contentDiv).html()}},{NAME:"mTextPage"});puremvc.define({name:"jet.view.widget.Widget",constructor:function(){}},{widgetClassName:null,processDiv:function(a){},getWidgetClassName:function(){return this.widgetClassName},enableInteractivity:function(){},},{TEXT_CHANGED:"textChanged",NAME:"Widget"});puremvc.define({name:"jet.view.widget.ImageSliderWidget",parent:jet.view.widget.Widget,constructor:function(){}},{widgetClassName:"LS_JET_0004",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(f,e){$(f).css("border","none");$(f).css("background-image","none");$(f).css("padding","0");var a=$(f).find(".outerImageDiv");$(a).css("margin","auto");$(a).css("background","#000000");$(a).css("background-color","#000000");var d=$(f).find(".captionDivElement");$(d).css("text-align","center");$(d).css("background-color","#000000");$(d).css("min-height","50px");$(d).css("width","100%");var b=$(f).find(".imageCaption");$(b).css("background-color","#000000");$(b).css("color","#FFFFFF");$(b).css("padding","10px");$(b).css("display","inline-block");$(f).on("init",function(k,i){var j=$(f).find("img")[0];var h=$(j).attr("alt");$(l).text("");var l=$(f).find(".imageCaption")[0];$(l).text(h)});$(f).slick({dots:true,infinite:true,speed:500,fade:true,centerMode:true,cssEase:"linear",verticalSwiping:false});$(f).on("afterChange",function(k,h,n,m){var j=h.$slides.get(n);var l=$(j).find("img")[0];var i=$(j).find(".imageCaption")[0];$(i).text($(l).attr("alt"))})},enableInteractivity:function(a){},},{TEXT_CHANGED:"textChanged",NAME:"ImageSliderWidget"});puremvc.define({name:"jet.view.widget.QuestionWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0001",numberIncorrect:0,getWidgetClassName:function(){return this.widgetClassName},processDiv:function(j,f){var d=this.makeDiv();var e=this.getQuestionStem(j);var a=$(e).attr("data-bgColor");$(d).css("background-color",a);$(d).css("padding","10px");var i=$(e).attr("data-points");var b=$(e).attr("data-random")=="true"?true:false;var h=this.getDistractorsParentElement(j,f,i,b);$(d).append(e);$(d).append(h);$(j).replaceWith(d)},makeDiv:function(){var a=document.createElement("div");a.className="QuestionWidget";return a},getQuestionStem:function(a){return $(a).find(".QuestionStem")},getDistractorsParentElement:function(f,b,e,a){var d=$(f).find(".DistractorParent");this.processDistractors(d,b,e,a);return d},processDistractors:function(n,l,k,m){k=parseInt(k);k=k>0?k:0;var f=parseInt(l.getTotalPoints());f=f>0?f:0;f+=k;l.setTotalPoints(f);var b=$(n).find(".Qw_distractor");var e=this.createSubmitButton(n,l,this,k);this.submitButton=e;for(var h=0;h<b.size();h++){var d=b[h];$(d).attr("style","clear:right;margin-top:10px;padding-top:10px");$(d).attr("data-ordinal",h);var j=document.createElement("input");$(j).attr("type","checkbox");$(j).addClass("Qw_checkBox");$(j).attr("style","margin-right:10px; margin-bottom:0px;float:left");$(j).on("click",function(){$(e).show()});$(d).prepend(j);var a=document.createElement("div");$(a).addClass("feedbackdiv");$(a).width("20px");$(a).height("20px");$(a).html("&nbsp;&nbsp;&nbsp;");$(a).attr("style","display:inline-block;margin-right:10px; min-width:20px;max-width:20px;max-height:15px; text-indent:0px; float:left");$(d).prepend(a);if(m){$(d).remove}}if(m){this.randomizeDistractors(b,n)}$(n).prepend(e)},randomizeDistractors:function(f,h){for(var d=f.length-1;d>0;d--){var a=f[d];var e=parseInt(Math.random()*(d+1));f[d]=f[e];f[e]=a}for(var b=0;b<f.length;b++){$(h).append(f[b])}},processAnswer:function(l,i,h){h=h>0?h:0;this.numberIncorrect=0;var k=this.getNumberOfCorrectAnswersFromAnswerKey(l);var b=this.checkAnswers(l);if(b){var f=i.getUserPoints();i.setUserPoints(h+f)}else{var a=$(l).find(".Qw_distractor");var d=a.size();var e=h/k;var j=Math.ceil(h-(this.numberIncorrect*e));j=Math.max(0,j);var f=i.getUserPoints();i.setUserPoints(j+f)}i.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(i,i.uid);this.appendScoreMessage(l,b?h:j,h)},checkAnswers:function(s){var p=true;var b=true;var e=$(s).attr("token");var r="AES_Encryption_2";var f="RandomInitVector";var e=validate(e,r,f);var o=e.split(";");var a=$(s).find(".Qw_distractor");for(var j=0;j<a.size();j++){var d=$(a).get(j);var m=$(d).find("input");var n=$(d).attr("data-ordinal");var q=o[n];var l=new RegExp("Y|YES|TRUE|T");var k=l.test(q.toUpperCase());var h="";if($(m).attr("checked")){b=k?true:false;h=b?"\u2713":"\u2718";this.appendFeedbackMessage(d)}else{b=k?false:true;h=b?"&nbsp;&nbsp;&nbsp;":"\u25BA"}if(b==false){this.numberIncorrect++;p=false}$(d).find(".feedbackdiv").html(h)}return p},getNumberOfCorrectAnswersFromAnswerKey:function(q){var m=0;var d=$(q).attr("token");var p="AES_Encryption_2";var e="RandomInitVector";var d=validate(d,p,e);var n=d.split(";");var a=$(q).find(".Qw_distractor");for(var f=0;f<a.size();f++){var b=$(a).get(f);var k=$(b).find("input");var l=$(b).attr("data-ordinal");var o=n[l];var j=new RegExp("Y|YES|TRUE|T");var h=j.test(o.toUpperCase());if(h){m++}}return m},appendFeedbackMessage:function(b){var d=document.createElement("div");$(b).append(d);$(d).addClass("feedbackMessagediv");$(d).attr("style","margin:5px;text-indent:100px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var e=$(b).attr("data-name_feedback");var a=qValidate(e);if(a.length>0){var f="<span>feedback: "+a+"</span>";$(d).html(f)}},appendScoreMessage:function(d,e,f){var b=document.createElement("div");$(d).append(b);$(b).addClass("scoreMessagediv");$(b).attr("style","margin-top:20px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var a="<p>"+e+"/"+f+"</p>";$(b).html(a)},createSubmitButton:function(f,d,b,e){var a=document.createElement("button");$(a).addClass("Qw_submitButton");$(a).text("Submit");$(a).attr("style","margin-top:40px");$(a).on("click",function(){b.processAnswer(f,d,e);$(a).attr("disabled","disabled");$(f).find(".Qw_checkBox").attr("disabled","disabled")});$(a).show();return a},enableInteractivity:function(b){var a=$(b).find(".DistractorParent");$(a).find(".Qw_checkBox").removeAttr("disabled");$(a).find(".Qw_checkBox").attr("checked",false);$(a).find(".feedbackMessagediv").remove();$(a).find(".feedbackdiv").html("&nbsp;&nbsp;&nbsp;");$(a).find(".Qw_submitButton").removeAttr("disabled");$(a).find(".Qw_submitButton").hide();$(a).find(".scoreMessagediv").html("");$(a).find(".scoreMessagediv").html("")},},{TEXT_CHANGED:"textChanged",NAME:"QuestionWidget"});puremvc.define({name:"jet.view.widget.ShortAnswerWidget",parent:jet.view.widget.Widget,constructor:function(){}},{submitButton:null,widgetClassName:"LS_JET_0002",getWidgetClassName:function(){return this.widgetClassName},processDiv:function(i,e){var b=this.makeDiv();var d=this.getQuestionStem(i);var a=$(d).attr("data-bgColor");$(b).css("background-color",a);$(b).css("padding","10px");var h=$(d).attr("data-points");var f=this.getDistractorsParentElement(i,e,h);$(b).append(d);$(b).append(f);$(i).replaceWith(b)},makeDiv:function(){var a=document.createElement("div");a.className="QuestionWidget";return a},getQuestionStem:function(a){return $(a).find(".QuestionStem")},getDistractorsParentElement:function(e,a,d){var b=$(e).find(".DistractorParent");this.processDistractors(b,a,d);return b},processDistractors:function(i,f,h){h=parseInt(h);var d=parseInt(f.getTotalPoints());d=d>0?d:0;d+=h;f.setTotalPoints(d);var b=this.createSubmitButton(i,f,this,h);this.submitButton=b;var a=$(i).find(".ShortAnswerInput")[0];$(a).on("keydown",function(){$(b).show()});$(a).on("click",function(){$(b).show()});var j=document.createElement("div");$(j).addClass("feedbackdiv");$(j).width("20px");$(j).height("20px");$(j).html("&nbsp;&nbsp;&nbsp;");$(j).attr("style","display:inline-block;margin-right:10px; min-width:20px;max-width:20px;max-height:15px; text-indent:0px; float:left");$(i).prepend(j);var e=document.createElement("div");$(e).prepend(b);$(i).append(e)},processAnswer:function(f,d,e){e=e>0?e:0;var b=this.checkAnswers(f);if(b){var a=d.getUserPoints();d.setUserPoints(e+a)}d.mediators[jet.view.mediator.PageMediator.NAME].reportUserActivity(d,d.uid);this.appendScoreMessage(f,b?e:0,e)},checkAnswers:function(q){var r=false;var d=false;var f="\u2718";var j=$(q).attr("token");var o="AES_Encryption_2";var t="RandomInitVector";var j=validate(j,o,t);var n=j.split(";");var a=this.createAnswerOptions(n);var m=$(q).find(".ShortAnswerInput")[0];var h=$(m).val().toUpperCase();for(var s=0;s<a.length;s++){var b=a[s];var p=b.answer.toUpperCase();var u=b.isCorrect;var e=b.feedback;if(p==h){r=true;var l=new RegExp("Y|YES|TRUE|T");var k=l.test(u.toUpperCase());d=k?true:false;f=d?"\u2713":"\u2718";this.appendFeedbackMessage(q,e);break}}if(d==false){r=false}$(q).find(".feedbackdiv").html(f);return r},createAnswerOptions:function(b){var a=0;var e=[];while(a<b.length){var d={answer:"",isCorrect:"",feedback:""};d.answer=b[a];d.isCorrect=b[a+1];d.feedback=b[a+2];e.push(d);a=a+3}return e},appendFeedbackMessage:function(b,a){var d=document.createElement("div");$(b).append(d);$(d).addClass("feedbackMessagediv");$(d).attr("style","margin:5px;text-indent:100px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var e="<span>feedback: "+a+"</span>";$(d).html(e)},appendScoreMessage:function(d,e,f){var b=document.createElement("div");$(d).append(b);$(b).addClass("scoreMessagediv");$(b).attr("style","margin-top:20px;font-weight:lighter; color:#0a0a0a;font-style: italic;");var a="<p>"+e+"/"+f+"</p>";$(b).html(a)},createSubmitButton:function(f,d,b,e){var a=document.createElement("button");$(a).addClass("Qw_submitButton");$(a).text("Submit");$(a).attr("style","margin-top:40px");$(a).on("click",function(){b.processAnswer(f,d,e);$(a).attr("disabled","disabled");$(f).find(".Qw_checkBox").attr("disabled","disabled")});$(a).show();return a},enableInteractivity:function(b){var a=$(b).find(".DistractorParent");$(a).find(".feedbackMessagediv").remove();$(a).find(".feedbackdiv").html("&nbsp;&nbsp;&nbsp;");$(a).find(".Qw_submitButton").removeAttr("disabled");$(a).find(".Qw_submitButton").hide();$(a).find(".scoreMessagediv").html("");$(a).find(".scoreMessagediv").html("")},},{TEXT_CHANGED:"textChanged",NAME:"QuestionWidget"});